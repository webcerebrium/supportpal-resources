{"version":3,"sources":["redactor.js"],"names":["$","Redactor","el","options","prototype","init","Function","bind","scope","fn","this","apply","uuid","redactor","val","args","Array","slice","call","arguments","each","func","instance","data","search","split","isFunction","methodVal","undefined","push","error","length","VERSION","modules","opts","lang","direction","plugins","focus","focusEnd","placeholder","visual","tabindex","minHeight","maxHeight","linebreaks","replaceDivs","paragraphize","cleanStyleOnEnter","enterKey","cleanOnPaste","cleanSpaces","pastePlainText","autosave","autosaveName","autosaveInterval","autosaveOnChange","autosaveFields","linkTooltip","linkProtocol","linkNofollow","linkSize","imageEditable","imageLink","imagePosition","imageFloatMargin","imageResizable","imageUpload","imageUploadParam","uploadImageField","dragImageUpload","fileUpload","fileUploadParam","dragFileUpload","s3","convertLinks","convertUrlLinks","convertImageLinks","convertVideoLinks","preSpaces","tabAsSpaces","tabKey","scrollTarget","toolbar","toolbarFixed","toolbarFixedTarget","document","toolbarFixedTopOffset","toolbarExternal","toolbarOverflow","source","buttons","buttonsHide","buttonsHideOnMobile","formatting","formattingAdd","tabifier","deniedTags","allowedTags","paragraphizeBlocks","removeComments","replaceTags","replaceStyles","removeDataAttr","removeAttr","allowedAttr","removeWithoutAttr","removeEmpty","activeButtons","activeButtonsStates","b","strong","i","em","del","strike","ul","ol","u","shortcuts","ctrl+shift+m, meta+shift+m","ctrl+b, meta+b","params","ctrl+i, meta+i","ctrl+h, meta+h","ctrl+l, meta+l","ctrl+k, meta+k","ctrl+shift+7","ctrl+shift+8","shortcutsAdd","buffer","rebuffer","emptyHtml","invisibleSpace","imageTypes","indentValue","verifiedTags","inlineTags","alignmentTags","blockLevelElements","highContrast","observe","dropdowns","langs","en","html","video","image","table","link","link_insert","link_edit","unlink","paragraph","quote","code","header1","header2","header3","header4","header5","bold","italic","fontcolor","backcolor","unorderedlist","orderedlist","outdent","indent","cancel","insert","save","_delete","insert_table","insert_row_above","insert_row_below","insert_column_left","insert_column_right","delete_column","delete_row","delete_table","rows","columns","add_head","delete_head","title","image_position","none","left","right","center","image_web_link","text","mailto","web","video_html_code","file","upload","download","choose","or_choose","drop_file_here","align_left","align_center","align_right","align_justify","horizontalrule","deleted","anchor","link_new_tab","underline","alignment","filename","edit","upload_label","linkify","regexps","youtube","vimeo","url","codemirror","keyCode","BACKSPACE","DELETE","UP","DOWN","ENTER","SPACE","ESC","TAB","CTRL","META","SHIFT","ALT","RIGHT","LEFT","LEFT_WIN","$element","rtePaste","$pasteBox","loadOptions","loadModules","merge","reIsBlock","RegExp","join","tidy","setupAllowed","tags","load","extend","core","setCallback","start","build","run","getModuleMethods","object","Object","getOwnPropertyNames","filter","property","len","bindModuleMethods","module","methods","z","set","justify","type","utils","browser","$editor","blocks","selection","getBlocks","isLinebreaksOrNoBlocks","setText","setBlocks","restore","sync","wrapper","wrap","attr","css","proxy","$el","getAlignmentElement","isNeedReplaceElement","replaceElement","alignElement","replaceWith","removeEmptyAttr","enable","name","$textarea","setInterval","onChange","get","getHiddenFields","jsxhr","ajax","done","success","k","v","toString","indexOf","json","parseJSON","e","callbackName","disable","clearInterval","block","clearStyle","value","clear","format","tag","formatTags","inArray","isRemoveInline","trim","isEmpty","isFocused","$first","children","first","caret","setEnd","blocksSize","containerTag","range","commonAncestorContainer","tagName","collapsed","setCollapsed","setMultiple","node","createElement","formatListToBlockquote","isContainerTable","execCommand","getBlock","toggle","toLowerCase","append","replaceWithContents","$formatted","replaceToTag","find","remove","removeInlineTags","headTag","contents","unwrap","formatTableWrapping","formatBlockquote","formatWrap","prepend","count","s","classSize","toggleType","exceptTags","setForce","addClass","toggleClass","removeClass","closest","clean","clearUnverified","formatted","$elements","getMarker","$next","next","size","removeData","setData","toggleData","setAttr","toggleAttr","className","setClass","setUndo","setRedo","getUndo","pop","getRedo","add","undo","setTimeout","redo","focused","blured","createContainerBox","loadContent","loadEditor","enableEditor","setCodeAndCall","isTextarea","$box","createTextarea","getTextareaName","content","contenteditable","dir","fromTextarea","insertAfter","hide","fromElement","setOptions","callEditor","showCode","disableMozillaEditing","disableIeLinks","setEvents","setHelpers","modal","loadTemplates","setEventDropUpload","preventDefault","files","dataTransfer","directUpload","setEventDrop","on","stopPropagation","originalEvent","window","FormData","event","getEvent","addEvent","disableSelectAll","paste","keydown","keyup","codeKeydownCallback","codeKeyupCallback","focusCallback","getCurrent","setStart","addRange","target","blurCallback","isEnabled","RedactorPlugins","button","btnName","btnObject","$button","role","aria-label","command","dropdown","setEvent","$dropdown","isDesktop","createTooltip","hasClass","callback","onClick","$tooltip","appendTo","pos","offset","top","innerHeight","innerWidth","show","caretOffset","getOffset","returnValue","inline","onClickCallback","key","$toolbar","setActive","setInactive","setInactiveAll","not","setActiveInVisual","setInactiveInCode","changeIcon","classname","removeIcon","setAwesome","addCallback","$btn","addDropdown","isMobileUndoRedo","btn","addFirst","addAfter","afterkey","parent","after","addBefore","beforekey","before","isBlock","space","createSpaceElement","lastChild","nodeType","setAfter","orgn","orgo","focn","foco","isBlockTag","innerHTML","setAfterOrBefore","setBefore","prev","setStartAfter","setEndAfter","setStartBefore","setEndBefore","collapse","getOffsetOfElement","cloned","cloneRange","selectNodeContents","endContainer","endOffset","sel","getSelection","rangeCount","getRangeAt","caretRange","setOffset","end","walker","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","nodeValue","Infinity","setToPoint","getCoords","onSet","savePreCode","replace","replaceParagraphsToBr","saveFormTags","$div","fonts","$span","setVerified","convertInline","onSync","restoreFormTags","chars","™","©","…","—","‐","parseHTML","onPaste","setMode","getPlainText","isSelectAll","isCurrentOrParent","getPreCode","getOnlyImages","onPasteTidy","replaceDivsToBr","isSingleLine","singleLine","onPasteWord","onPasteExtra","removeDirtyStyles","onPasteRemoveSpans","onPasteRemoveEmpty","match","str","spaces","Math","floor","onPasteIeFixLinks","lastList","lastLevel","listsIds","matches","currentList","parseInt","currentLevel","listType","$li","$list","data-level","data-list","$prevList","$lastList","last","tagsEmpty","attrAllowed","removePhp","tmp","matchBlocks","matchContainers","matchBR","stripTags","input","allowed","$0","$1","savePreFormatting","saveCodeFormatting","restoreSelectionMarker","pre","arr","encodeEntities","getTextFromHtml","textContent","innerText","getOnlyLinksAndImages","String","div","clearUnverifiedRemove","headers","$s","cleanEmptyParagraph","newTag","normalizeLists","removeSpaces","startSync","syncCode","CodeMirror","setValue","showVisual","scroll","scrollTop","height","modified","$editorDiv","$selectionMarkers","editorHtml","strpos","prop","removeMarkers","setSize","refresh","setCursor","posFromIndex","line","ch","setSelection","textareaIndenting","setSelectionRange","listSelections","indexFromPos","head","getValue","selectionStart","selectionEnd","tempStart","tempEnd","enlargeOffset","substr","getMarkerAsHtml","markerLength","off","substring","htmlLength","c","getObject","getEditor","getBox","getElement","getTextarea","getToolbar","eventName","eventNamespace","events","_data","handler","destroy","destroyed","$modalBox","$modalOverlay","dropdownObject","style","class","$item","hideAll","body","keyPosition","dropdownWidth","width","max","position","one","closeHandler","disableBodyScroll","enableBodyScroll","which","direct","close","filelink","marker","nodeToCaretPositionFromPoint","htmlWithoutClean","linkmarker","child","activeElement","showEdit","$image","$link","createCancelButton","buttonDelete","createDeleteButton","buttonSave","createActionButton","update","$redactorImageLink","floatValue","setFloating","floating","imageFloat","imageDisplay","imageMargin","float","display","margin","hideResize","pattern","re","re2","a","getOuterHtml","images","setEditable","onDrag","resizer","loadEditableControls","setResizable","resizeHandle","x","pageX","y","pageY","ratio","h","targetTouches","startResize","moveResize","stopResize","round","handle","onDrop","fixImageSourceAfterDrop","imageBox","marginTop","marginBottom","marginLeft","marginRight","loadResizableControls","isMobile","imageResizer","editter","editerWidth","$figure","$parent","src","$img","isP","increase","increaseLists","increaseText","increaseBlocks","fixEmptyIndent","elem","normalize","decrease","decreaseLists","decreaseBlocks","current","$block","isCurrentOrParentHeader","replaced","formatCollapsed","formatMultiple","isEndOfElement","setFormat","formatConvert","formatRemoveSameChildren","attributes","_this","self","$child","cssText","removeStyle","nodes","getInlines","removeStyleRule","getParent","removeFormat","getNodes","toggleStyle","htmlIe","deleteContents","lastNode","frag","createDocumentFragment","firstChild","appendChild","insertNode","removeAllRanges","execHtml","htmlFixMozilla","isIe11","$html","blocksMatch","is","ie11FixInserting","ie11PasteFrag","createRange","pasteHTML","nodeToPoint","caretPositionFromPoint","offsetNode","caretRangeFromPoint","createTextRange","moveToPoint","endRange","duplicate","setEndPoint","select","clientX","clientY","parHtml","arrow","ctrl","ctrlKey","metaKey","isTag","blockquote","figcaption","checkEvents","setupBuffer","addArrowsEvent","setupSelectAll","keydownStop","isEndOfTable","$table","onArrowDown","shiftKey","stop","exitFromBlockquote","insertNewLine","insertBreakLine","insertDblBreakLine","isEndOfEditor","context","replaceDivToBreakLine","replaceDivToParagraph","insertParagraph","onShiftEnter","onTab","indented","isStartOfElement","getPrev","prev2","removeInvisibleSpace","removeEmptyListInTable","checkKeyEvents","keys","altKey","enableSelectAll","insertAfterLastElement","createTextNode","blockElem","blockHtml","br","p","element","insertBreakLineProcessing","dbl","br1","$parentA","br2","$current","td","isRedactorParent","keyupStop","replaceToParagraph","isKey","removeEmptyLists","formatEmpty","clone","removeIt","curLang","isExceptLastOrFirst","insertInIe","insertInOthersBrowsers","getLastBlock","firstFound","lastFound","saveScroll","restoreScroll","extra","setFocus","textNode","isCurrent","buttonText","buttonInsert","getData","cleanUrl","$inputUrl","$inputText","thref","location","href","host","$node","test","re3","selectElement","$a","getText","links","getInlinesTags","addBack","convertImages","objects","iframeStart","iframeEnd","grep","decodeURIComponent","regexB","regexp","list","cmd","isUnorderedCmdOrdered","isOrderedCmdUnordered","listTag","$td","newTd","$children","eq","$listParent","wrapperHtml","tmpList","tmpLi","items","$prev","callbacks","imageEdit","createTabber","$modal","$tabber","addTab","id","active","$tab","addTemplate","template","getTemplate","getModal","$modalBody","templateName","enableEvents","setTitle","setDraggable","setContent","showOnMobile","showOnDesktop","setButtonsWidth","resize","setEnter","outerHeight","windowHeight","windowWidth","$modalHeader","draggable","click","$modalFooter","label","createButton","buttonsSize","buildOverlay","$modalClose","disableEvents","fadeOut","bodyOveflow","parents","item","inValues","outValues","setDropdownProperties","addProperties","deleteProperties","setDropdownAttr","properties","isDelete","toggleActive","parentEl","currentEl","align","addButton","img","showTooltip","closeTooltip","getTooltipPosition","tooltip","aLink","aEdit","aUnlink","safes","getSafes","getSafesComments","replaceBreaksToNewLines","replaceBreaksToParagraphs","restoreSafes","outerHTML","commentsMatches","htmls","hasOwnProperty","createPasteBox","saveBodyScroll","$visibleModals","spans","progress","fadeIn","startContainer","anchorNode","previousSibling","getNext","nextSibling","parentNode","inlines","lastBlock","startNode","getNodesMarker","endNode","startPointNode","startOffset","boundaryRange","setNodesMarker","counter","finalNodes","removeNodesMarkers","num","fromPoint","extractContents","selectAll","createMarkers","node1","setMarker","node2","savedSel","getHtml","container","cloneContents","replaceSelection","replaceWithHtml","origHandler","hotkeysSpecialKeys","8","9","10","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","45","46","59","61","96","97","98","99","100","101","102","103","104","105","106","107","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","144","145","173","186","187","188","189","190","191","192","219","220","221","222","hotkeysShiftNums","`","1","2","3","4","5","6","7","0","-","=",";","'",",",".","/","\\","special","character","fromCharCode","modif","possible","index","specialKey","ownLine","contOwnLine","newLevel","lineBefore","lineAfter","codeLength","point","out","cont","cleanlevel","finish","charAt","getTabs","t","placeTag","cleanTag","j","tagout","suffix","m","exec","nl","splice","addToAllowed","removeFromDenied","settings","removeTags","removeParagraphsInLists","replacement","rTags","n","allowedAttrTags","allowedAttrData","attributesRemove","removeAttrGetRemoves","f","attrs","isArray","removeAttrs","regex","specified","h1","h2","h3","h4","h5","in","aria-disabled","hideButtons","hideButtonsOnMobile","isButtonSourceNeeded","createContainer","setOverflow","setFormattingTags","loadButtons","setFixed","observeScroll","observeScrollEnable","boxTop","setDropdownsFixed","observeScrollDisable","visibility","unsetDropdownsFixed","$droparea","$placeholdler","$input","onDragLeave","traverseFile","setConfig","s3uploadFile","formData","sendData","getType","obj","fd","uploadImageFields","imageFields","uploadFileFields","fileFields","xhr","XMLHttpRequest","open","setRequestHeader","onreadystatechange","readyState","responseText","err","send","clearImageFields","addImageFields","removeImageFields","clearFileFields","addFileFields","removeFileFields","s3executeOnSignedUrl","signedURL","s3uploadToS3","mark","overrideMimeType","that","status","s3createCORSRequest","method","XDomainRequest","onload","s3file","onerror","onprogress","navigator","userAgent","isString","removeEmptyTags","hexToRgb","hex","shorthandRegex","r","g","result","saveEditorScroll","saveTargetScroll","isStartOfEditor","matched","isCurrentOrParentOne","toUpperCase","isOldIe","isLessIe10","ua","haystack","needle","$body","documentElementRect","documentElement","getBoundingClientRect","abs","isOverflowing","clientWidth","scrollbarWidth","measureScrollbar","scrollDiv","offsetWidth","removeChild","overflow","padding-right","jQuery"],"mappings":"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","file":"redactor.min.js","sourcesContent":["/*\r\n\tRedactor 10.2.5\r\n\tUpdated: October 1, 2015\r\n\r\n\thttp://imperavi.com/redactor/\r\n\r\n\tCopyright (c) 2009-2015, Imperavi LLC.\r\n\tLicense: http://imperavi.com/redactor/license/\r\n\r\n\tUsage: $('#content').redactor();\r\n*/\r\n\r\n(function($)\r\n{\r\n\r\n\t'use strict';\r\n\r\n\tif (!Function.prototype.bind)\r\n\t{\r\n\t\tFunction.prototype.bind = function(scope)\r\n\t\t{\r\n\t\t\tvar fn = this;\r\n\t\t\treturn function()\r\n\t\t\t{\r\n\t\t\t\treturn fn.apply(scope);\r\n\t\t\t};\r\n\t\t};\r\n\t}\r\n\r\n\tvar uuid = 0;\r\n\r\n\t// Plugin\r\n\t$.fn.redactor = function(options)\r\n\t{\r\n\t\tvar val = [];\r\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\r\n\t\tif (typeof options === 'string')\r\n\t\t{\r\n\t\t\tthis.each(function()\r\n\t\t\t{\r\n\t\t\t\tvar instance = $.data(this, 'redactor');\r\n\t\t\t\tvar func;\r\n\r\n\t\t\t\tif (options.search(/\\./) != '-1')\r\n\t\t\t\t{\r\n\t\t\t\t\tfunc = options.split('.');\r\n\t\t\t\t\tif (typeof instance[func[0]] != 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfunc = instance[func[0]][func[1]];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tfunc = instance[options];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (typeof instance !== 'undefined' && $.isFunction(func))\r\n\t\t\t\t{\r\n\t\t\t\t\tvar methodVal = func.apply(instance, args);\r\n\t\t\t\t\tif (methodVal !== undefined && methodVal !== instance)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tval.push(methodVal);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$.error('No such method \"' + options + '\" for Redactor');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.each(function()\r\n\t\t\t{\r\n\t\t\t\t$.data(this, 'redactor', {});\r\n\t\t\t\t$.data(this, 'redactor', Redactor(this, options));\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (val.length === 0) return this;\r\n\t\telse if (val.length === 1) return val[0];\r\n\t\telse return val;\r\n\r\n\t};\r\n\r\n\t// Initialization\r\n\tfunction Redactor(el, options)\r\n\t{\r\n\t\treturn new Redactor.prototype.init(el, options);\r\n\t}\r\n\r\n\t// Functionality\r\n\t$.Redactor = Redactor;\r\n\t$.Redactor.VERSION = '10.2.5';\r\n\t$.Redactor.modules = ['alignment', 'autosave', 'block', 'buffer', 'build', 'button',\r\n\t\t\t\t\t\t  'caret', 'clean', 'code', 'core', 'dropdown', 'file', 'focus',\r\n\t\t\t\t\t\t  'image', 'indent', 'inline', 'insert', 'keydown', 'keyup',\r\n\t\t\t\t\t\t  'lang', 'line', 'link', 'linkify', 'list', 'modal', 'observe', 'paragraphize',\r\n\t\t\t\t\t\t  'paste', 'placeholder', 'progress', 'selection', 'shortcuts',\r\n\t\t\t\t\t\t  'tabifier', 'tidy',  'toolbar', 'upload', 'utils'];\r\n\r\n\t$.Redactor.opts = {\r\n\r\n\t\t// settings\r\n\t\tlang: 'en',\r\n\t\tdirection: 'ltr', // ltr or rtl\r\n\r\n\t\tplugins: false, // array\r\n\r\n\t\tfocus: false,\r\n\t\tfocusEnd: false,\r\n\r\n\t\tplaceholder: false,\r\n\r\n\t\tvisual: true,\r\n\t\ttabindex: false,\r\n\r\n\t\tminHeight: false,\r\n\t\tmaxHeight: false,\r\n\r\n\t\tlinebreaks: false,\r\n\t\treplaceDivs: true,\r\n\t\tparagraphize: true,\r\n\t\tcleanStyleOnEnter: false,\r\n\t\tenterKey: true,\r\n\r\n\t\tcleanOnPaste: true,\r\n\t\tcleanSpaces: true,\r\n\t\tpastePlainText: false,\r\n\r\n\t\tautosave: false, // false or url\r\n\t\tautosaveName: false,\r\n\t\tautosaveInterval: 60, // seconds\r\n\t\tautosaveOnChange: false,\r\n\t\tautosaveFields: false,\r\n\r\n\t\tlinkTooltip: true,\r\n\t\tlinkProtocol: 'http',\r\n\t\tlinkNofollow: false,\r\n\t\tlinkSize: 50,\r\n\r\n\t\timageEditable: true,\r\n\t\timageLink: true,\r\n\t\timagePosition: true,\r\n\t\timageFloatMargin: '10px',\r\n\t\timageResizable: true,\r\n\r\n\t\timageUpload: null,\r\n\t\timageUploadParam: 'file',\r\n\r\n\t\tuploadImageField: false,\r\n\r\n\t\tdragImageUpload: true,\r\n\r\n\t\tfileUpload: null,\r\n\t\tfileUploadParam: 'file',\r\n\r\n\t\tdragFileUpload: true,\r\n\r\n\t\ts3: false,\r\n\r\n\t\tconvertLinks: true,\r\n\t\tconvertUrlLinks: true,\r\n\t\tconvertImageLinks: true,\r\n\t\tconvertVideoLinks: true,\r\n\r\n\t\tpreSpaces: 4, // or false\r\n\t\ttabAsSpaces: false, // true or number of spaces\r\n\t\ttabKey: true,\r\n\r\n\t\tscrollTarget: false,\r\n\r\n\t\ttoolbar: true,\r\n\t\ttoolbarFixed: true,\r\n\t\ttoolbarFixedTarget: document,\r\n\t\ttoolbarFixedTopOffset: 0, // pixels\r\n\t\ttoolbarExternal: false, // ID selector\r\n\t\ttoolbarOverflow: false,\r\n\r\n\t\tsource: true,\r\n\t\tbuttons: ['html', 'formatting', 'bold', 'italic', 'deleted', 'unorderedlist', 'orderedlist',\r\n\t\t\t\t  'outdent', 'indent', 'image', 'file', 'link', 'alignment', 'horizontalrule'], // + 'underline'\r\n\r\n\t\tbuttonsHide: [],\r\n\t\tbuttonsHideOnMobile: [],\r\n\r\n\t\tformatting: ['p', 'blockquote', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\r\n\t\tformattingAdd: false,\r\n\r\n\t\ttabifier: true,\r\n\r\n\t\tdeniedTags: ['script', 'style'],\r\n\t\tallowedTags: false, // or array\r\n\r\n\t\tparagraphizeBlocks: ['table', 'div', 'pre', 'form', 'ul', 'ol', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'dl', 'blockquote', 'figcaption',\r\n\t\t\t\t\t\t\t'address', 'section', 'header', 'footer', 'aside', 'article', 'object', 'style', 'script', 'iframe', 'select', 'input', 'textarea',\r\n\t\t\t\t\t\t\t'button', 'option', 'map', 'area', 'math', 'hr', 'fieldset', 'legend', 'hgroup', 'nav', 'figure', 'details', 'menu', 'summary', 'p'],\r\n\r\n\t\tremoveComments: false,\r\n\t\treplaceTags: [\r\n\t\t\t['strike', 'del'],\r\n\t\t\t['b', 'strong']\r\n\t\t],\r\n\t\treplaceStyles: [\r\n            ['font-weight:\\\\s?bold', \"strong\"],\r\n            ['font-style:\\\\s?italic', \"em\"],\r\n            ['text-decoration:\\\\s?underline', \"u\"],\r\n            ['text-decoration:\\\\s?line-through', 'del']\r\n        ],\r\n        removeDataAttr: false,\r\n\r\n\t\tremoveAttr: false, // or multi array\r\n\t\tallowedAttr: false, // or multi array\r\n\r\n\t\tremoveWithoutAttr: ['span'], // or false\r\n\t\tremoveEmpty: ['p'], // or false;\r\n\r\n\t\tactiveButtons: ['deleted', 'italic', 'bold', 'underline', 'unorderedlist', 'orderedlist',\r\n\t\t\t\t\t\t'alignleft', 'aligncenter', 'alignright', 'justify'],\r\n\t\tactiveButtonsStates: {\r\n\t\t\tb: 'bold',\r\n\t\t\tstrong: 'bold',\r\n\t\t\ti: 'italic',\r\n\t\t\tem: 'italic',\r\n\t\t\tdel: 'deleted',\r\n\t\t\tstrike: 'deleted',\r\n\t\t\tul: 'unorderedlist',\r\n\t\t\tol: 'orderedlist',\r\n\t\t\tu: 'underline'\r\n\t\t},\r\n\r\n\t\tshortcuts: {\r\n\t\t\t'ctrl+shift+m, meta+shift+m': { func: 'inline.removeFormat' },\r\n\t\t\t'ctrl+b, meta+b': { func: 'inline.format', params: ['bold'] },\r\n\t\t\t'ctrl+i, meta+i': { func: 'inline.format', params: ['italic'] },\r\n\t\t\t'ctrl+h, meta+h': { func: 'inline.format', params: ['superscript'] },\r\n\t\t\t'ctrl+l, meta+l': { func: 'inline.format', params: ['subscript'] },\r\n\t\t\t'ctrl+k, meta+k': { func: 'link.show' },\r\n\t\t\t'ctrl+shift+7':   { func: 'list.toggle', params: ['orderedlist'] },\r\n\t\t\t'ctrl+shift+8':   { func: 'list.toggle', params: ['unorderedlist'] }\r\n\t\t},\r\n\t\tshortcutsAdd: false,\r\n\r\n\t\t// private\r\n\t\tbuffer: [],\r\n\t\trebuffer: [],\r\n\t\temptyHtml: '<p>&#x200b;</p>',\r\n\t\tinvisibleSpace: '&#x200b;',\r\n\t\timageTypes: ['image/png', 'image/jpeg', 'image/gif'],\r\n\t\tindentValue: 20,\r\n\t\tverifiedTags: \t\t['a', 'img', 'b', 'strong', 'sub', 'sup', 'i', 'em', 'u', 'small', 'strike', 'del', 'cite', 'ul', 'ol', 'li'], // and for span tag special rule\r\n\t\tinlineTags: \t\t['strong', 'b', 'u', 'em', 'i', 'code', 'del', 'ins', 'samp', 'kbd', 'sup', 'sub', 'mark', 'var', 'cite', 'small'],\r\n\t\talignmentTags: \t\t['P', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6',  'DL', 'DT', 'DD', 'DIV', 'TD', 'BLOCKQUOTE', 'OUTPUT', 'FIGCAPTION', 'ADDRESS', 'SECTION', 'HEADER', 'FOOTER', 'ASIDE', 'ARTICLE'],\r\n\t\tblockLevelElements: ['PRE', 'UL', 'OL', 'LI'],\r\n\t\thighContrast: false,\r\n\t\tobserve: {\r\n\t\t\tdropdowns: []\r\n\t\t},\r\n\r\n\t\t// lang\r\n\t\tlangs: {\r\n\t\t\ten: {\r\n\t\t\t\thtml: 'HTML',\r\n\t\t\t\tvideo: 'Insert Video',\r\n\t\t\t\timage: 'Insert Image',\r\n\t\t\t\ttable: 'Table',\r\n\t\t\t\tlink: 'Link',\r\n\t\t\t\tlink_insert: 'Insert link',\r\n\t\t\t\tlink_edit: 'Edit link',\r\n\t\t\t\tunlink: 'Unlink',\r\n\t\t\t\tformatting: 'Formatting',\r\n\t\t\t\tparagraph: 'Normal text',\r\n\t\t\t\tquote: 'Quote',\r\n\t\t\t\tcode: 'Code',\r\n\t\t\t\theader1: 'Header 1',\r\n\t\t\t\theader2: 'Header 2',\r\n\t\t\t\theader3: 'Header 3',\r\n\t\t\t\theader4: 'Header 4',\r\n\t\t\t\theader5: 'Header 5',\r\n\t\t\t\tbold: 'Bold',\r\n\t\t\t\titalic: 'Italic',\r\n\t\t\t\tfontcolor: 'Font Color',\r\n\t\t\t\tbackcolor: 'Back Color',\r\n\t\t\t\tunorderedlist: 'Unordered List',\r\n\t\t\t\torderedlist: 'Ordered List',\r\n\t\t\t\toutdent: 'Outdent',\r\n\t\t\t\tindent: 'Indent',\r\n\t\t\t\tcancel: 'Cancel',\r\n\t\t\t\tinsert: 'Insert',\r\n\t\t\t\tsave: 'Save',\r\n\t\t\t\t_delete: 'Delete',\r\n\t\t\t\tinsert_table: 'Insert Table',\r\n\t\t\t\tinsert_row_above: 'Add Row Above',\r\n\t\t\t\tinsert_row_below: 'Add Row Below',\r\n\t\t\t\tinsert_column_left: 'Add Column Left',\r\n\t\t\t\tinsert_column_right: 'Add Column Right',\r\n\t\t\t\tdelete_column: 'Delete Column',\r\n\t\t\t\tdelete_row: 'Delete Row',\r\n\t\t\t\tdelete_table: 'Delete Table',\r\n\t\t\t\trows: 'Rows',\r\n\t\t\t\tcolumns: 'Columns',\r\n\t\t\t\tadd_head: 'Add Head',\r\n\t\t\t\tdelete_head: 'Delete Head',\r\n\t\t\t\ttitle: 'Title',\r\n\t\t\t\timage_position: 'Position',\r\n\t\t\t\tnone: 'None',\r\n\t\t\t\tleft: 'Left',\r\n\t\t\t\tright: 'Right',\r\n\t\t\t\tcenter: 'Center',\r\n\t\t\t\timage_web_link: 'Image Web Link',\r\n\t\t\t\ttext: 'Text',\r\n\t\t\t\tmailto: 'Email',\r\n\t\t\t\tweb: 'URL',\r\n\t\t\t\tvideo_html_code: 'Video Embed Code or Youtube/Vimeo Link',\r\n\t\t\t\tfile: 'Insert File',\r\n\t\t\t\tupload: 'Upload',\r\n\t\t\t\tdownload: 'Download',\r\n\t\t\t\tchoose: 'Choose',\r\n\t\t\t\tor_choose: 'Or choose',\r\n\t\t\t\tdrop_file_here: 'Drop file here',\r\n\t\t\t\talign_left: 'Align text to the left',\r\n\t\t\t\talign_center: 'Center text',\r\n\t\t\t\talign_right: 'Align text to the right',\r\n\t\t\t\talign_justify: 'Justify text',\r\n\t\t\t\thorizontalrule: 'Insert Horizontal Rule',\r\n\t\t\t\tdeleted: 'Deleted',\r\n\t\t\t\tanchor: 'Anchor',\r\n\t\t\t\tlink_new_tab: 'Open link in new tab',\r\n\t\t\t\tunderline: 'Underline',\r\n\t\t\t\talignment: 'Alignment',\r\n\t\t\t\tfilename: 'Name (optional)',\r\n\t\t\t\tedit: 'Edit',\r\n\t\t\t\tupload_label: 'Drop file here or '\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tlinkify: {\r\n\t\t\tregexps: {\r\n\t\t\t\tyoutube: /https?:\\/\\/(?:[0-9A-Z-]+\\.)?(?:youtu\\.be\\/|youtube\\.com\\S*[^\\w\\-\\s])([\\w\\-]{11})(?=[^\\w\\-]|$)(?![?=&+%\\w.\\-]*(?:['\"][^<>]*>|<\\/a>))[?=&+%\\w.-]*/ig,\r\n\t\t\t\tvimeo: /https?:\\/\\/(www\\.)?vimeo.com\\/(\\d+)($|\\/)/,\r\n\t\t\t\timage: /((https?|www)[^\\s]+\\.)(jpe?g|png|gif)(\\?[^\\s-]+)?/ig,\r\n\t\t\t\turl: /(https?:\\/\\/(?:www\\.|(?!www))[^\\s\\.]+\\.[^\\s]{2,}|www\\.[^\\s]+\\.[^\\s]{2,})/ig,\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcodemirror: false\r\n\t};\r\n\r\n\t// Functionality\r\n\tRedactor.fn = $.Redactor.prototype = {\r\n\r\n\t\tkeyCode: {\r\n\t\t\tBACKSPACE: 8,\r\n\t\t\tDELETE: 46,\r\n\t\t\tUP: 38,\r\n\t\t\tDOWN: 40,\r\n\t\t\tENTER: 13,\r\n\t\t\tSPACE: 32,\r\n\t\t\tESC: 27,\r\n\t\t\tTAB: 9,\r\n\t\t\tCTRL: 17,\r\n\t\t\tMETA: 91,\r\n\t\t\tSHIFT: 16,\r\n\t\t\tALT: 18,\r\n\t\t\tRIGHT: 39,\r\n\t\t\tLEFT: 37,\r\n\t\t\tLEFT_WIN: 91\r\n\t\t},\r\n\r\n\t\t// Initialization\r\n\t\tinit: function(el, options)\r\n\t\t{\r\n\t\t\tthis.$element = $(el);\r\n\t\t\tthis.uuid = uuid++;\r\n\r\n\t\t\t// if paste event detected = true\r\n\t\t\tthis.rtePaste = false;\r\n\t\t\tthis.$pasteBox = false;\r\n\r\n\t\t\tthis.loadOptions(options);\r\n\t\t\tthis.loadModules();\r\n\r\n\t\t\t// formatting storage\r\n\t\t\tthis.formatting = {};\r\n\r\n\t\t\t// block level tags\r\n\t\t\t$.merge(this.opts.blockLevelElements, this.opts.alignmentTags);\r\n\t\t\tthis.reIsBlock = new RegExp('^(' + this.opts.blockLevelElements.join('|' ) + ')$', 'i');\r\n\r\n\t\t\t// setup allowed and denied tags\r\n\t\t\tthis.tidy.setupAllowed();\r\n\r\n\t\t\t// setup denied tags\r\n\t\t\tif (this.opts.deniedTags !== false)\r\n\t\t\t{\r\n\t\t\t\tvar tags = ['html', 'head', 'link', 'body', 'meta', 'applet'];\r\n\t\t\t\tfor (var i = 0; i < tags.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.opts.deniedTags.push(tags[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// load lang\r\n\t\t\tthis.lang.load();\r\n\r\n\t\t\t// extend shortcuts\r\n\t\t\t$.extend(this.opts.shortcuts, this.opts.shortcutsAdd);\r\n\r\n\t\t\t// start callback\r\n\t\t\tthis.core.setCallback('start');\r\n\r\n\t\t\t// build\r\n\t\t\tthis.start = true;\r\n\t\t\tthis.build.run();\r\n\t\t},\r\n\r\n\t\tloadOptions: function(options)\r\n\t\t{\r\n\t\t\tthis.opts = $.extend(\r\n\t\t\t\t{},\r\n\t\t\t\t$.extend(true, {}, $.Redactor.opts),\r\n\t\t\t\tthis.$element.data(),\r\n\t\t\t\toptions\r\n\t\t\t);\r\n\t\t},\r\n\t\tgetModuleMethods: function(object)\r\n\t\t{\r\n\t\t\treturn Object.getOwnPropertyNames(object).filter(function(property)\r\n\t\t\t{\r\n\t\t\t\treturn typeof object[property] == 'function';\r\n\t\t\t});\r\n\t\t},\r\n\t\tloadModules: function()\r\n\t\t{\r\n\t\t\tvar len = $.Redactor.modules.length;\r\n\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t{\r\n\t\t\t\tthis.bindModuleMethods($.Redactor.modules[i]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tbindModuleMethods: function(module)\r\n\t\t{\r\n\t\t\tif (typeof this[module] == 'undefined') return;\r\n\r\n\t\t\t// init module\r\n\t\t\tthis[module] = this[module]();\r\n\r\n\t\t\tvar methods = this.getModuleMethods(this[module]);\r\n\t\t\tvar len = methods.length;\r\n\r\n\t\t\t// bind methods\r\n\t\t\tfor (var z = 0; z < len; z++)\r\n\t\t\t{\r\n\t\t\t\tthis[module][methods[z]] = this[module][methods[z]].bind(this);\r\n\t\t\t}\r\n\t\t},\r\n\t\talignment: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tleft: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.alignment.set('');\r\n\t\t\t\t},\r\n\t\t\t\tright: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.alignment.set('right');\r\n\t\t\t\t},\r\n\t\t\t\tcenter: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.alignment.set('center');\r\n\t\t\t\t},\r\n\t\t\t\tjustify: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.alignment.set('justify');\r\n\t\t\t\t},\r\n\t\t\t\tset: function(type)\r\n\t\t\t\t{\r\n\t\t\t\t\t// focus\r\n\t\t\t\t\tif (!this.utils.browser('msie') && !this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.focus();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// get blocks\r\n\t\t\t\t\tthis.alignment.blocks = this.selection.getBlocks();\r\n\t\t\t\t\tthis.alignment.type = type;\r\n\r\n\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\t// set alignment\r\n\t\t\t\t\tif (this.alignment.isLinebreaksOrNoBlocks())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.alignment.setText();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.alignment.setBlocks();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// sync\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tsetText: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar wrapper = this.selection.wrap('div');\r\n\t\t\t\t\t$(wrapper).attr('data-tagblock', 'redactor').css('text-align', this.alignment.type);\r\n\t\t\t\t},\r\n\t\t\t\tsetBlocks: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$.each(this.alignment.blocks, $.proxy(function(i, el)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $el = this.utils.getAlignmentElement(el);\r\n\t\t\t\t\t\tif (!$el) return;\r\n\r\n\t\t\t\t\t\tif (this.alignment.isNeedReplaceElement($el))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.alignment.replaceElement($el);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.alignment.alignElement($el);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tisLinebreaksOrNoBlocks: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn (this.opts.linebreaks && this.alignment.blocks[0] === false);\r\n\t\t\t\t},\r\n\t\t\t\tisNeedReplaceElement: function($el)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn (this.alignment.type === '' && typeof($el.data('tagblock')) !== 'undefined');\r\n\t\t\t\t},\r\n\t\t\t\treplaceElement: function($el)\r\n\t\t\t\t{\r\n\t\t\t\t\t$el.replaceWith($el.html());\r\n\t\t\t\t},\r\n\t\t\t\talignElement: function($el)\r\n\t\t\t\t{\r\n\t\t\t\t\t$el.css('text-align', this.alignment.type);\r\n\t\t\t\t\tthis.utils.removeEmptyAttr($el, 'style');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tautosave: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\thtml: false,\r\n\t\t\t\tenable: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.autosave) return;\r\n\r\n\t\t\t\t\tthis.autosave.name = (this.opts.autosaveName) ? this.opts.autosaveName : this.$textarea.attr('name');\r\n\r\n\t\t\t\t\tif (this.opts.autosaveOnChange) return;\r\n\t\t\t\t\tthis.autosaveInterval = setInterval(this.autosave.load, this.opts.autosaveInterval * 1000);\r\n\t\t\t\t},\r\n\t\t\t\tonChange: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.autosaveOnChange) return;\r\n\t\t\t\t\tthis.autosave.load();\r\n\t\t\t\t},\r\n\t\t\t\tload: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.autosave) return;\r\n\r\n\t\t\t\t\tthis.autosave.source = this.code.get();\r\n\r\n\t\t\t\t\tif (this.autosave.html === this.autosave.source) return;\r\n\r\n\t\t\t\t\t// data\r\n\t\t\t\t\tvar data = {};\r\n\t\t\t\t\tdata['name'] = this.autosave.name;\r\n\t\t\t\t\tdata[this.autosave.name] = this.autosave.source;\r\n\t\t\t\t\tdata = this.autosave.getHiddenFields(data);\r\n\r\n\t\t\t\t\t// ajax\r\n\t\t\t\t\tvar jsxhr = $.ajax({\r\n\t\t\t\t\t\turl: this.opts.autosave,\r\n\t\t\t\t\t\ttype: 'post',\r\n\t\t\t\t\t\tdata: data\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tjsxhr.done(this.autosave.success);\r\n\t\t\t\t},\r\n\t\t\t\tgetHiddenFields: function(data)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.autosaveFields === false || typeof this.opts.autosaveFields !== 'object')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn data;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$.each(this.opts.autosaveFields, $.proxy(function(k, v)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (v !== null && v.toString().indexOf('#') === 0) v = $(v).val();\r\n\t\t\t\t\t\tdata[k] = v;\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\treturn data;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function(data)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar json;\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tjson = $.parseJSON(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t//data has already been parsed\r\n\t\t\t\t\t\tjson = data;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar callbackName = (typeof json.error == 'undefined') ? 'autosave' :  'autosaveError';\r\n\r\n\t\t\t\t\tthis.core.setCallback(callbackName, this.autosave.name, json);\r\n\t\t\t\t\tthis.autosave.html = this.autosave.source;\r\n\t\t\t\t},\r\n\t\t\t\tdisable: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tclearInterval(this.autosaveInterval);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tblock: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tformatting: function(name)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.block.clearStyle = false;\r\n\t\t\t\t\tvar type, value;\r\n\r\n\t\t\t\t\tif (typeof this.formatting[name].data != 'undefined') type = 'data';\r\n\t\t\t\t\telse if (typeof this.formatting[name].attr != 'undefined') type = 'attr';\r\n\t\t\t\t\telse if (typeof this.formatting[name]['class'] != 'undefined') type = 'class';\r\n\r\n\t\t\t\t\tif (typeof this.formatting[name].clear != 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.block.clearStyle = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (type) value = this.formatting[name][type];\r\n\r\n\t\t\t\t\tthis.block.format(this.formatting[name].tag, type, value);\r\n\r\n\t\t\t\t},\r\n\t\t\t\tformat: function(tag, type, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (tag == 'quote') tag = 'blockquote';\r\n\r\n\t\t\t\t\tvar formatTags = ['p', 'pre', 'blockquote', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\r\n\t\t\t\t\tif ($.inArray(tag, formatTags) == -1) return;\r\n\r\n\t\t\t\t\tthis.block.isRemoveInline = (tag == 'pre' || tag.search(/h[1-6]/i) != -1);\r\n\r\n\t\t\t\t\t// focus\r\n\t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\r\n\r\n\t\t\t\t\tvar html = $.trim(this.$editor.html());\r\n\t\t\t\t\tthis.block.isEmpty = this.utils.isEmpty(html);\r\n\r\n\t\t\t\t\t// FF focus\r\n\t\t\t\t\tif (this.utils.browser('mozilla') && !this.focus.isFocused())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.block.isEmpty)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $first;\r\n\t\t\t\t\t\t\tif (!this.opts.linebreaks)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$first = this.$editor.children().first();\r\n\t\t\t\t\t\t\t\tthis.caret.setEnd($first);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.block.blocks = this.selection.getBlocks();\r\n\r\n\t\t\t\t\tthis.block.blocksSize = this.block.blocks.length;\r\n\t\t\t\t\tthis.block.type = type;\r\n\t\t\t\t\tthis.block.value = value;\r\n\r\n\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tthis.block.set(tag);\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\tthis.observe.load();\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function(tag)\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\tthis.block.containerTag = this.range.commonAncestorContainer.tagName;\r\n\r\n\t\t\t\t\tif (this.range.collapsed)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.block.setCollapsed(tag);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.block.setMultiple(tag);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetCollapsed: function(tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.linebreaks && this.block.isEmpty && tag != 'p')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar node = document.createElement(tag);\r\n\t\t\t\t\t\tthis.$editor.html(node);\r\n\t\t\t\t\t\tthis.caret.setEnd(node);\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar block = this.block.blocks[0];\r\n\t\t\t\t\tif (block === false) return;\r\n\r\n\t\t\t\t\tif (block.tagName == 'LI')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (tag != 'blockquote') return;\r\n\r\n\t\t\t\t\t\tthis.block.formatListToBlockquote();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar isContainerTable = (this.block.containerTag  == 'TD' || this.block.containerTag  == 'TH');\r\n\t\t\t\t\tif (isContainerTable && !this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdocument.execCommand('formatblock', false, '<' + tag + '>');\r\n\r\n\t\t\t\t\t\tblock = this.selection.getBlock();\r\n\t\t\t\t\t\tthis.block.toggle($(block));\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (block.tagName.toLowerCase() != tag)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.opts.linebreaks && tag == 'p')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(block).append('<br>');\r\n\t\t\t\t\t\t\tthis.utils.replaceWithContents(block);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $formatted = this.utils.replaceToTag(block, tag);\r\n\r\n\t\t\t\t\t\t\tthis.block.toggle($formatted);\r\n\r\n\t\t\t\t\t\t\tif (tag != 'p' && tag != 'blockquote') $formatted.find('img').remove();\r\n\t\t\t\t\t\t\tif (this.block.isRemoveInline) this.utils.removeInlineTags($formatted);\r\n\t\t\t\t\t\t\tif (tag == 'p' || this.block.headTag) $formatted.find('p').contents().unwrap();\r\n\r\n\t\t\t\t\t\t\tthis.block.formatTableWrapping($formatted);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (tag == 'blockquote' && block.tagName.toLowerCase() == tag)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// blockquote off\r\n\t\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(block).append('<br>');\r\n\t\t\t\t\t\t\tthis.utils.replaceWithContents(block);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $el = this.utils.replaceToTag(block, 'p');\r\n\t\t\t\t\t\t\tthis.block.toggle($el);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (block.tagName.toLowerCase() == tag)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.block.toggle($(block));\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif (typeof this.block.type == 'undefined' && typeof this.block.value == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(block).removeAttr('class').removeAttr('style');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetMultiple: function(tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar block = this.block.blocks[0];\r\n\r\n\t\t\t\t\tvar isContainerTable = (this.block.containerTag  == 'TD' || this.block.containerTag  == 'TH');\r\n\r\n\t\t\t\t\tif (block !== false && this.block.blocksSize === 1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (block.tagName.toLowerCase() == tag &&  tag == 'blockquote')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// blockquote off\r\n\t\t\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$(block).append('<br>');\r\n\t\t\t\t\t\t\t\tthis.utils.replaceWithContents(block);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar $el = this.utils.replaceToTag(block, 'p');\r\n\t\t\t\t\t\t\t\tthis.block.toggle($el);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (block.tagName == 'LI')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (tag != 'blockquote') return;\r\n\r\n\t\t\t\t\t\t\tthis.block.formatListToBlockquote();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (this.block.containerTag == 'BLOCKQUOTE')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.block.formatBlockquote(tag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (this.opts.linebreaks && ((isContainerTable) || (this.range.commonAncestorContainer != block)))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.block.formatWrap(tag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (this.opts.linebreaks && tag == 'p')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$(block).prepend('<br>').append('<br>');\r\n\t\t\t\t\t\t\t\tthis.utils.replaceWithContents(block);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (block.tagName === 'TD')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthis.block.formatWrap(tag);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar $formatted = this.utils.replaceToTag(block, tag);\r\n\r\n\t\t\t\t\t\t\t\tthis.block.toggle($formatted);\r\n\r\n\t\t\t\t\t\t\t\tif (this.block.isRemoveInline) this.utils.removeInlineTags($formatted);\r\n\t\t\t\t\t\t\t\tif (tag == 'p' || this.block.headTag) $formatted.find('p').contents().unwrap();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.opts.linebreaks || tag != 'p')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (tag == 'blockquote')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar count = 0;\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < this.block.blocksSize; i++)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif (this.block.blocks[i].tagName == 'BLOCKQUOTE') count++;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// only blockquote selected\r\n\t\t\t\t\t\t\t\tif (count == this.block.blocksSize)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$.each(this.block.blocks, $.proxy(function(i,s)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tvar $formatted = false;\r\n\t\t\t\t\t\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$(s).prepend('<br>').append('<br>');\r\n\t\t\t\t\t\t\t\t\t\t\t$formatted = this.utils.replaceWithContents(s);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$formatted = this.utils.replaceToTag(s, 'p');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ($formatted && typeof this.block.type == 'undefined' && typeof this.block.value == 'undefined')\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$formatted.removeAttr('class').removeAttr('style');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis.block.formatWrap(tag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar classSize = 0;\r\n\t\t\t\t\t\t\tvar toggleType = false;\r\n\t\t\t\t\t\t\tif (this.block.type == 'class')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttoggleType = 'toggle';\r\n\t\t\t\t\t\t\t\tclassSize = $(this.block.blocks).filter('.' + this.block.value).length;\r\n\r\n\t\t\t\t\t\t\t\tif (this.block.blocksSize == classSize) toggleType = 'toggle';\r\n\t\t\t\t\t\t\t\telse if (this.block.blocksSize > classSize) toggleType = 'set';\r\n\t\t\t\t\t\t\t\telse if (classSize === 0) toggleType = 'set';\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar exceptTags = ['ul', 'ol', 'li', 'td', 'th', 'dl', 'dt', 'dd'];\r\n\t\t\t\t\t\t\t$.each(this.block.blocks, $.proxy(function(i,s)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif ($.inArray(s.tagName.toLowerCase(), exceptTags) != -1) return;\r\n\r\n\t\t\t\t\t\t\t\tvar $formatted = this.utils.replaceToTag(s, tag);\r\n\r\n\t\t\t\t\t\t\t\tif (toggleType)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif (toggleType == 'toggle') this.block.toggle($formatted);\r\n\t\t\t\t\t\t\t\t\telse if (toggleType == 'remove') this.block.remove($formatted);\r\n\t\t\t\t\t\t\t\t\telse if (toggleType == 'set') this.block.setForce($formatted);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse this.block.toggle($formatted);\r\n\r\n\t\t\t\t\t\t\t\tif (tag != 'p' && tag != 'blockquote') $formatted.find('img').remove();\r\n\t\t\t\t\t\t\t\tif (this.block.isRemoveInline) this.utils.removeInlineTags($formatted);\r\n\t\t\t\t\t\t\t\tif (tag == 'p' || this.block.headTag) $formatted.find('p').contents().unwrap();\r\n\r\n\t\t\t\t\t\t\t\tif (typeof this.block.type == 'undefined' && typeof this.block.value == 'undefined')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$formatted.removeAttr('class').removeAttr('style');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetForce: function($el)\r\n\t\t\t\t{\r\n\t\t\t\t\t// remove style and class if the specified setting\r\n\t\t\t\t\tif (this.block.clearStyle)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$el.removeAttr('class').removeAttr('style');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.block.type == 'class')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$el.addClass(this.block.value);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this.block.type == 'attr' || this.block.type == 'data')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$el.attr(this.block.value.name, this.block.value.value);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttoggle: function($el)\r\n\t\t\t\t{\r\n\t\t\t\t\t// remove style and class if the specified setting\r\n\t\t\t\t\tif (this.block.clearStyle)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$el.removeAttr('class').removeAttr('style');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.block.type == 'class')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$el.toggleClass(this.block.value);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this.block.type == 'attr' || this.block.type == 'data')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($el.attr(this.block.value.name) == this.block.value.value)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$el.removeAttr(this.block.value.name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$el.attr(this.block.value.name, this.block.value.value);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$el.removeAttr('style class');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremove: function($el)\r\n\t\t\t\t{\r\n\t\t\t\t\t$el.removeClass(this.block.value);\r\n\t\t\t\t},\r\n\t\t\t\tformatListToBlockquote: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar block = $(this.block.blocks[0]).closest('ul, ol', this.$editor[0]);\r\n\r\n\t\t\t\t\t$(block).find('ul, ol').contents().unwrap();\r\n\t\t\t\t\t$(block).find('li').append($('<br>')).contents().unwrap();\r\n\r\n\t\t\t\t\tvar $el = this.utils.replaceToTag(block, 'blockquote');\r\n\t\t\t\t\tthis.block.toggle($el);\r\n\t\t\t\t},\r\n\t\t\t\tformatBlockquote: function(tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tdocument.execCommand('outdent');\r\n\t\t\t\t\tdocument.execCommand('formatblock', false, tag);\r\n\r\n\t\t\t\t\tthis.clean.clearUnverified();\r\n\t\t\t\t\tthis.$editor.find('p:empty').remove();\r\n\r\n\t\t\t\t\tvar formatted = this.selection.getBlock();\r\n\r\n\t\t\t\t\tif (tag != 'p')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(formatted).find('img').remove();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.block.toggle($(formatted));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$editor.find('ul, ol, tr, blockquote, p').each($.proxy(this.utils.removeEmpty, this));\r\n\r\n\t\t\t\t\tif (this.opts.linebreaks && tag == 'p')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.utils.replaceWithContents(formatted);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tformatWrap: function(tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.block.containerTag == 'UL' || this.block.containerTag == 'OL')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (tag == 'blockquote')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.block.formatListToBlockquote();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar formatted = this.selection.wrap(tag);\r\n\t\t\t\t\tif (formatted === false) return;\r\n\r\n\t\t\t\t\tvar $formatted = $(formatted);\r\n\r\n\t\t\t\t\tthis.block.formatTableWrapping($formatted);\r\n\r\n\t\t\t\t\tvar $elements = $formatted.find(this.opts.blockLevelElements.join(',') + ', td, table, thead, tbody, tfoot, th, tr');\r\n\r\n\t\t\t\t\t$elements.contents().unwrap();\r\n\r\n\t\t\t\t\tif (tag != 'p' && tag != 'blockquote') $formatted.find('img').remove();\r\n\r\n\t\t\t\t\t$.each(this.block.blocks, $.proxy(this.utils.removeEmpty, this));\r\n\r\n\t\t\t\t\t$formatted.append(this.selection.getMarker(2));\r\n\r\n\t\t\t\t\tif (!this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.block.toggle($formatted);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$editor.find('ul, ol, tr, blockquote, p').each($.proxy(this.utils.removeEmpty, this));\r\n\t\t\t\t\t$formatted.find('blockquote:empty').remove();\r\n\r\n\t\t\t\t\tif (this.block.isRemoveInline)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.utils.removeInlineTags($formatted);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.opts.linebreaks && tag == 'p')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.utils.replaceWithContents($formatted);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $next = $formatted.next().next();\r\n\t\t\t\t\t\tif ($next.size() != 0 && $next[0].tagName === 'BR')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$next.remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t\t},\r\n\t\t\t\tformatTableWrapping: function($formatted)\r\n\t\t\t\t{\r\n\t\t\t\t\tif ($formatted.closest('table', this.$editor[0]).length === 0) return;\r\n\r\n\t\t\t\t\tif ($formatted.closest('tr', this.$editor[0]).length === 0) $formatted.wrap('<tr>');\r\n\t\t\t\t\tif ($formatted.closest('td', this.$editor[0]).length === 0 && $formatted.closest('th').length === 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$formatted.wrap('<td>');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremoveData: function(name, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\t\t\t\t\t$(blocks).removeAttr('data-' + name);\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tsetData: function(name, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\t\t\t\t\t$(blocks).attr('data-' + name, value);\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\ttoggleData: function(name, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\t\t\t\t\t$.each(blocks, function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($(this).attr('data-' + name))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).removeAttr('data-' + name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).attr('data-' + name, value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tremoveAttr: function(attr, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\t\t\t\t\t$(blocks).removeAttr(attr);\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tsetAttr: function(attr, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\t\t\t\t\t$(blocks).attr(attr, value);\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\ttoggleAttr: function(attr, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\t\t\t\t\t$.each(blocks, function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($(this).attr(name))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).removeAttr(name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).attr(name, value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tremoveClass: function(className)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\t\t\t\t\t$(blocks).removeClass(className);\r\n\r\n\t\t\t\t\tthis.utils.removeEmptyAttr(blocks, 'class');\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tsetClass: function(className)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\t\t\t\t\t$(blocks).addClass(className);\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\ttoggleClass: function(className)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\t\t\t\t\t$(blocks).toggleClass(className);\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tbuffer: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tset: function(type)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof type == 'undefined' || type == 'undo')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.buffer.setUndo();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.buffer.setRedo();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetUndo: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.save();\r\n\t\t\t\t\tthis.opts.buffer.push(this.$editor.html());\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t},\r\n\t\t\t\tsetRedo: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.save();\r\n\t\t\t\t\tthis.opts.rebuffer.push(this.$editor.html());\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t},\r\n\t\t\t\tgetUndo: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor.html(this.opts.buffer.pop());\r\n\t\t\t\t},\r\n\t\t\t\tgetRedo: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor.html(this.opts.rebuffer.pop());\r\n\t\t\t\t},\r\n\t\t\t\tadd: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.opts.buffer.push(this.$editor.html());\r\n\t\t\t\t},\r\n\t\t\t\tundo: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.buffer.length === 0) return;\r\n\r\n\t\t\t\t\tthis.buffer.set('redo');\r\n\t\t\t\t\tthis.buffer.getUndo();\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\r\n\t\t\t\t\tsetTimeout($.proxy(this.observe.load, this), 50);\r\n\t\t\t\t},\r\n\t\t\t\tredo: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.rebuffer.length === 0) return;\r\n\r\n\t\t\t\t\tthis.buffer.set('undo');\r\n\t\t\t\t\tthis.buffer.getRedo();\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\r\n\t\t\t\t\tsetTimeout($.proxy(this.observe.load, this), 50);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tbuild: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tfocused: false,\r\n\t\t\t\tblured: true,\r\n\t\t\t\trun: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.build.createContainerBox();\r\n\t\t\t\t\tthis.build.loadContent();\r\n\t\t\t\t\tthis.build.loadEditor();\r\n\t\t\t\t\tthis.build.enableEditor();\r\n\t\t\t\t\tthis.build.setCodeAndCall();\r\n\t\t\t\t},\r\n\t\t\t\tisTextarea: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn (this.$element[0].tagName === 'TEXTAREA');\r\n\t\t\t\t},\r\n\t\t\t\tcreateContainerBox: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$box = $('<div class=\"redactor-box\" role=\"application\" />');\r\n\t\t\t\t},\r\n\t\t\t\tcreateTextarea: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$textarea = $('<textarea />').attr('name', this.build.getTextareaName());\r\n\t\t\t\t},\r\n\t\t\t\tgetTextareaName: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn ((typeof(name) == 'undefined')) ? 'content-' + this.uuid : this.$element.attr('id');\r\n\t\t\t\t},\r\n\t\t\t\tloadContent: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar func = (this.build.isTextarea()) ? 'val' : 'html';\r\n\t\t\t\t\tthis.content = $.trim(this.$element[func]());\r\n\t\t\t\t},\r\n\t\t\t\tenableEditor: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor.attr({ 'contenteditable': true, 'dir': this.opts.direction });\r\n\t\t\t\t},\r\n\t\t\t\tloadEditor: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar func = (this.build.isTextarea()) ? 'fromTextarea' : 'fromElement';\r\n\t\t\t\t\tthis.build[func]();\r\n\t\t\t\t},\r\n\t\t\t\tfromTextarea: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor = $('<div />');\r\n\t\t\t\t\tthis.$textarea = this.$element;\r\n\t\t\t\t\tthis.$box.insertAfter(this.$element).append(this.$editor).append(this.$element);\r\n\t\t\t\t\tthis.$editor.addClass('redactor-editor');\r\n\r\n\t\t\t\t\tthis.$element.hide();\r\n\t\t\t\t},\r\n\t\t\t\tfromElement: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor = this.$element;\r\n\t\t\t\t\tthis.build.createTextarea();\r\n\t\t\t\t\tthis.$box.insertAfter(this.$editor).append(this.$editor).append(this.$textarea);\r\n\t\t\t\t\tthis.$editor.addClass('redactor-editor');\r\n\r\n\t\t\t\t\tthis.$textarea.hide();\r\n\t\t\t\t},\r\n\t\t\t\tsetCodeAndCall: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t// set code\r\n\t\t\t\t\tthis.code.set(this.content);\r\n\r\n\t\t\t\t\tthis.build.setOptions();\r\n\t\t\t\t\tthis.build.callEditor();\r\n\r\n\t\t\t\t\t// code mode\r\n\t\t\t\t\tif (this.opts.visual) return;\r\n\t\t\t\t\tsetTimeout($.proxy(this.code.showCode, this), 200);\r\n\t\t\t\t},\r\n\t\t\t\tcallEditor: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.build.disableMozillaEditing();\r\n\t\t\t\t\tthis.build.disableIeLinks();\r\n\t\t\t\t\tthis.build.setEvents();\r\n\t\t\t\t\tthis.build.setHelpers();\r\n\r\n\t\t\t\t\t// load toolbar\r\n\t\t\t\t\tif (this.opts.toolbar)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.opts.toolbar = this.toolbar.init();\r\n\t\t\t\t\t\tthis.toolbar.build();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// modal templates init\r\n\t\t\t\t\tthis.modal.loadTemplates();\r\n\r\n\t\t\t\t\t// plugins\r\n\t\t\t\t\tthis.build.plugins();\r\n\r\n\t\t\t\t\t// observers\r\n\t\t\t\t\tsetTimeout($.proxy(this.observe.load, this), 4);\r\n\r\n\t\t\t\t\t// init callback\r\n\t\t\t\t\tthis.core.setCallback('init');\r\n\t\t\t\t},\r\n\t\t\t\tsetOptions: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t// textarea direction\r\n\t\t\t\t\t$(this.$textarea).attr('dir', this.opts.direction);\r\n\r\n\t\t\t\t\tif (this.opts.linebreaks) this.$editor.addClass('redactor-linebreaks');\r\n\r\n\t\t\t\t\tif (this.opts.tabindex) this.$editor.attr('tabindex', this.opts.tabindex);\r\n\r\n\t\t\t\t\tif (this.opts.minHeight) this.$editor.css('minHeight', this.opts.minHeight);\r\n\t\t\t\t\tif (this.opts.maxHeight) this.$editor.css('maxHeight', this.opts.maxHeight);\r\n\r\n\t\t\t\t},\r\n\t\t\t\tsetEventDropUpload: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\tif (!this.opts.dragImageUpload && !this.opts.dragFileUpload) return;\r\n\t\t\t\t\tif (this.opts.imageUpload === null && this.opts.fileUpload === null) return;\r\n\r\n\t\t\t\t\tvar files = e.dataTransfer.files;\r\n\t\t\t\t\tthis.upload.directUpload(files[0], e);\r\n\t\t\t\t},\r\n\t\t\t\tsetEventDrop: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\tsetTimeout(this.clean.clearUnverified, 1);\r\n\t\t\t\t\tthis.core.setCallback('drop', e);\r\n\t\t\t\t},\r\n\t\t\t\tsetEvents: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t// drop\r\n\t\t\t\t\tthis.$editor.on('dragover.redactor dragenter.redactor', function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t\tthis.$editor.on('drop.redactor', $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te = e.originalEvent || e;\r\n\r\n\t\t\t\t\t\tif (window.FormData === undefined || !e.dataTransfer) return true;\r\n\r\n\t\t\t\t\t\tif (e.dataTransfer.files.length === 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn this.build.setEventDrop(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.build.setEventDropUpload(e);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tsetTimeout(this.clean.clearUnverified, 1);\r\n\t\t\t\t\t\tthis.core.setCallback('drop', e);\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\r\n\t\t\t\t\t// click\r\n\t\t\t\t\tthis.$editor.on('click.redactor', $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar event = this.core.getEvent();\r\n\t\t\t\t\t\tvar type = (event == 'click' || event == 'arrow') ? false : 'click';\r\n\r\n\t\t\t\t\t\tthis.core.addEvent(type);\r\n\t\t\t\t\t\tthis.utils.disableSelectAll();\r\n\t\t\t\t\t\tthis.core.setCallback('click', e);\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t// paste\r\n\t\t\t\t\tthis.$editor.on('paste.redactor', $.proxy(this.paste.init, this));\r\n\r\n\t\t\t\t\t// cut\r\n\t\t\t\t\tthis.$editor.on('cut.redactor', $.proxy(this.code.sync, this));\r\n\r\n\t\t\t\t\t// keydown\r\n\t\t\t\t\tthis.$editor.on('keydown.redactor', $.proxy(this.keydown.init, this));\r\n\r\n\t\t\t\t\t// keyup\r\n\t\t\t\t\tthis.$editor.on('keyup.redactor', $.proxy(this.keyup.init, this));\r\n\r\n\t\t\t\t\t// textarea keydown\r\n\t\t\t\t\tif ($.isFunction(this.opts.codeKeydownCallback))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$textarea.on('keydown.redactor-textarea', $.proxy(this.opts.codeKeydownCallback, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// textarea keyup\r\n\t\t\t\t\tif ($.isFunction(this.opts.codeKeyupCallback))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$textarea.on('keyup.redactor-textarea', $.proxy(this.opts.codeKeyupCallback, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// focus\r\n\t\t\t\t\tthis.$editor.on('focus.redactor', $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($.isFunction(this.opts.focusCallback))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.core.setCallback('focus', e);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.build.focused = true;\r\n\t\t\t\t\t\tthis.build.blured = false;\r\n\r\n\t\t\t\t\t\tif (this.selection.getCurrent() === false)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\t\t\tthis.range.setStart(this.$editor[0], 0);\r\n\t\t\t\t\t\t\tthis.range.setEnd(this.$editor[0], 0);\r\n\t\t\t\t\t\t\tthis.selection.addRange();\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\r\n\t\t\t\t\t// blur\r\n\t\t\t\t\t$(document).on('mousedown.redactor-blur.' + this.uuid, $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.start) return;\r\n\t\t\t\t\t\tif (this.rtePaste) return;\r\n\r\n\t\t\t\t\t\tif ($(e.target).closest('.redactor-editor, .redactor-toolbar, .redactor-dropdown').size() !== 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.utils.disableSelectAll();\r\n\t\t\t\t\t\tif (!this.build.blured && $.isFunction(this.opts.blurCallback))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.core.setCallback('blur', e);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.build.focused = false;\r\n\t\t\t\t\t\tthis.build.blured = true;\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t},\r\n\t\t\t\tsetHelpers: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t// linkify\r\n\t\t\t\t\tif (this.linkify.isEnabled())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.linkify.format();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// placeholder\r\n\t\t\t\t\tthis.placeholder.enable();\r\n\r\n\t\t\t\t\t// focus\r\n\t\t\t\t\tif (this.opts.focus) setTimeout(this.focus.setStart, 100);\r\n\t\t\t\t\tif (this.opts.focusEnd) setTimeout(this.focus.setEnd, 100);\r\n\r\n\t\t\t\t},\r\n\t\t\t\tplugins: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.plugins) return;\r\n\r\n\t\t\t\t\t$.each(this.opts.plugins, $.proxy(function(i, s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar func = (typeof RedactorPlugins !== 'undefined' && typeof RedactorPlugins[s] !== 'undefined') ? RedactorPlugins : Redactor.fn;\r\n\r\n\t\t\t\t\t\tif (!$.isFunction(func[s]))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis[s] = func[s]();\r\n\r\n\t\t\t\t\t\t// get methods\r\n\t\t\t\t\t\tvar methods = this.getModuleMethods(this[s]);\r\n\t\t\t\t\t\tvar len = methods.length;\r\n\r\n\t\t\t\t\t\t// bind methods\r\n\t\t\t\t\t\tfor (var z = 0; z < len; z++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis[s][methods[z]] = this[s][methods[z]].bind(this);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ($.isFunction(this[s].init))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis[s].init();\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t},\r\n\t\t\t\tdisableMozillaEditing: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.utils.browser('mozilla')) return;\r\n\r\n\t\t\t\t\t// FF fix\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tdocument.execCommand('enableObjectResizing', false, false);\r\n\t\t\t\t\t\tdocument.execCommand('enableInlineTableEditing', false, false);\r\n\t\t\t\t\t} catch (e) {}\r\n\t\t\t\t},\r\n\t\t\t\tdisableIeLinks: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.utils.browser('msie')) return;\r\n\r\n\t\t\t\t\t// IE prevent converting links\r\n\t\t\t\t\tdocument.execCommand(\"AutoUrlDetect\", false, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tbutton: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tbuild: function(btnName, btnObject)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $button = $('<a href=\"#\" class=\"re-icon re-' + btnName + '\" rel=\"' + btnName + '\" />').attr({'role': 'button', 'aria-label': btnObject.title, 'tabindex': '-1'});\r\n\r\n\t\t\t\t\t// click\r\n\t\t\t\t\tif (btnObject.func || btnObject.command || btnObject.dropdown)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.button.setEvent($button, btnName, btnObject);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// dropdown\r\n\t\t\t\t\tif (btnObject.dropdown)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$button.addClass('redactor-toolbar-link-dropdown').attr('aria-haspopup', true);\r\n\r\n\t\t\t\t\t\tvar $dropdown = $('<div class=\"redactor-dropdown redactor-dropdown-' + this.uuid + ' redactor-dropdown-box-' + btnName + '\" style=\"display: none;\">');\r\n\t\t\t\t\t\t$button.data('dropdown', $dropdown);\r\n\t\t\t\t\t\tthis.dropdown.build(btnName, $dropdown, btnObject.dropdown);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// tooltip\r\n\t\t\t\t\tif (this.utils.isDesktop())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.button.createTooltip($button, btnName, btnObject.title);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn $button;\r\n\t\t\t\t},\r\n\t\t\t\tsetEvent: function($button, btnName, btnObject)\r\n\t\t\t\t{\r\n\t\t\t\t\t$button.on('touchstart click', $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($button.hasClass('redactor-button-disabled')) return false;\r\n\r\n\t\t\t\t\t\tvar type = 'func';\r\n\t\t\t\t\t\tvar callback = btnObject.func;\r\n\r\n\t\t\t\t\t\tif (btnObject.command)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype = 'command';\r\n\t\t\t\t\t\t\tcallback = btnObject.command;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (btnObject.dropdown)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype = 'dropdown';\r\n\t\t\t\t\t\t\tcallback = false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.button.onClick(e, btnName, type, callback);\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tcreateTooltip: function($button, name, title)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $tooltip = $('<span>').addClass('redactor-toolbar-tooltip redactor-toolbar-tooltip-' + this.uuid + ' redactor-toolbar-tooltip-' + name).hide().html(title);\r\n\t\t\t\t\t$tooltip.appendTo('body');\r\n\r\n\t\t\t\t\t$button.on('mouseover', function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($(this).hasClass('redactor-button-disabled'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar pos = $button.offset();\r\n\r\n\t\t\t\t\t\t$tooltip.css({\r\n\t\t\t\t\t\t\ttop: (pos.top + $button.innerHeight()) + 'px',\r\n\t\t\t\t\t\t\tleft: (pos.left + $button.innerWidth()/2 - $tooltip.innerWidth()/2) + 'px'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t$tooltip.show();\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$button.on('mouseout', function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$tooltip.hide();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t},\r\n\t\t\t\tonClick: function(e, btnName, type, callback)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.button.caretOffset = this.caret.getOffset();\r\n\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t$(document).find('.redactor-toolbar-tooltip').hide();\r\n\r\n\t\t\t\t\tif (this.utils.browser('msie')) e.returnValue = false;\r\n\r\n\t\t\t\t\tif (type == 'command') this.inline.format(callback);\r\n\t\t\t\t\telse if (type == 'dropdown') this.dropdown.show(e, btnName);\r\n\t\t\t\t\telse this.button.onClickCallback(e, callback, btnName);\r\n\t\t\t\t},\r\n\t\t\t\tonClickCallback: function(e, callback, btnName)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar func;\r\n\r\n\t\t\t\t\tif ($.isFunction(callback)) callback.call(this, btnName);\r\n\t\t\t\t\telse if (callback.search(/\\./) != '-1')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfunc = callback.split('.');\r\n\t\t\t\t\t\tif (typeof this[func[0]] == 'undefined') return;\r\n\r\n\t\t\t\t\t\tthis[func[0]][func[1]](btnName);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse this[callback](btnName);\r\n\r\n\t\t\t\t\tthis.observe.buttons(e, btnName);\r\n\t\t\t\t},\r\n\t\t\t\tget: function(key)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.$toolbar.find('a.re-' + key);\r\n\t\t\t\t},\r\n\t\t\t\tsetActive: function(key)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.button.get(key).addClass('redactor-act');\r\n\t\t\t\t},\r\n\t\t\t\tsetInactive: function(key)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.button.get(key).removeClass('redactor-act');\r\n\t\t\t\t},\r\n\t\t\t\tsetInactiveAll: function(key)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof key === 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$toolbar.find('a.re-icon').removeClass('redactor-act');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$toolbar.find('a.re-icon').not('.re-' + key).removeClass('redactor-act');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetActiveInVisual: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$toolbar.find('a.re-icon').not('a.re-html, a.re-fullscreen').removeClass('redactor-button-disabled');\r\n\t\t\t\t},\r\n\t\t\t\tsetInactiveInCode: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$toolbar.find('a.re-icon').not('a.re-html, a.re-fullscreen').addClass('redactor-button-disabled');\r\n\t\t\t\t},\r\n\t\t\t\tchangeIcon: function(key, classname)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.button.get(key).addClass('re-' + classname);\r\n\t\t\t\t},\r\n\t\t\t\tremoveIcon: function(key, classname)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.button.get(key).removeClass('re-' + classname);\r\n\t\t\t\t},\r\n\t\t\t\tsetAwesome: function(key, name)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $button = this.button.get(key);\r\n\t\t\t\t\t$button.removeClass('redactor-btn-image').addClass('fa-redactor-btn');\r\n\t\t\t\t\t$button.html('<i class=\"fa ' + name + '\"></i>');\r\n\t\t\t\t},\r\n\t\t\t\taddCallback: function($btn, callback)\r\n\t\t\t\t{\r\n\t\t\t\t\tif ($btn == \"buffer\") return;\r\n\r\n\t\t\t\t\tvar type = (callback == 'dropdown') ? 'dropdown' : 'func';\r\n\t\t\t\t\tvar key = $btn.attr('rel');\r\n\t\t\t\t\t$btn.on('touchstart click', $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($btn.hasClass('redactor-button-disabled')) return false;\r\n\t\t\t\t\t\tthis.button.onClick(e, key, type, callback);\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\taddDropdown: function($btn, dropdown)\r\n\t\t\t\t{\r\n\t\t\t\t\t$btn.addClass('redactor-toolbar-link-dropdown').attr('aria-haspopup', true);\r\n\r\n\t\t\t\t\tvar key = $btn.attr('rel');\r\n\t\t\t\t\tthis.button.addCallback($btn, 'dropdown');\r\n\r\n\t\t\t\t\tvar $dropdown = $('<div class=\"redactor-dropdown redactor-dropdown-' + this.uuid + ' redactor-dropdown-box-' + key + '\" style=\"display: none;\">');\r\n\t\t\t\t\t$btn.data('dropdown', $dropdown);\r\n\r\n\t\t\t\t\t// build dropdown\r\n\t\t\t\t\tif (dropdown) this.dropdown.build(key, $dropdown, dropdown);\r\n\r\n\t\t\t\t\treturn $dropdown;\r\n\t\t\t\t},\r\n\t\t\t\tadd: function(key, title)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.toolbar) return;\r\n\r\n\t\t\t\t\tif (this.button.isMobileUndoRedo(key)) return \"buffer\";\r\n\r\n\t\t\t\t\tvar btn = this.button.build(key, { title: title });\r\n\t\t\t\t\tbtn.addClass('redactor-btn-image');\r\n\r\n\t\t\t\t\tthis.$toolbar.append($('<li>').append(btn));\r\n\r\n\t\t\t\t\treturn btn;\r\n\t\t\t\t},\r\n\t\t\t\taddFirst: function(key, title)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.toolbar) return;\r\n\r\n\t\t\t\t\tif (this.button.isMobileUndoRedo(key)) return \"buffer\";\r\n\r\n\t\t\t\t\tvar btn = this.button.build(key, { title: title });\r\n\t\t\t\t\tbtn.addClass('redactor-btn-image');\r\n\t\t\t\t\tthis.$toolbar.prepend($('<li>').append(btn));\r\n\r\n\t\t\t\t\treturn btn;\r\n\t\t\t\t},\r\n\t\t\t\taddAfter: function(afterkey, key, title)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.toolbar) return;\r\n\r\n\t\t\t\t\tif (this.button.isMobileUndoRedo(key)) return \"buffer\";\r\n\r\n\t\t\t\t\tvar btn = this.button.build(key, { title: title });\r\n\t\t\t\t\tbtn.addClass('redactor-btn-image');\r\n\t\t\t\t\tvar $btn = this.button.get(afterkey);\r\n\r\n\t\t\t\t\tif ($btn.length !== 0) $btn.parent().after($('<li>').append(btn));\r\n\t\t\t\t\telse this.$toolbar.append($('<li>').append(btn));\r\n\r\n\t\t\t\t\treturn btn;\r\n\t\t\t\t},\r\n\t\t\t\taddBefore: function(beforekey, key, title)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.toolbar) return;\r\n\r\n\t\t\t\t\tif (this.button.isMobileUndoRedo(key)) return \"buffer\";\r\n\r\n\t\t\t\t\tvar btn = this.button.build(key, { title: title });\r\n\t\t\t\t\tbtn.addClass('redactor-btn-image');\r\n\t\t\t\t\tvar $btn = this.button.get(beforekey);\r\n\r\n\t\t\t\t\tif ($btn.length !== 0) $btn.parent().before($('<li>').append(btn));\r\n\t\t\t\t\telse this.$toolbar.append($('<li>').append(btn));\r\n\r\n\t\t\t\t\treturn btn;\r\n\t\t\t\t},\r\n\t\t\t\tremove: function(key)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.button.get(key).remove();\r\n\t\t\t\t},\r\n\t\t\t\tisMobileUndoRedo: function(key)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn (key == \"undo\" || key == \"redo\") && !this.utils.isDesktop();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tcaret: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tsetStart: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\t// inline tag\r\n\t\t\t\t\tif (!this.utils.isBlock(node))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar space = this.utils.createSpaceElement();\r\n\r\n\t\t\t\t\t\t$(node).prepend(space);\r\n\t\t\t\t\t\tthis.caret.setEnd(space);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.caret.set(node, 0, node, 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetEnd: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\tnode = node[0] || node;\r\n\t\t\t\t\tif (node.lastChild.nodeType == 1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn this.caret.setAfter(node.lastChild);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.caret.set(node, 1, node, 1);\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function(orgn, orgo, focn, foco)\r\n\t\t\t\t{\r\n\t\t\t\t\t// focus\r\n\t\t\t\t\t// disabled in 10.0.7\r\n\t\t\t\t\t// if (!this.utils.browser('msie')) this.$editor.focus();\r\n\r\n\t\t\t\t\torgn = orgn[0] || orgn;\r\n\t\t\t\t\tfocn = focn[0] || focn;\r\n\r\n\t\t\t\t\tif (this.utils.isBlockTag(orgn.tagName) && orgn.innerHTML === '')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\torgn.innerHTML = this.opts.invisibleSpace;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (orgn.tagName == 'BR' && this.opts.linebreaks === false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar parent = $(this.opts.emptyHtml)[0];\r\n\t\t\t\t\t\t$(orgn).replaceWith(parent);\r\n\t\t\t\t\t\torgn = parent;\r\n\t\t\t\t\t\tfocn = orgn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.range.setStart(orgn, orgo);\r\n\t\t\t\t\t\tthis.range.setEnd(focn, foco);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (e) {}\r\n\r\n\t\t\t\t\tthis.selection.addRange();\r\n\t\t\t\t},\r\n\t\t\t\tsetAfter: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\ttry\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar tag = $(node)[0].tagName;\r\n\r\n\t\t\t\t\t\t// inline tag\r\n\t\t\t\t\t\tif (tag != 'BR' && !this.utils.isBlock(node))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar space = this.utils.createSpaceElement();\r\n\r\n\t\t\t\t\t\t\t$(node).after(space);\r\n\t\t\t\t\t\t\tthis.caret.setEnd(space);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (tag != 'BR' && this.utils.browser('msie'))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthis.caret.setStart($(node).next());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthis.caret.setAfterOrBefore(node, 'after');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar space = this.utils.createSpaceElement();\r\n\t\t\t\t\t\t$(node).after(space);\r\n\t\t\t\t\t\tthis.caret.setEnd(space);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetBefore: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\t// block tag\r\n\t\t\t\t\tif (this.utils.isBlock(node))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.caret.setEnd($(node).prev());\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.caret.setAfterOrBefore(node, 'before');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetAfterOrBefore: function(node, type)\r\n\t\t\t\t{\r\n\t\t\t\t\t// focus\r\n\t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\r\n\r\n\t\t\t\t\tnode = node[0] || node;\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tif (type == 'after')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttry {\r\n\r\n\t\t\t\t\t\t\tthis.range.setStartAfter(node);\r\n\t\t\t\t\t\t\tthis.range.setEndAfter(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcatch (e) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tthis.range.setStartBefore(node);\r\n\t\t\t\t\t\t\tthis.range.setEndBefore(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcatch (e) {}\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tthis.range.collapse(false);\r\n\t\t\t\t\tthis.selection.addRange();\r\n\t\t\t\t},\r\n\t\t\t\tgetOffsetOfElement: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\tnode = node[0] || node;\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tvar cloned = this.range.cloneRange();\r\n\t\t\t\t\tcloned.selectNodeContents(node);\r\n\t\t\t\t\tcloned.setEnd(this.range.endContainer, this.range.endOffset);\r\n\r\n\t\t\t\t\treturn $.trim(cloned.toString()).length;\r\n\t\t\t\t},\r\n\t\t\t\tgetOffset: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar offset = 0;\r\n\t\t\t\t    var sel = window.getSelection();\r\n\r\n\t\t\t\t    if (sel.rangeCount > 0)\r\n\t\t\t\t    {\r\n\t\t\t\t        var range = window.getSelection().getRangeAt(0);\r\n\t\t\t\t        var caretRange = range.cloneRange();\r\n\t\t\t\t        caretRange.selectNodeContents(this.$editor[0]);\r\n\t\t\t\t        caretRange.setEnd(range.endContainer, range.endOffset);\r\n\t\t\t\t        offset = caretRange.toString().length;\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t\treturn offset;\r\n\t\t\t\t},\r\n\t\t\t\tsetOffset: function(start, end)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof end == 'undefined') end = start;\r\n\t\t\t\t\tif (!this.focus.isFocused()) this.focus.setStart();\r\n\r\n\t\t\t\t\tvar sel = this.selection.get();\r\n\t\t\t\t\tvar node, offset = 0;\r\n\t\t\t\t\tvar walker = document.createTreeWalker(this.$editor[0], NodeFilter.SHOW_TEXT, null, null);\r\n\r\n\t\t\t\t\twhile (node = walker.nextNode())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toffset += node.nodeValue.length;\r\n\t\t\t\t\t\tif (offset > start)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.range.setStart(node, node.nodeValue.length + start - offset);\r\n\t\t\t\t\t\t\tstart = Infinity;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (offset >= end)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.range.setEnd(node, node.nodeValue.length + end - offset);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.range.collapse(false);\r\n\t\t\t\t\tthis.selection.addRange();\r\n\t\t\t\t},\r\n\t\t\t\t// deprecated\r\n\t\t\t\tsetToPoint: function(start, end)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.caret.setOffset(start, end);\r\n\t\t\t\t},\r\n\t\t\t\tgetCoords: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.caret.getOffset();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tclean: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tonSet: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = this.clean.savePreCode(html);\r\n\r\n\t\t\t\t\t// convert script tag\r\n\t\t\t\t\thtml = html.replace(/<script(.*?[^>]?)>([\\w\\W]*?)<\\/script>/gi, '<pre class=\"redactor-script-tag\" style=\"display: none;\" $1>$2</pre>');\r\n\r\n\t\t\t\t\t// replace dollar sign to entity\r\n\t\t\t\t\thtml = html.replace(/\\$/g, '&#36;');\r\n\r\n\t\t\t\t\t// replace special characters in links\r\n\t\t\t\t\thtml = html.replace(/<a href=\"(.*?[^>]?)®(.*?[^>]?)\">/gi, '<a href=\"$1&reg$2\">');\r\n\r\n\t\t\t\t\tif (this.opts.replaceDivs && !this.opts.linebreaks) html = this.clean.replaceDivs(html);\r\n\t\t\t\t\tif (this.opts.linebreaks)  html = this.clean.replaceParagraphsToBr(html);\r\n\r\n\t\t\t\t\t// save form tag\r\n\t\t\t\t\thtml = this.clean.saveFormTags(html);\r\n\r\n\t\t\t\t\t// convert font tag to span\r\n\t\t\t\t\tvar $div = $('<div>');\r\n\t\t\t\t\t$div.html(html);\r\n\t\t\t\t\tvar fonts = $div.find('font[style]');\r\n\t\t\t\t\tif (fonts.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfonts.replaceWith(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $el = $(this);\r\n\t\t\t\t\t\t\tvar $span = $('<span>').attr('style', $el.attr('style'));\r\n\t\t\t\t\t\t\treturn $span.append($el.contents());\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\thtml = $div.html();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$div.remove();\r\n\r\n\t\t\t\t\t// remove font tag\r\n\t\t\t\t\thtml = html.replace(/<font(.*?)>/gi, '');\r\n\t\t\t\t\thtml = html.replace(/<\\/font>/gi, '');\r\n\r\n\t\t\t\t\t// tidy html\r\n\t\t\t\t\thtml = this.tidy.load(html);\r\n\r\n\t\t\t\t\t// paragraphize\r\n\t\t\t\t\tif (this.opts.paragraphize) html = this.paragraphize.load(html);\r\n\r\n\t\t\t\t\t// verified\r\n\t\t\t\t\thtml = this.clean.setVerified(html);\r\n\r\n\t\t\t\t\t// convert inline tags\r\n\t\t\t\t\thtml = this.clean.convertInline(html);\r\n\r\n\t\t\t\t\thtml = html.replace(/&amp;/g, '&');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tonSync: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\t// remove spaces\r\n\t\t\t\t\thtml = html.replace(/\\u200B/g, '');\r\n\t\t\t\t\thtml = html.replace(/&#x200b;/gi, '');\r\n\r\n\t\t\t\t\tif (this.opts.cleanSpaces)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/&nbsp;/gi, ' ');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (html.search(/^<p>(||\\s||<br\\s?\\/?>||&nbsp;)<\\/p>$/i) != -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// reconvert script tag\r\n\t\t\t\t\thtml = html.replace(/<pre class=\"redactor-script-tag\" style=\"display: none;\"(.*?[^>]?)>([\\w\\W]*?)<\\/pre>/gi, '<script$1>$2</script>');\r\n\r\n\t\t\t\t\t// restore form tag\r\n\t\t\t\t\thtml = this.clean.restoreFormTags(html);\r\n\r\n\t\t\t\t\tvar chars = {\r\n\t\t\t\t\t\t'\\u2122': '&trade;',\r\n\t\t\t\t\t\t'\\u00a9': '&copy;',\r\n\t\t\t\t\t\t'\\u2026': '&hellip;',\r\n\t\t\t\t\t\t'\\u2014': '&mdash;',\r\n\t\t\t\t\t\t'\\u2010': '&dash;'\r\n\t\t\t\t\t};\r\n\t\t\t\t\t// replace special characters\r\n\t\t\t\t\t$.each(chars, function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(new RegExp(i, 'g'), s);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// remove last br in FF\r\n\t\t\t\t\tif (this.utils.browser('mozilla'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/<br\\s?\\/?>$/gi, '');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// remove br in|of li tags\r\n\t\t\t\t\thtml = html.replace(new RegExp('<br\\\\s?/?></li>', 'gi'), '</li>');\r\n\t\t\t\t\thtml = html.replace(new RegExp('</li><br\\\\s?/?>', 'gi'), '</li>');\r\n\r\n\t\t\t\t\t// remove empty attributes\r\n\t\t\t\t\thtml = html.replace(/<(.*?)rel=\"\\s*?\"(.*?[^>]?)>/gi, '<$1$2\">');\r\n\t\t\t\t\thtml = html.replace(/<(.*?)style=\"\\s*?\"(.*?[^>]?)>/gi, '<$1$2\">');\r\n\t\t\t\t\thtml = html.replace(/=\"\">/gi, '>');\r\n\t\t\t\t\thtml = html.replace(/\"\"\">/gi, '\">');\r\n\t\t\t\t\thtml = html.replace(/\"\">/gi, '\">');\r\n\r\n\t\t\t\t\t// remove verified\r\n\t\t\t\t\thtml = html.replace(/<div(.*?)data-tagblock=\"redactor\"(.*?[^>])>/gi, '<div$1$2>');\r\n\t\t\t\t\thtml = html.replace(/<(.*?) data-verified=\"redactor\"(.*?[^>])>/gi, '<$1$2>');\r\n\r\n\t\t\t\t\tvar $div = $(\"<div/>\").html($.parseHTML(html, document, true));\r\n\t\t\t\t\t$div.find(\"span\").removeAttr(\"rel\");\r\n\r\n\t\t\t\t\t$div.find('pre .redactor-invisible-space').each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).contents().unwrap();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\thtml = $div.html();\r\n\r\n\t\t\t\t\t// remove rel attribute from img\r\n\t\t\t\t\thtml = html.replace(/<img(.*?[^>])rel=\"(.*?[^>])\"(.*?[^>])>/gi, '<img$1$3>');\r\n\t\t\t\t\thtml = html.replace(/<span class=\"redactor-invisible-space\">(.*?)<\\/span>/gi, '$1');\r\n\r\n\t\t\t\t\thtml = html.replace(/ data-save-url=\"(.*?[^>])\"/gi, '');\r\n\r\n\t\t\t\t\t// remove image resize\r\n\t\t\t\t\thtml = html.replace(/<span(.*?)id=\"redactor-image-box\"(.*?[^>])>([\\w\\W]*?)<img(.*?)><\\/span>/gi, '$3<img$4>');\r\n\t\t\t\t\thtml = html.replace(/<span(.*?)id=\"redactor-image-resizer\"(.*?[^>])>(.*?)<\\/span>/gi, '');\r\n\t\t\t\t\thtml = html.replace(/<span(.*?)id=\"redactor-image-editter\"(.*?[^>])>(.*?)<\\/span>/gi, '');\r\n\r\n\t\t\t\t\t// remove font tag\r\n\t\t\t\t\thtml = html.replace(/<font(.*?)>/gi, '');\r\n\t\t\t\t\thtml = html.replace(/<\\/font>/gi, '');\r\n\r\n\t\t\t\t\t// tidy html\r\n\t\t\t\t\thtml = this.tidy.load(html);\r\n\r\n\t\t\t\t\t// link nofollow\r\n\t\t\t\t\tif (this.opts.linkNofollow)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/<a(.*?)rel=\"nofollow\"(.*?[^>])>/gi, '<a$1$2>');\r\n\t\t\t\t\t\thtml = html.replace(/<a(.*?[^>])>/gi, '<a$1 rel=\"nofollow\">');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// reconvert inline\r\n\t\t\t\t\thtml = html.replace(/\\sdata-redactor-(tag|class|style)=\"(.*?[^>])\"/gi, '');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<(.*?) data-verified=\"redactor\"(.*?[^>])>', 'gi'), '<$1$2>');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<(.*?) data-verified=\"redactor\">', 'gi'), '<$1>');\r\n\r\n\t\t\t\t\thtml = html.replace(/&amp;/g, '&');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tonPaste: function(html, setMode)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = $.trim(html);\r\n\t\t\t\t\thtml = html.replace(/\\$/g, '&#36;');\r\n\r\n\t\t\t\t\t// convert dirty spaces\r\n\t\t\t\t\thtml = html.replace(/<span class=\"s[0-9]\">/gi, '<span>');\r\n\t\t\t\t\thtml = html.replace(/<span class=\"Apple-converted-space\">&nbsp;<\\/span>/gi, ' ');\r\n\t\t\t\t\thtml = html.replace(/<span class=\"Apple-tab-span\"[^>]*>\\t<\\/span>/gi, '\\t');\r\n\t\t\t\t\thtml = html.replace(/<span[^>]*>(\\s|&nbsp;)<\\/span>/gi, ' ');\r\n\r\n\t\t\t\t\tif (this.opts.pastePlainText)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn this.clean.getPlainText(html);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!this.utils.isSelectAll() && typeof setMode == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent(['FIGCAPTION', 'A']))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn this.clean.getPlainText(html, false);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent('PRE'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\thtml = html.replace(/”/g, '\"');\r\n\t\t\t\t\t\t\thtml = html.replace(/“/g, '\"');\r\n\t\t\t\t\t\t\thtml = html.replace(/‘/g, '\\'');\r\n\t\t\t\t\t\t\thtml = html.replace(/’/g, '\\'');\r\n\r\n\t\t\t\t\t\t\treturn this.clean.getPreCode(html);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent(['BLOCKQUOTE', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6']))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\thtml = this.clean.getOnlyImages(html);\r\n\r\n\t\t\t\t\t\t\tif (!this.utils.browser('msie'))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar block = this.selection.getBlock();\r\n\t\t\t\t\t\t\t\tif (block && block.tagName == 'P')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\thtml = html.replace(/<img(.*?)>/gi, '<p><img$1></p>');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn html;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent(['TD']))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\thtml = this.clean.onPasteTidy(html, 'td');\r\n\r\n\t\t\t\t\t\t\tif (this.opts.linebreaks) html = this.clean.replaceParagraphsToBr(html);\r\n\r\n\t\t\t\t\t\t\thtml = this.clean.replaceDivsToBr(html);\r\n\r\n\t\t\t\t\t\t\treturn html;\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent(['LI']))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn this.clean.onPasteTidy(html, 'li');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\thtml = this.clean.isSingleLine(html, setMode);\r\n\r\n\t\t\t\t\tif (!this.clean.singleLine)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.opts.linebreaks)  html = this.clean.replaceParagraphsToBr(html);\r\n\t\t\t\t\t\tif (this.opts.replaceDivs) html = this.clean.replaceDivs(html);\r\n\r\n\t\t\t\t\t\thtml = this.clean.saveFormTags(html);\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\thtml = this.clean.onPasteWord(html);\r\n\t\t\t\t\thtml = this.clean.onPasteExtra(html);\r\n\r\n\t\t\t\t\thtml = this.clean.onPasteTidy(html, 'all');\r\n\r\n\r\n\t\t\t\t\t// paragraphize\r\n\t\t\t\t\tif (!this.clean.singleLine && this.opts.paragraphize)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = this.paragraphize.load(html);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thtml = this.clean.removeDirtyStyles(html);\r\n\t\t\t\t\thtml = this.clean.onPasteRemoveSpans(html);\r\n\t\t\t\t\thtml = this.clean.onPasteRemoveEmpty(html);\r\n\r\n\r\n\t\t\t\t\thtml = this.clean.convertInline(html);\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tonPasteWord: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\t// comments\r\n\t\t\t\t\thtml = html.replace(/<!--[\\s\\S]*?-->/gi, '');\r\n\r\n\t\t\t\t\t// style\r\n\t\t\t\t\thtml = html.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/gi, '');\r\n\r\n\t\t\t\t\t// op\r\n\t\t\t\t\thtml = html.replace(/<o\\:p[^>]*>[\\s\\S]*?<\\/o\\:p>/gi, '');\r\n\r\n\t\t\t\t\tif (html.match(/class=\"?Mso|style=\"[^\"]*\\bmso-|style='[^'']*\\bmso-|w:WordDocument/i))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// comments\r\n\t\t\t\t\t\thtml = html.replace(/<!--[\\s\\S]+?-->/gi, '');\r\n\r\n\t\t\t\t\t\t// scripts\r\n\t\t\t\t\t\thtml = html.replace(/<(!|script[^>]*>.*?<\\/script(?=[>\\s])|\\/?(\\?xml(:\\w+)?|img|meta|link|style|\\w:\\w+)(?=[\\s\\/>]))[^>]*>/gi, '');\r\n\r\n\t\t\t\t\t\t// Convert <s> into <strike>\r\n\t\t\t\t\t\thtml = html.replace(/<(\\/?)s>/gi, \"<$1strike>\");\r\n\r\n\t\t\t\t\t\t// Replace nbsp entites to char since it's easier to handle\r\n\t\t\t\t\t\thtml = html.replace(/ /gi, ' ');\r\n\r\n\t\t\t\t\t\t// Convert <span style=\"mso-spacerun:yes\">___</span> to string of alternating\r\n\t\t\t\t\t\t// breaking/non-breaking spaces of same length\r\n\t\t\t\t\t\thtml = html.replace(/<span\\s+style\\s*=\\s*\"\\s*mso-spacerun\\s*:\\s*yes\\s*;?\\s*\"\\s*>([\\s\\u00a0]*)<\\/span>/gi, function(str, spaces) {\r\n\t\t\t\t\t\t\treturn (spaces.length > 0) ? spaces.replace(/./, \" \").slice(Math.floor(spaces.length/2)).split(\"\").join(\"\\u00a0\") : '';\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\thtml = this.clean.onPasteIeFixLinks(html);\r\n\r\n\t\t\t\t\t\t// shapes\r\n\t\t\t\t\t\thtml = html.replace(/<img(.*?)v:shapes=(.*?)>/gi, '');\r\n\t\t\t\t\t\thtml = html.replace(/src=\"file\\:\\/\\/(.*?)\"/, 'src=\"\"');\r\n\r\n\t\t\t\t\t\t// lists\r\n\t\t\t\t\t\tvar $div = $(\"<div/>\").html(html);\r\n\r\n\t\t\t\t\t\tvar lastList = false;\r\n\t\t\t\t\t\tvar lastLevel = 1;\r\n\t\t\t\t\t\tvar listsIds = [];\r\n\r\n\t\t\t\t\t\t$div.find(\"p[style]\").each(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar matches = $(this).attr('style').match(/mso\\-list\\:l([0-9]+)\\slevel([0-9]+)/);\r\n\r\n\t\t\t\t\t\t\tif (matches)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar currentList = parseInt(matches[1]);\r\n\t\t\t\t\t\t\t\tvar currentLevel = parseInt(matches[2]);\r\n\t\t\t\t\t\t\t\tvar listType = $(this).html().match(/^[\\w]+\\./) ? \"ol\" : \"ul\";\r\n\r\n\t\t\t\t\t\t\t\tvar $li = $(\"<li/>\").html($(this).html());\r\n\r\n\t\t\t\t\t\t\t\t$li.html($li.html().replace(/^([\\w\\.]+)</, '<'));\r\n\t\t\t\t\t\t\t\t$li.find(\"span:first\").remove();\r\n\r\n\t\t\t\t\t\t\t\tif (currentLevel == 1 && $.inArray(currentList, listsIds) == -1)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar $list = $(\"<\" + listType + \"/>\").attr({\"data-level\": currentLevel,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   \"data-list\": currentList})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  .html($li);\r\n\r\n\t\t\t\t\t\t\t\t\t$(this).replaceWith($list);\r\n\r\n\t\t\t\t\t\t\t\t\tlastList = currentList;\r\n\t\t\t\t\t\t\t\t\tlistsIds.push(currentList);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif (currentLevel > lastLevel)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tvar $prevList = $div.find('[data-level=\"' + lastLevel + '\"][data-list=\"' + lastList + '\"]');\r\n\r\n\t\t\t\t\t\t\t\t\t\tvar $lastList = $prevList;\r\n\r\n\t\t\t\t\t\t\t\t\t\tfor(var i = lastLevel; i < currentLevel; i++)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$list = $(\"<\" + listType + \"/>\");\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$list.appendTo($lastList.find(\"li\").last());\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$lastList = $list;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t$lastList.attr({\"data-level\": currentLevel,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"data-list\": currentList})\r\n\t\t\t\t\t\t\t\t\t\t\t\t .html($li);\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tvar $prevList = $div.find('[data-level=\"' + currentLevel + '\"][data-list=\"' + currentList + '\"]').last();\r\n\r\n\t\t\t\t\t\t\t\t\t\t$prevList.append($li);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tlastLevel = currentLevel;\r\n\t\t\t\t\t\t\t\t\tlastList = currentList;\r\n\r\n\t\t\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$div.find('[data-level][data-list]').removeAttr('data-level data-list');\r\n\t\t\t\t\t\thtml = $div.html();\r\n\r\n\t\t\t\t\t\t// remove ms word's bullet\r\n\t\t\t\t\t\thtml = html.replace(/·/g, '');\r\n\t\t\t\t\t\thtml = html.replace(/<p class=\"Mso(.*?)\"/gi, '<p');\r\n\r\n\t\t\t\t\t\t// classes\r\n\t\t\t\t\t\thtml = html.replace(/ class=\\\"(mso[^\\\"]*)\\\"/gi,\t\"\");\r\n\t\t\t\t\t\thtml = html.replace(/ class=(mso\\w+)/gi, \"\");\r\n\r\n\t\t\t\t\t\t// remove ms word tags\r\n\t\t\t\t\t\thtml = html.replace(/<o:p(.*?)>([\\w\\W]*?)<\\/o:p>/gi, '$2');\r\n\r\n\t\t\t\t\t\t// ms word break lines\r\n\t\t\t\t\t\thtml = html.replace(/\\n/g, ' ');\r\n\r\n\t\t\t\t\t\t// ms word lists break lines\r\n\t\t\t\t\t\thtml = html.replace(/<p>\\n?<li>/gi, '<li>');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tonPasteExtra: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\t// remove google docs markers\r\n\t\t\t\t\thtml = html.replace(/<b\\sid=\"internal-source-marker(.*?)\">([\\w\\W]*?)<\\/b>/gi, \"$2\");\r\n\t\t\t\t\thtml = html.replace(/<b(.*?)id=\"docs-internal-guid(.*?)\">([\\w\\W]*?)<\\/b>/gi, \"$3\");\r\n\r\n\t\t\t\t\t// google docs styles\r\n\t\t\t \t\thtml = html.replace(/<span[^>]*(font-style: italic; font-weight: bold|font-weight: bold; font-style: italic)[^>]*>/gi, '<span style=\"font-weight: bold;\"><span style=\"font-style: italic;\">');\r\n\t\t\t \t\thtml = html.replace(/<span[^>]*font-style: italic[^>]*>/gi, '<span style=\"font-style: italic;\">');\r\n\t\t\t\t\thtml = html.replace(/<span[^>]*font-weight: bold[^>]*>/gi, '<span style=\"font-weight: bold;\">');\r\n\t\t\t\t\thtml = html.replace(/<span[^>]*text-decoration: underline[^>]*>/gi, '<span style=\"text-decoration: underline;\">');\r\n\r\n\t\t\t\t\thtml = html.replace(/<img>/gi, '');\r\n\t\t\t\t\thtml = html.replace(/\\n{3,}/gi, '\\n');\r\n\t\t\t\t\thtml = html.replace(/<font(.*?)>([\\w\\W]*?)<\\/font>/gi, '$2');\r\n\r\n\t\t\t\t\t// remove dirty p\r\n\t\t\t\t\thtml = html.replace(/<p><p>/gi, '<p>');\r\n\t\t\t\t\thtml = html.replace(/<\\/p><\\/p>/gi, '</p>');\r\n\t\t\t\t\thtml = html.replace(/<li>(\\s*|\\t*|\\n*)<p>/gi, '<li>');\r\n\t\t\t\t\thtml = html.replace(/<\\/p>(\\s*|\\t*|\\n*)<\\/li>/gi, '</li>');\r\n\r\n\t\t\t\t\t// remove space between paragraphs\r\n\t\t\t\t\thtml = html.replace(/<\\/p>\\s<p/gi, '<\\/p><p');\r\n\r\n\t\t\t\t\t// remove safari local images\r\n\t\t\t\t\thtml = html.replace(/<img src=\"webkit-fake-url\\:\\/\\/(.*?)\"(.*?)>/gi, '');\r\n\r\n\t\t\t\t\t// bullets\r\n\t\t\t\t\thtml = html.replace(/<p>•([\\w\\W]*?)<\\/p>/gi, '<li>$1</li>');\r\n\r\n\t\t\t\t\t// FF fix\r\n\t\t\t\t\tif (this.utils.browser('mozilla'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/<br\\s?\\/?>$/gi, '');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tonPasteTidy: function(html, type)\r\n\t\t\t\t{\r\n\t\t\t\t\t// remove all tags except these\r\n\t\t\t\t\tvar tags = ['span', 'a', 'pre', 'blockquote', 'small', 'em', 'strong', 'code', 'kbd', 'mark', 'address', 'cite', 'var', 'samp', 'dfn', 'sup', 'sub', 'b', 'i', 'u', 'del',\r\n\t\t\t\t\t\t\t\t'ol', 'ul', 'li', 'dl', 'dt', 'dd', 'p', 'br', 'video', 'audio', 'iframe', 'embed', 'param', 'object', 'img', 'table',\r\n\t\t\t\t\t\t\t\t'td', 'th', 'tr', 'tbody', 'tfoot', 'thead', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\r\n\t\t\t\t\tvar tagsEmpty = false;\r\n\t\t\t\t\tvar attrAllowed =  [\r\n\t\t\t\t\t\t\t['a', '*'],\r\n\t\t\t\t\t\t\t['img', ['src', 'alt']],\r\n\t\t\t\t\t\t\t['span', ['class', 'rel', 'data-verified']],\r\n\t\t\t\t\t\t\t['iframe', '*'],\r\n\t\t\t\t\t\t\t['video', '*'],\r\n\t\t\t\t\t\t\t['audio', '*'],\r\n\t\t\t\t\t\t\t['embed', '*'],\r\n\t\t\t\t\t\t\t['object', '*'],\r\n\t\t\t\t\t\t\t['param', '*'],\r\n\t\t\t\t\t\t\t['source', '*']\r\n\t\t\t\t\t\t];\r\n\r\n\t\t\t\t\tif (type == 'all')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttagsEmpty = ['p', 'span', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\r\n\t\t\t\t\t\tattrAllowed =  [\r\n\t\t\t\t\t\t\t['table', 'class'],\r\n\t\t\t\t\t\t\t['td', ['colspan', 'rowspan']],\r\n\t\t\t\t\t\t\t['a', '*'],\r\n\t\t\t\t\t\t\t['img', ['src', 'alt', 'data-redactor-inserted-image']],\r\n\t\t\t\t\t\t\t['span', ['class', 'rel', 'data-verified']],\r\n\t\t\t\t\t\t\t['iframe', '*'],\r\n\t\t\t\t\t\t\t['video', '*'],\r\n\t\t\t\t\t\t\t['audio', '*'],\r\n\t\t\t\t\t\t\t['embed', '*'],\r\n\t\t\t\t\t\t\t['object', '*'],\r\n\t\t\t\t\t\t\t['param', '*'],\r\n\t\t\t\t\t\t\t['source', '*']\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (type == 'td')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// remove all tags except these and remove all table tags: tr, td etc\r\n\t\t\t\t\t\ttags = ['ul', 'ol', 'li', 'span', 'a', 'small', 'em', 'strong', 'code', 'kbd', 'mark', 'cite', 'var', 'samp', 'dfn', 'sup', 'sub', 'b', 'i', 'u', 'del',\r\n\t\t\t\t\t\t\t\t'ol', 'ul', 'li', 'dl', 'dt', 'dd', 'br', 'iframe', 'video', 'audio', 'embed', 'param', 'object', 'img', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (type == 'li')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// only inline tags and ul, ol, li\r\n\t\t\t\t\t\ttags = ['ul', 'ol', 'li', 'span', 'a', 'small', 'em', 'strong', 'code', 'kbd', 'mark', 'cite', 'var', 'samp', 'dfn', 'sup', 'sub', 'b', 'i', 'u', 'del', 'br',\r\n\t\t\t\t\t\t\t\t'iframe', 'video', 'audio', 'embed', 'param', 'object', 'img'];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar options = {\r\n\t\t\t\t\t\tdeniedTags: (this.opts.deniedTags) ? this.opts.deniedTags : false,\r\n\t\t\t\t\t\tallowedTags: (this.opts.allowedTags) ? this.opts.allowedTags : tags,\r\n\t\t\t\t\t\tremoveComments: true,\r\n\t\t\t\t\t\tremovePhp: true,\r\n\t\t\t\t\t\tremoveAttr: (this.opts.removeAttr) ? this.opts.removeAttr : false,\r\n\t\t\t\t\t\tallowedAttr: (this.opts.allowedAttr) ? this.opts.allowedAttr : attrAllowed,\r\n\t\t\t\t\t\tremoveEmpty: tagsEmpty\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\treturn this.tidy.load(html, options);\r\n\t\t\t\t},\r\n\t\t\t\tonPasteRemoveEmpty: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/<(p|h[1-6])>(|\\s|\\n|\\t|<br\\s?\\/?>)<\\/(p|h[1-6])>/gi, '');\r\n\r\n\t\t\t\t\t// remove br in the end\r\n\t\t\t\t\tif (!this.opts.linebreaks) html = html.replace(/<br>$/i, '');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tonPasteRemoveSpans: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/<span>(.*?)<\\/span>/gi, '$1');\r\n\t\t\t\t\thtml = html.replace(/<span[^>]*>\\s|&nbsp;<\\/span>/gi, ' ');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tonPasteIeFixLinks: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.utils.browser('msie')) return html;\r\n\r\n\t\t\t\t\tvar tmp = $.trim(html);\r\n\t\t\t\t\tif (tmp.search(/^<a(.*?)>(.*?)<\\/a>$/i) === 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/^<a(.*?)>(.*?)<\\/a>$/i, \"$2\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tisSingleLine: function(html, setMode)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.clean.singleLine = false;\r\n\r\n\t\t\t\t\tif (!this.utils.isSelectAll() && typeof setMode == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar blocks = this.opts.blockLevelElements.join('|').replace('P|', '').replace('DIV|', '');\r\n\r\n\t\t\t\t\t\tvar matchBlocks = html.match(new RegExp('</(' + blocks + ')>', 'gi'));\r\n\t\t\t\t\t\tvar matchContainers = html.match(/<\\/(p|div)>/gi);\r\n\r\n\t\t\t\t\t\tif (!matchBlocks && (matchContainers === null || (matchContainers && matchContainers.length <= 1)))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar matchBR = html.match(/<br\\s?\\/?>/gi);\r\n\t\t\t\t\t\t\t//var matchIMG = html.match(/<img(.*?[^>])>/gi);\r\n\t\t\t\t\t\t\tif (!matchBR)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthis.clean.singleLine = true;\r\n\t\t\t\t\t\t\t\thtml = html.replace(/<\\/?(p|div)(.*?)>/gi, '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tstripTags: function(input, allowed)\r\n\t\t\t\t{\r\n\t\t\t\t    allowed = (((allowed || '') + '').toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');\r\n\t\t\t\t    var tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi;\r\n\r\n\t\t\t\t    return input.replace(tags, function ($0, $1) {\r\n\t\t\t\t        return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';\r\n\t\t\t\t    });\r\n\t\t\t\t},\r\n\t\t\t\tsavePreCode: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = this.clean.savePreFormatting(html);\r\n\t\t\t\t\thtml = this.clean.saveCodeFormatting(html);\r\n\r\n\t\t\t\t\thtml = this.clean.restoreSelectionMarker(html);\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tsavePreFormatting: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar pre = html.match(/<pre(.*?)>([\\w\\W]*?)<\\/pre>/gi);\r\n\r\n\t\t\t\t\tif (pre !== null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$.each(pre, $.proxy(function(i,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar arr = s.match(/<pre(.*?)>([\\w\\W]*?)<\\/pre>/i);\r\n\r\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/<br\\s?\\/?>/g, '\\n');\r\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/&nbsp;/g, ' ');\r\n\r\n\t\t\t\t\t\t\tif (this.opts.preSpaces)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tarr[2] = arr[2].replace(/\\t/g, Array(this.opts.preSpaces + 1).join(' '));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tarr[2] = this.clean.encodeEntities(arr[2]);\r\n\r\n\t\t\t\t\t\t\t// $ fix\r\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/\\$/g, '&#36;');\r\n\r\n\t\t\t\t\t\t\thtml = html.replace(s, '<pre' + arr[1] + '>' + arr[2] + '</pre>');\r\n\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tsaveCodeFormatting: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar code = html.match(/<code(.*?)>([\\w\\W]*?)<\\/code>/gi);\r\n\r\n\t\t\t\t\tif (code !== null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$.each(code, $.proxy(function(i,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar arr = s.match(/<code(.*?)>([\\w\\W]*?)<\\/code>/i);\r\n\r\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/&nbsp;/g, ' ');\r\n\t\t\t\t\t\t\tarr[2] = this.clean.encodeEntities(arr[2]);\r\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/\\$/g, '&#36;');\r\n\r\n\t\t\t\t\t\t\thtml = html.replace(s, '<code' + arr[1] + '>' + arr[2] + '</code>');\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\trestoreSelectionMarker: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/&lt;span id=&quot;selection-marker-([0-9])&quot; class=&quot;redactor-selection-marker&quot; data-verified=&quot;redactor&quot;&gt;​&lt;\\/span&gt;/g, '<span id=\"selection-marker-$1\" class=\"redactor-selection-marker\" data-verified=\"redactor\">​</span>');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tgetTextFromHtml: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/<br\\s?\\/?>|<\\/H[1-6]>|<\\/p>|<\\/div>|<\\/li>|<\\/td>/gi, '\\n');\r\n\r\n\t\t\t\t\tvar tmp = document.createElement('div');\r\n\t\t\t\t\ttmp.innerHTML = html;\r\n\t\t\t\t\thtml = tmp.textContent || tmp.innerText;\r\n\r\n\t\t\t\t\treturn $.trim(html);\r\n\t\t\t\t},\r\n\t\t\t\tgetPlainText: function(html, paragraphize)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = this.clean.getTextFromHtml(html);\r\n\t\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, \"\\n\");\r\n\t\t\t\t\thtml = html.replace(/\\n\\n/g, \"\\n\");\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />');\r\n\r\n\t\t\t\t\tif (this.opts.paragraphize && typeof paragraphize == 'undefined' && !this.utils.browser('mozilla'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = this.paragraphize.load(html);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tgetPreCode: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/<img(.*?) style=\"(.*?)\"(.*?[^>])>/gi, '<img$1$3>');\r\n\t\t\t\t\thtml = html.replace(/<img(.*?)>/gi, '&lt;img$1&gt;');\r\n\t\t\t\t\thtml = this.clean.getTextFromHtml(html);\r\n\r\n\t\t\t\t\tif (this.opts.preSpaces)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/\\t/g, Array(this.opts.preSpaces + 1).join(' '));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thtml = this.clean.encodeEntities(html);\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tgetOnlyImages: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/<img(.*?)>/gi, '[img$1]');\r\n\r\n\t\t\t\t\t// remove all tags\r\n\t\t\t\t\thtml = html.replace(/<([Ss]*?)>/gi, '');\r\n\r\n\t\t\t\t\thtml = html.replace(/\\[img(.*?)\\]/gi, '<img$1>');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tgetOnlyLinksAndImages: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/<a(.*?)href=\"(.*?)\"(.*?)>([\\w\\W]*?)<\\/a>/gi, '[a href=\"$2\"]$4[/a]');\r\n\t\t\t\t\thtml = html.replace(/<img(.*?)>/gi, '[img$1]');\r\n\r\n\t\t\t\t\t// remove all tags\r\n\t\t\t\t\thtml = html.replace(/<(.*?)>/gi, '');\r\n\r\n\t\t\t\t\thtml = html.replace(/\\[a href=\"(.*?)\"\\]([\\w\\W]*?)\\[\\/a\\]/gi, '<a href=\"$1\">$2</a>');\r\n\t\t\t\t\thtml = html.replace(/\\[img(.*?)\\]/gi, '<img$1>');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tencodeEntities: function(str)\r\n\t\t\t\t{\r\n\t\t\t\t\tstr = String(str).replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"');\r\n\t\t\t\t\treturn str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n\t\t\t\t},\r\n\t\t\t\tremoveDirtyStyles: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.utils.browser('msie')) return html;\r\n\r\n\t\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\t\tdiv.innerHTML = html;\r\n\r\n\t\t\t\t\tthis.clean.clearUnverifiedRemove($(div));\r\n\r\n\t\t\t\t\thtml = div.innerHTML;\r\n\t\t\t\t\t$(div).remove();\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tclearUnverified: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.utils.browser('msie')) return;\r\n\r\n\t\t\t\t\tthis.clean.clearUnverifiedRemove(this.$editor);\r\n\r\n\t\t\t\t\tvar headers = this.$editor.find('h1, h2, h3, h4, h5, h6');\r\n\t\t\t\t\theaders.find('span').removeAttr('style');\r\n\t\t\t\t\theaders.find(this.opts.verifiedTags.join(', ')).removeAttr('style');\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tclearUnverifiedRemove: function($editor)\r\n\t\t\t\t{\r\n\t\t\t\t\t$editor.find(this.opts.verifiedTags.join(', ')).removeAttr('style');\r\n\t\t\t\t\t$editor.find('span').not('[data-verified=\"redactor\"]').removeAttr('style');\r\n\r\n\t\t\t\t\t$editor.find('span[data-verified=\"redactor\"], img[data-verified=\"redactor\"]').each(function(i, s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $s = $(s);\r\n\t\t\t\t\t\t$s.attr('style', $s.attr('rel'));\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t},\r\n\t\t\t\tcleanEmptyParagraph: function()\r\n\t\t\t\t{\r\n\r\n\t\t\t\t},\r\n\t\t\t\tsetVerified: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.utils.browser('msie')) return html;\r\n\r\n\t\t\t\t\thtml = html.replace(new RegExp('<img(.*?[^>])>', 'gi'), '<img$1 data-verified=\"redactor\">');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<span(.*?[^>])>', 'gi'), '<span$1 data-verified=\"redactor\">');\r\n\r\n\t\t\t\t\tvar matches = html.match(new RegExp('<(span|img)(.*?)style=\"(.*?)\"(.*?[^>])>', 'gi'));\r\n\r\n\t\t\t\t\tif (matches)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar len = matches.length;\r\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttry {\r\n\r\n\t\t\t\t\t\t\t\tvar newTag = matches[i].replace(/style=\"(.*?)\"/i, 'style=\"$1\" rel=\"$1\"');\r\n\t\t\t\t\t\t\t\thtml = html.replace(matches[i], newTag);\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcatch (e) {}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tconvertInline: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $div = $('<div />').html(html);\r\n\r\n\t\t\t\t\tvar tags = this.opts.inlineTags;\r\n\t\t\t\t\ttags.push('span');\r\n\r\n\t\t\t\t\t$div.find(tags.join(',')).each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $el = $(this);\r\n\t\t\t\t\t\tvar tag = this.tagName.toLowerCase();\r\n\t\t\t\t\t\t$el.attr('data-redactor-tag', tag);\r\n\r\n\t\t\t\t\t\tif (tag == 'span')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif ($el.attr('style')) $el.attr('data-redactor-style', $el.attr('style'));\r\n\t\t\t\t\t\t\telse if ($el.attr('class')) $el.attr('data-redactor-class', $el.attr('class'));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\thtml = $div.html();\r\n\t\t\t\t\t$div.remove();\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tnormalizeLists: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor.find('li').each(function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $next = $(s).next();\r\n\t\t\t\t\t\tif ($next.length !== 0 && ($next[0].tagName == 'UL' || $next[0].tagName == 'OL'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(s).append($next);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tremoveSpaces: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '');\r\n\t\t\t\t\thtml = html.replace(/[\\t]*/g, '');\r\n\t\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, \"\\n\");\r\n\t\t\t\t\thtml = html.replace(/^[\\s\\n]*/g, ' ');\r\n\t\t\t\t\thtml = html.replace(/[\\s\\n]*$/g, ' ');\r\n\t\t\t\t\thtml = html.replace( />\\s{2,}</g, '> <'); // between inline tags can be only one space\r\n\t\t\t\t\thtml = html.replace(/\\n\\n/g, \"\\n\");\r\n\t\t\t\t\thtml = html.replace(/\\u200B/g, '');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\treplaceDivs: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/<div><br\\s?\\/?><\\/div>/gi, '<br />');\r\n\t\t\t\t\t\thtml = html.replace(/<div(.*?)>([\\w\\W]*?)<\\/div>/gi, '$2<br />');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/<div(.*?)>([\\w\\W]*?)<\\/div>/gi, '<p$1>$2</p>');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thtml = html.replace(/<div(.*?[^>])>/gi, '');\r\n\t\t\t\t\thtml = html.replace(/<\\/div>/gi, '');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\treplaceDivsToBr: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/<div\\s(.*?)>/gi, '<p>');\r\n\t\t\t\t\thtml = html.replace(/<div><br\\s?\\/?><\\/div>/gi, '<br /><br />');\r\n\t\t\t\t\thtml = html.replace(/<div>([\\w\\W]*?)<\\/div>/gi, '$1<br /><br />');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\treplaceParagraphsToBr: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/<p\\s(.*?)>/gi, '<p>');\r\n\t\t\t\t\thtml = html.replace(/<p><br\\s?\\/?><\\/p>/gi, '<br />');\r\n\t\t\t\t\thtml = html.replace(/<p>([\\w\\W]*?)<\\/p>/gi, '$1<br /><br />');\r\n\t\t\t\t\thtml = html.replace(/(<br\\s?\\/?>){1,}\\n?<\\/blockquote>/gi, '</blockquote>');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tsaveFormTags: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn html.replace(/<form(.*?)>([\\w\\W]*?)<\\/form>/gi, '<section$1 rel=\"redactor-form-tag\">$2</section>');\r\n\t\t\t\t},\r\n\t\t\t\trestoreFormTags: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn html.replace(/<section(.*?) rel=\"redactor-form-tag\"(.*?)>([\\w\\W]*?)<\\/section>/gi, '<form$1$2>$3</form>');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tcode: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tset: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = $.trim(html.toString());\r\n\r\n\t\t\t\t\t// clean\r\n\t\t\t\t\thtml = this.clean.onSet(html);\r\n\r\n\r\n\t\t\t\t\tif (this.utils.browser('msie'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/<span(.*?)id=\"selection-marker-(1|2)\"(.*?)><\\/span>/gi, '');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$editor.html(html);\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t\tif (html !== '') this.placeholder.remove();\r\n\r\n\t\t\t\t\tsetTimeout($.proxy(this.buffer.add, this), 15);\r\n\t\t\t\t\tif (this.start === false) this.observe.load();\r\n\r\n\t\t\t\t},\r\n\t\t\t\tget: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar code = this.$textarea.val();\r\n\r\n\t\t\t\t\tif (this.opts.replaceDivs) code = this.clean.replaceDivs(code);\r\n\t\t\t\t\tif (this.opts.linebreaks) code = this.clean.replaceParagraphsToBr(code);\r\n\r\n\t\t\t\t\t// indent code\r\n\t\t\t\t\tcode = this.tabifier.get(code);\r\n\r\n\t\t\t\t\treturn code;\r\n\t\t\t\t},\r\n\t\t\t\tsync: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tsetTimeout($.proxy(this.code.startSync, this), 10);\r\n\t\t\t\t},\r\n\t\t\t\tstartSync: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar html = this.$editor.html();\r\n\r\n\t\t\t\t\t// is there a need to synchronize\r\n\t\t\t\t\tif (this.code.syncCode && this.code.syncCode == html || (this.start && html == '' ))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// do not sync\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// save code\r\n\t\t\t\t\tthis.code.syncCode = html;\r\n\r\n\t\t\t\t\t// before clean callback\r\n\t\t\t\t\thtml = this.core.setCallback('syncBefore', html);\r\n\r\n\t\t\t\t\t// clean\r\n\t\t\t\t\thtml = this.clean.onSync(html);\r\n\r\n\t\t\t\t\t// set code\r\n\t\t\t\t\tthis.$textarea.val(html);\r\n\r\n\t\t\t\t\t// after sync callback\r\n\t\t\t\t\tthis.core.setCallback('sync', html);\r\n\r\n\t\t\t\t\tif (this.start === false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.core.setCallback('change', html);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.start = false;\r\n\r\n\t\t\t\t\tif (this.autosave.html == false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.autosave.html = this.code.get();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.opts.codemirror)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$textarea.next('.CodeMirror').each(function(i, el)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tel.CodeMirror.setValue(html);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//autosave\r\n\t\t\t\t\tthis.autosave.onChange();\r\n\t\t\t\t\tthis.autosave.enable();\r\n\t\t\t\t},\r\n\t\t\t\ttoggle: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.visual)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.code.showCode();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.code.showVisual();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tshowCode: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tthis.code.offset = this.caret.getOffset();\r\n\t\t\t\t\tvar scroll = $(window).scrollTop();\r\n\r\n\t\t\t\t\tvar\twidth = this.$editor.innerWidth(),\r\n\t\t\t\t\t\theight = this.$editor.innerHeight();\r\n\r\n\t\t\t\t\tthis.$editor.hide();\r\n\r\n\t\t\t\t\tvar html = this.$textarea.val();\r\n\r\n\t\t\t\t\tthis.modified = this.clean.removeSpaces(html);\r\n\r\n\t\t\t\t\t// indent code\r\n\t\t\t\t\thtml = this.tabifier.get(html);\r\n\r\n\t\t\t\t\t// caret position sync\r\n\t\t\t\t\tvar start = 0, end = 0;\r\n\t\t\t\t\tvar $editorDiv = $(\"<div/>\").append($.parseHTML(this.clean.onSync(this.$editor.html()), document, true));\r\n\t\t\t\t\tvar $selectionMarkers = $editorDiv.find(\"span.redactor-selection-marker\");\r\n\r\n\t\t\t\t\tif ($selectionMarkers.length > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar editorHtml = this.tabifier.get($editorDiv.html()).replace(/&amp;/g, '&');\r\n\r\n\t\t\t\t\t\tif ($selectionMarkers.length == 1)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tstart = this.utils.strpos(editorHtml, $editorDiv.find(\"#selection-marker-1\").prop(\"outerHTML\"));\r\n\t\t\t\t\t\t\tend   = start;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if ($selectionMarkers.length == 2)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tstart = this.utils.strpos(editorHtml, $editorDiv.find(\"#selection-marker-1\").prop(\"outerHTML\"));\r\n\t\t\t\t\t\t\tend\t = this.utils.strpos(editorHtml, $editorDiv.find(\"#selection-marker-2\").prop(\"outerHTML\")) - $editorDiv.find(\"#selection-marker-1\").prop(\"outerHTML\").toString().length;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.removeMarkers();\r\n\t\t\t\t\tthis.$textarea.val(html);\r\n\r\n\t\t\t\t\tif (this.opts.codemirror)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$textarea.next('.CodeMirror').each(function(i, el)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(el).show();\r\n\t\t\t\t\t\t\tel.CodeMirror.setValue(html);\r\n\t\t\t\t\t\t\tel.CodeMirror.setSize('100%', height);\r\n\t\t\t\t\t\t\tel.CodeMirror.refresh();\r\n\r\n\t\t\t\t\t\t\tif (start == end)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tel.CodeMirror.setCursor(el.CodeMirror.posFromIndex(start).line, el.CodeMirror.posFromIndex(end).ch);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tel.CodeMirror.setSelection({line: el.CodeMirror.posFromIndex(start).line,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tch: el.CodeMirror.posFromIndex(start).ch},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  {line: el.CodeMirror.posFromIndex(end).line,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   ch:  el.CodeMirror.posFromIndex(end).ch});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tel.CodeMirror.focus();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$textarea.height(height).show().focus();\r\n\t\t\t\t\t\tthis.$textarea.on('keydown.redactor-textarea-indenting', this.code.textareaIndenting);\r\n\r\n\t\t\t\t\t\t$(window).scrollTop(scroll);\r\n\r\n\t\t\t\t\t\tif (this.$textarea[0].setSelectionRange)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.$textarea[0].setSelectionRange(start, end);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.$textarea[0].scrollTop = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.opts.visual = false;\r\n\r\n\t\t\t\t\tthis.button.setInactiveInCode();\r\n\t\t\t\t\tthis.button.setActive('html');\r\n\t\t\t\t\tthis.core.setCallback('source', html);\r\n\t\t\t\t},\r\n\t\t\t\tshowVisual: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar html;\r\n\r\n\t\t\t\t\tif (this.opts.visual) return;\r\n\r\n\t\t\t\t\tvar start = 0, end = 0;\r\n\r\n\t\t\t\t\tif (this.opts.codemirror)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar selection;\r\n\r\n\t\t\t\t\t\tthis.$textarea.next('.CodeMirror').each(function(i, el)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tselection = el.CodeMirror.listSelections();\r\n\r\n\t\t\t\t\t\t\tstart = el.CodeMirror.indexFromPos(selection[0].anchor);\r\n\t\t\t\t\t\t\tend = el.CodeMirror.indexFromPos(selection[0].head);\r\n\r\n\t\t\t\t\t\t\thtml = el.CodeMirror.getValue();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstart = this.$textarea.get(0).selectionStart;\r\n\t\t\t\t\t\tend = this.$textarea.get(0).selectionEnd;\r\n\r\n\t\t\t\t\t\thtml = this.$textarea.hide().val();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// if selection starts from end\r\n\t\t\t\t\tif (start > end && end > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar tempStart = end;\r\n\t\t\t\t\t\tvar tempEnd = start;\r\n\r\n\t\t\t\t\t\tstart = tempStart;\r\n\t\t\t\t\t\tend = tempEnd;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstart = this.code.enlargeOffset(html, start);\r\n\t\t\t\t\tend = this.code.enlargeOffset(html, end);\r\n\r\n\t\t\t\t\thtml = html.substr(0, start) + this.selection.getMarkerAsHtml(1) + html.substr(start);\r\n\r\n\t\t\t\t\tif (end > start)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar markerLength = this.selection.getMarkerAsHtml(1).toString().length;\r\n\r\n\t\t\t\t\t\thtml = html.substr(0, end + markerLength) + this.selection.getMarkerAsHtml(2) + html.substr(end + markerLength);\r\n\t\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t\t\tif (this.modified !== this.clean.removeSpaces(html))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.code.set(html);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.opts.codemirror)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$textarea.next('.CodeMirror').hide();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$editor.show();\r\n\r\n\t\t\t\t\tif (!this.utils.isEmpty(html))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.placeholder.remove();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\r\n\t\t\t\t\tthis.$textarea.off('keydown.redactor-textarea-indenting');\r\n\r\n\t\t\t\t\tthis.button.setActiveInVisual();\r\n\t\t\t\t\tthis.button.setInactive('html');\r\n\t\t\t\t\tthis.observe.load();\r\n\t\t\t\t\tthis.opts.visual = true;\r\n\t\t\t\t\tthis.core.setCallback('visual', html);\r\n\t\t\t\t},\r\n\t\t\t\ttextareaIndenting: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (e.keyCode !== 9) return true;\r\n\r\n\t\t\t\t\tvar $el = this.$textarea;\r\n\t\t\t\t\tvar start = $el.get(0).selectionStart;\r\n\t\t\t\t\t$el.val($el.val().substring(0, start) + \"\\t\" + $el.val().substring($el.get(0).selectionEnd));\r\n\t\t\t\t\t$el.get(0).selectionStart = $el.get(0).selectionEnd = start + 1;\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tenlargeOffset: function(html, offset)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar htmlLength = html.length;\r\n\t\t\t\t\tvar c = 0;\r\n\r\n\t\t\t\t\tif (html[offset] == '>')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tc++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfor(var i = offset; i <= htmlLength; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tc++;\r\n\r\n\t\t\t\t\t\t\tif (html[i] == '>')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (html[i] == '<' || i == htmlLength)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tc = 0;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn offset + c;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tcore: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tgetObject: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn $.extend({}, this);\r\n\t\t\t\t},\r\n\t\t\t\tgetEditor: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.$editor;\r\n\t\t\t\t},\r\n\t\t\t\tgetBox: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.$box;\r\n\t\t\t\t},\r\n\t\t\t\tgetElement: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.$element;\r\n\t\t\t\t},\r\n\t\t\t\tgetTextarea: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.$textarea;\r\n\t\t\t\t},\r\n\t\t\t\tgetToolbar: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn (this.$toolbar) ? this.$toolbar : false;\r\n\t\t\t\t},\r\n\t\t\t\taddEvent: function(name)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.core.event = name;\r\n\t\t\t\t},\r\n\t\t\t\tgetEvent: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.core.event;\r\n\t\t\t\t},\r\n\t\t\t\tsetCallback: function(type, e, data)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar eventName = type + 'Callback';\r\n\t\t\t\t\tvar eventNamespace = 'redactor';\r\n\t\t\t\t\tvar callback = this.opts[eventName];\r\n\r\n\t\t\t\t\tif (this.$textarea)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar returnValue = false;\r\n\t\t\t\t\t\tvar events = $._data(this.$textarea[0], 'events');\r\n\r\n\t\t\t\t\t\tif (typeof events != 'undefined' && typeof events[eventName] != 'undefined')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$.each(events[eventName], $.proxy(function(key, value)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif (value['namespace'] == eventNamespace)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar data = (typeof data == 'undefined') ? [e] : [e, data];\r\n\r\n\t\t\t\t\t\t\t\t\treturnValue = (typeof data == 'undefined') ? value.handler.call(this, e) : value.handler.call(this, e, data);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (returnValue) return returnValue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ($.isFunction(callback))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn (typeof data == 'undefined') ? callback.call(this, e) : callback.call(this, e, data);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn (typeof data == 'undefined') ? e : data;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdestroy: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.opts.destroyed = true;\r\n\r\n\t\t\t\t\tthis.core.setCallback('destroy');\r\n\r\n\t\t\t\t\t// off events and remove data\r\n\t\t\t\t\tthis.$element.off('.redactor').removeData('redactor');\r\n\t\t\t\t\tthis.$editor.off('.redactor');\r\n\r\n\t\t\t\t\t$(document).off('mousedown.redactor-blur.' + this.uuid);\r\n\t\t\t\t\t$(document).off('mousedown.redactor.' + this.uuid);\r\n\t\t\t\t\t$(document).off('click.redactor-image-delete.' + this.uuid);\r\n\t\t\t\t\t$(document).off('click.redactor-image-resize-hide.' + this.uuid);\r\n\t\t\t\t\t$(document).off('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid);\r\n\t\t\t\t\t$(\"body\").off('scroll.redactor.' + this.uuid);\r\n\t\t\t\t\t$(this.opts.toolbarFixedTarget).off('scroll.redactor.' + this.uuid);\r\n\r\n\t\t\t\t\t// common\r\n\t\t\t\t\tthis.$editor.removeClass('redactor-editor redactor-linebreaks redactor-placeholder');\r\n\t\t\t\t\tthis.$editor.removeAttr('contenteditable');\r\n\r\n\t\t\t\t\tvar html = this.code.get();\r\n\r\n\t\t\t\t\tif (this.opts.toolbar)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// dropdowns off\r\n\t\t\t\t\t\tthis.$toolbar.find('a').each(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $el = $(this);\r\n\t\t\t\t\t\t\tif ($el.data('dropdown'))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$el.data('dropdown').remove();\r\n\t\t\t\t\t\t\t\t$el.data('dropdown', {});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.build.isTextarea())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$box.after(this.$element);\r\n\t\t\t\t\t\tthis.$box.remove();\r\n\t\t\t\t\t\tthis.$element.val(html).show();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$box.after(this.$editor);\r\n\t\t\t\t\t\tthis.$box.remove();\r\n\t\t\t\t\t\tthis.$element.html(html).show();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// paste box\r\n\t\t\t\t\tif (this.$pasteBox) this.$pasteBox.remove();\r\n\r\n\t\t\t\t\t// modal\r\n\t\t\t\t\tif (this.$modalBox) this.$modalBox.remove();\r\n\t\t\t\t\tif (this.$modalOverlay) this.$modalOverlay.remove();\r\n\r\n\t\t\t\t\t// buttons tooltip\r\n\t\t\t\t\t$('.redactor-toolbar-tooltip-' + this.uuid).remove();\r\n\r\n\t\t\t\t\t// autosave\r\n\t\t\t\t\tclearInterval(this.autosaveInterval);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tdropdown: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tbuild: function(name, $dropdown, dropdownObject)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (name == 'formatting' && this.opts.formattingAdd)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$.each(this.opts.formattingAdd, $.proxy(function(i,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar name = s.tag,\r\n\t\t\t\t\t\t\t\tfunc;\r\n\r\n\t\t\t\t\t\t\tif (typeof s['class'] != 'undefined')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname = name + '-' + s['class'];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\ts.type = (this.utils.isBlockTag(s.tag)) ? 'block' : 'inline';\r\n\r\n\t\t\t\t\t\t\tif (typeof s.func !== \"undefined\")\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tfunc = s.func;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tfunc = (s.type == 'inline') ? 'inline.formatting' : 'block.formatting';\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (this.opts.linebreaks && s.type == 'block' && s.tag == 'p') return;\r\n\r\n\t\t\t\t\t\t\tthis.formatting[name] = {\r\n\t\t\t\t\t\t\t\ttag: s.tag,\r\n\t\t\t\t\t\t\t\tstyle: s.style,\r\n\t\t\t\t\t\t\t\t'class': s['class'],\r\n\t\t\t\t\t\t\t\tattr: s.attr,\r\n\t\t\t\t\t\t\t\tdata: s.data,\r\n\t\t\t\t\t\t\t\tclear: s.clear\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tdropdownObject[name] = {\r\n\t\t\t\t\t\t\t\tfunc: func,\r\n\t\t\t\t\t\t\t\ttitle: s.title\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$.each(dropdownObject, $.proxy(function(btnName, btnObject)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $item = $('<a href=\"#\" class=\"redactor-dropdown-' + btnName + '\" role=\"button\">' + btnObject.title + '</a>');\r\n\t\t\t\t\t\tif (name == 'formatting') $item.addClass('redactor-formatting-' + btnName);\r\n\r\n\t\t\t\t\t\t$item.on('click', $.proxy(function(e)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t\tvar type = 'func';\r\n\t\t\t\t\t\t\tvar callback = btnObject.func;\r\n\t\t\t\t\t\t\tif (btnObject.command)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttype = 'command';\r\n\t\t\t\t\t\t\t\tcallback = btnObject.command;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (btnObject.dropdown)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttype = 'dropdown';\r\n\t\t\t\t\t\t\t\tcallback = btnObject.dropdown;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ($(e.target).hasClass('redactor-dropdown-link-inactive')) return;\r\n\r\n\t\t\t\t\t\t\tthis.button.onClick(e, btnName, type, callback);\r\n\t\t\t\t\t\t\tthis.dropdown.hideAll();\r\n\r\n\t\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t\tthis.observe.addDropdown($item, btnName, btnObject);\r\n\r\n\t\t\t\t\t\t$dropdown.append($item);\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tshow: function(e, key)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.visual)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar $button = this.button.get(key);\r\n\r\n\t\t\t\t\t// Always re-append it to the end of <body> so it always has the highest sub-z-index.\r\n\t\t\t\t\tvar $dropdown = $button.data('dropdown').appendTo(document.body);\r\n\r\n\t\t\t\t\tif (this.opts.highContrast)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$dropdown.addClass(\"redactor-dropdown-contrast\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ($button.hasClass('dropact'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.dropdown.hideAll();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.dropdown.hideAll();\r\n\t\t\t\t\t\tthis.observe.dropdowns();\r\n\r\n\t\t\t\t\t\tthis.core.setCallback('dropdownShow', { dropdown: $dropdown, key: key, button: $button });\r\n\r\n\t\t\t\t\t\tthis.button.setActive(key);\r\n\r\n\t\t\t\t\t\t$button.addClass('dropact');\r\n\r\n\t\t\t\t\t\tvar keyPosition = $button.offset();\r\n\r\n\t\t\t\t\t\t// fix right placement\r\n\t\t\t\t\t\tvar dropdownWidth = $dropdown.width();\r\n\t\t\t\t\t\tif ((keyPosition.left + dropdownWidth) > $(document).width())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tkeyPosition.left = Math.max(0, keyPosition.left - dropdownWidth);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar left = keyPosition.left + 'px';\r\n\t\t\t\t\t\tif (this.$toolbar.hasClass('toolbar-fixed-box'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar top = this.$toolbar.innerHeight() + this.opts.toolbarFixedTopOffset;\r\n\t\t\t\t\t\t\tvar position = 'fixed';\r\n\t\t\t\t\t\t\tif (this.opts.toolbarFixedTarget !== document)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttop = (this.$toolbar.innerHeight() + this.$toolbar.offset().top) + this.opts.toolbarFixedTopOffset;\r\n\t\t\t\t\t\t\t\tposition = 'absolute';\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$dropdown.css({ position: position, left: left, top: top + 'px' }).show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar top = ($button.innerHeight() + keyPosition.top) + 'px';\r\n\r\n\t\t\t\t\t\t\t$dropdown.css({ position: 'absolute', left: left, top: top }).show();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.core.setCallback('dropdownShown', { dropdown: $dropdown, key: key, button: $button });\r\n\r\n\t\t\t\t\t\tthis.$dropdown = $dropdown;\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t$(document).one('click.redactor-dropdown', $.proxy(this.dropdown.hide, this));\r\n\t\t\t\t\tthis.$editor.one('click.redactor-dropdown', $.proxy(this.dropdown.hide, this));\r\n\t\t\t\t\t$(document).one('keyup.redactor-dropdown', $.proxy(this.dropdown.closeHandler, this));\r\n\r\n\t\t\t\t\t// disable scroll whan dropdown scroll\r\n\t\t\t\t\t$dropdown.on('mouseover.redactor-dropdown', $.proxy(this.utils.disableBodyScroll, this)).on('mouseout.redactor-dropdown', $.proxy(this.utils.enableBodyScroll, this));\r\n\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t},\r\n\t\t\t\tcloseHandler: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (e.which != this.keyCode.ESC) return;\r\n\r\n\t\t\t\t\tthis.dropdown.hideAll();\r\n\t\t\t\t\tthis.$editor.focus();\r\n\t\t\t\t},\r\n\t\t\t\thideAll: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$toolbar.find('a.dropact').removeClass('redactor-act').removeClass('dropact');\r\n\r\n\t\t\t\t\tthis.utils.enableBodyScroll();\r\n\r\n\t\t\t\t\t$('.redactor-dropdown-' + this.uuid).hide();\r\n\t\t\t\t\t$('.redactor-dropdown-link-selected').removeClass('redactor-dropdown-link-selected');\r\n\r\n\r\n\t\t\t\t\tif (this.$dropdown)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$dropdown.off('.redactor-dropdown');\r\n\t\t\t\t\t\tthis.core.setCallback('dropdownHide', this.$dropdown);\r\n\r\n\t\t\t\t\t\tthis.$dropdown = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\thide: function (e)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $dropdown = $(e.target);\r\n\r\n\t\t\t\t\tif (!$dropdown.hasClass('dropact') && !$dropdown.hasClass('redactor-dropdown-link-inactive'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($dropdown.hasClass('redactor-dropdown'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$dropdown.removeClass('dropact');\r\n\t\t\t\t\t\t\t$dropdown.off('mouseover mouseout');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.dropdown.hideAll();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tfile: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tshow: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.modal.load('file', this.lang.get('file'), 700);\r\n\t\t\t\t\tthis.upload.init('#redactor-modal-file-upload', this.opts.fileUpload, this.file.insert);\r\n\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\tvar text = this.sel.toString();\r\n\r\n\t\t\t\t\t$('#redactor-filename').val(text);\r\n\r\n\t\t\t\t\tthis.modal.show();\r\n\t\t\t\t},\r\n\t\t\t\tinsert: function(json, direct, e)\r\n\t\t\t\t{\r\n\t\t\t\t\t// error callback\r\n\t\t\t\t\tif (typeof json.error != 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.close();\r\n\t\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\t\tthis.core.setCallback('fileUploadError', json);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar link;\r\n\t\t\t\t\tif (typeof json == 'string')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlink = json;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar text = $('#redactor-filename').val();\r\n\t\t\t\t\t\tif (typeof text == 'undefined' || text === '') text = json.filename;\r\n\r\n\t\t\t\t\t\tlink = '<a href=\"' + json.filelink + '\" id=\"filelink-marker\">' + text + '</a>';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (direct)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.selection.removeMarkers();\r\n\t\t\t\t\t\tvar marker = this.selection.getMarker();\r\n\t\t\t\t\t\tthis.insert.nodeToCaretPositionFromPoint(e, marker);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.close();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tthis.insert.htmlWithoutClean(link);\r\n\r\n\t\t\t\t\tif (typeof json == 'string') return;\r\n\r\n\t\t\t\t\tvar linkmarker = $(this.$editor.find('a#filelink-marker'));\r\n\t\t\t\t\tif (linkmarker.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlinkmarker.removeAttr('id').removeAttr('style');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse linkmarker = false;\r\n\r\n\t\t\t\t\tthis.core.setCallback('fileUpload', linkmarker, json);\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tfocus: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tsetStart: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor.focus();\r\n\r\n\t\t\t\t\tvar first = this.$editor.children().first();\r\n\r\n\t\t\t\t\tif (first.length === 0) return;\r\n\t\t\t\t\tif (first[0].length === 0 || first[0].tagName == 'BR' || first[0].nodeType == 3)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (first[0].tagName == 'UL' || first[0].tagName == 'OL')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar child = first.find('li').first();\r\n\t\t\t\t\t\tif (!this.utils.isBlock(child) && child.text() === '')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// empty inline tag in li\r\n\t\t\t\t\t\t\tthis.caret.setStart(child);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.opts.linebreaks && !this.utils.isBlockTag(first[0].tagName))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\t\tthis.range.setStart(this.$editor[0], 0);\r\n\t\t\t\t\t\tthis.range.setEnd(this.$editor[0], 0);\r\n\t\t\t\t\t\tthis.selection.addRange();\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// if node is tag\r\n\t\t\t\t\tthis.caret.setStart(first);\r\n\t\t\t\t},\r\n\t\t\t\tsetEnd: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar last = this.$editor.children().last();\r\n\t\t\t\t\tthis.$editor.focus();\r\n\r\n\t\t\t\t\tif (last.size() === 0) return;\r\n\t\t\t\t\tif (this.utils.isEmpty(this.$editor.html()))\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\t\tthis.range.collapse(true);\r\n\t\t\t\t\t\tthis.range.setStartAfter(last[0]);\r\n\t\t\t\t\t\tthis.range.setEnd(last[0], 0);\r\n\t\t\t\t\t\tthis.selection.addRange();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\t\tthis.range.selectNodeContents(last[0]);\r\n\t\t\t\t\t\tthis.range.collapse(false);\r\n\t\t\t\t\t\tthis.selection.addRange();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tisFocused: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.$editor[0] === document.activeElement;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\timage: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tshow: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.modal.load('image', this.lang.get('image'), 700);\r\n\t\t\t\t\tthis.upload.init('#redactor-modal-image-droparea', this.opts.imageUpload, this.image.insert);\r\n\r\n\t\t\t\t\tthis.selection.save();\r\n\t\t\t\t\tthis.modal.show();\r\n\r\n\t\t\t\t},\r\n\t\t\t\tshowEdit: function($image)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $link = $image.closest('a', this.$editor[0]);\r\n\r\n\t\t\t\t\tthis.modal.load('imageEdit', this.lang.get('edit'), 705);\r\n\r\n\t\t\t\t\tthis.modal.createCancelButton();\r\n\t\t\t\t\tthis.image.buttonDelete = this.modal.createDeleteButton(this.lang.get('_delete'));\r\n\t\t\t\t\tthis.image.buttonSave = this.modal.createActionButton(this.lang.get('save'));\r\n\r\n\t\t\t\t\tthis.image.buttonDelete.on('click', $.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.image.remove($image);\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\tthis.image.buttonSave.on('click', $.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.image.update($image);\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t// hide link's tooltip\r\n\t\t\t\t\t$('.redactor-link-tooltip').remove();\r\n\r\n\t\t\t\t\t$('#redactor-image-title').val($image.attr('alt'));\r\n\r\n\t\t\t\t\tif (!this.opts.imageLink) $('.redactor-image-link-option').hide();\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $redactorImageLink = $('#redactor-image-link');\r\n\r\n\t\t\t\t\t\t$redactorImageLink.attr('href', $image.attr('src'));\r\n\t\t\t\t\t\tif ($link.length !== 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$redactorImageLink.val($link.attr('href'));\r\n\t\t\t\t\t\t\tif ($link.attr('target') == '_blank') $('#redactor-image-link-blank').prop('checked', true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!this.opts.imagePosition) $('.redactor-image-position-option').hide();\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar floatValue = ($image.css('display') == 'block' && $image.css('float') == 'none') ? 'center' : $image.css('float');\r\n\t\t\t\t\t\t$('#redactor-image-align').val(floatValue);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.modal.show();\r\n\t\t\t\t\t$('#redactor-image-title').focus();\r\n\r\n\t\t\t\t},\r\n\t\t\t\tsetFloating: function($image)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar floating = $('#redactor-image-align').val();\r\n\r\n\t\t\t\t\tvar imageFloat = '';\r\n\t\t\t\t\tvar imageDisplay = '';\r\n\t\t\t\t\tvar imageMargin = '';\r\n\r\n\t\t\t\t\tswitch (floating)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase 'left':\r\n\t\t\t\t\t\t\timageFloat = 'left';\r\n\t\t\t\t\t\t\timageMargin = '0 ' + this.opts.imageFloatMargin + ' ' + this.opts.imageFloatMargin + ' 0';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\t\timageFloat = 'right';\r\n\t\t\t\t\t\t\timageMargin = '0 0 ' + this.opts.imageFloatMargin + ' ' + this.opts.imageFloatMargin;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'center':\r\n\t\t\t\t\t\t\timageDisplay = 'block';\r\n\t\t\t\t\t\t\timageMargin = 'auto';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$image.css({ 'float': imageFloat, display: imageDisplay, margin: imageMargin });\r\n\t\t\t\t\t$image.attr('rel', $image.attr('style'));\r\n\t\t\t\t},\r\n\t\t\t\tupdate: function($image)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.image.hideResize();\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tvar $link = $image.closest('a', this.$editor[0]);\r\n\r\n\t\t\t\t\tvar title = $('#redactor-image-title').val().replace(/(<([^>]+)>)/ig,\"\");\r\n\t\t\t\t\t$image.attr('alt', title);\r\n\r\n\t\t\t\t\tthis.image.setFloating($image);\r\n\r\n\t\t\t\t\t// as link\r\n\t\t\t\t\tvar link = $.trim($('#redactor-image-link').val());\r\n\t\t\t\t\tvar link = link.replace(/(<([^>]+)>)/ig,\"\");\r\n\t\t\t\t\tif (link !== '')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// test url (add protocol)\r\n\t\t\t\t\t\tvar pattern = '((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\\\.)+[a-z]{2,}';\r\n\t\t\t\t\t\tvar re = new RegExp('^(http|ftp|https)://' + pattern, 'i');\r\n\t\t\t\t\t\tvar re2 = new RegExp('^' + pattern, 'i');\r\n\r\n\t\t\t\t\t\tif (link.search(re) == -1 && link.search(re2) === 0 && this.opts.linkProtocol)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlink = this.opts.linkProtocol + '://' + link;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar target = ($('#redactor-image-link-blank').prop('checked')) ? true : false;\r\n\r\n\t\t\t\t\t\tif ($link.length === 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar a = $('<a href=\"' + link + '\">' + this.utils.getOuterHtml($image) + '</a>');\r\n\t\t\t\t\t\t\tif (target) a.attr('target', '_blank');\r\n\r\n\t\t\t\t\t\t\t$image.replaceWith(a);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$link.attr('href', link);\r\n\t\t\t\t\t\t\tif (target)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$link.attr('target', '_blank');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$link.removeAttr('target');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if ($link.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$link.replaceWith(this.utils.getOuterHtml($image));\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.modal.close();\r\n\t\t\t\t\tthis.observe.images();\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\r\n\t\t\t\t},\r\n\t\t\t\tsetEditable: function($image)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.imageEditable)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$image.on('dragstart', $.proxy(this.image.onDrag, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar handler = $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\tthis.observe.image = $image;\r\n\r\n\t\t\t\t\t\tthis.image.resizer = this.image.loadEditableControls($image);\r\n\r\n\t\t\t\t\t\t$(document).on('mousedown.redactor-image-resize-hide.' + this.uuid, $.proxy(this.image.hideResize, this));\r\n\r\n\t\t\t\t\t\t// resize\r\n\t\t\t\t\t\tif (!this.opts.imageResizable) return;\r\n\r\n\t\t\t\t\t\tthis.image.resizer.on('mousedown.redactor touchstart.redactor', $.proxy(function(e)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.image.setResizable(e, $image);\r\n\t\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t}, this);\r\n\r\n\r\n\t\t\t\t\t$image.off('mousedown.redactor').on('mousedown.redactor', $.proxy(this.image.hideResize, this));\r\n\t\t\t\t\t$image.off('click.redactor touchstart.redactor').on('click.redactor touchstart.redactor', handler);\r\n\t\t\t\t},\r\n\t\t\t\tsetResizable: function(e, $image)\r\n\t\t\t\t{\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t    this.image.resizeHandle = {\r\n\t\t\t\t        x : e.pageX,\r\n\t\t\t\t        y : e.pageY,\r\n\t\t\t\t        el : $image,\r\n\t\t\t\t        ratio: $image.width() / $image.height(),\r\n\t\t\t\t        h: $image.height()\r\n\t\t\t\t    };\r\n\r\n\t\t\t\t    e = e.originalEvent || e;\r\n\r\n\t\t\t\t    if (e.targetTouches)\r\n\t\t\t\t    {\r\n\t\t\t\t         this.image.resizeHandle.x = e.targetTouches[0].pageX;\r\n\t\t\t\t         this.image.resizeHandle.y = e.targetTouches[0].pageY;\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t\tthis.image.startResize();\r\n\r\n\r\n\t\t\t\t},\r\n\t\t\t\tstartResize: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$(document).on('mousemove.redactor-image-resize touchmove.redactor-image-resize', $.proxy(this.image.moveResize, this));\r\n\t\t\t\t\t$(document).on('mouseup.redactor-image-resize touchend.redactor-image-resize', $.proxy(this.image.stopResize, this));\r\n\t\t\t\t},\r\n\t\t\t\tmoveResize: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\te = e.originalEvent || e;\r\n\r\n\t\t\t\t\tvar height = this.image.resizeHandle.h;\r\n\r\n\t\t            if (e.targetTouches) height += (e.targetTouches[0].pageY -  this.image.resizeHandle.y);\r\n\t\t            else height += (e.pageY -  this.image.resizeHandle.y);\r\n\r\n\t\t\t\t\tvar width = Math.round(height * this.image.resizeHandle.ratio);\r\n\r\n\t\t\t\t\tif (height < 50 || width < 100) return;\r\n\r\n\t\t\t\t\tvar height = Math.round(this.image.resizeHandle.el.width() / this.image.resizeHandle.ratio);\r\n\r\n\t\t\t\t\tthis.image.resizeHandle.el.attr({width: width, height: height});\r\n\t\t            this.image.resizeHandle.el.width(width);\r\n\t\t            this.image.resizeHandle.el.height(height);\r\n\r\n\t\t            this.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tstopResize: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.handle = false;\r\n\t\t\t\t\t$(document).off('.redactor-image-resize');\r\n\r\n\t\t\t\t\tthis.image.hideResize();\r\n\t\t\t\t},\r\n\t\t\t\tonDrag: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.$editor.find('#redactor-image-box').length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$editor.on('drop.redactor-image-inside-drop', $.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsetTimeout($.proxy(this.image.onDrop, this), 1);\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tonDrop: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.image.fixImageSourceAfterDrop();\r\n\t\t\t\t\tthis.observe.images();\r\n\t\t\t\t\tthis.$editor.off('drop.redactor-image-inside-drop');\r\n\t\t\t\t\tthis.clean.clearUnverified();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tfixImageSourceAfterDrop: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor.find('img[data-save-url]').each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $el = $(this);\r\n\t\t\t\t\t\t$el.attr('src', $el.attr('data-save-url'));\r\n\t\t\t\t\t\t$el.removeAttr('data-save-url');\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\thideResize: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (e && $(e.target).closest('#redactor-image-box', this.$editor[0]).length !== 0) return;\r\n\t\t\t\t\tif (e && e.target.tagName == 'IMG')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $image = $(e.target);\r\n\t\t\t\t\t\t$image.attr('data-save-url', $image.attr('src'));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar imageBox = this.$editor.find('#redactor-image-box');\r\n\t\t\t\t\tif (imageBox.length === 0) return;\r\n\r\n\t\t\t\t\t$('#redactor-image-editter').remove();\r\n\t\t\t\t\t$('#redactor-image-resizer').remove();\r\n\r\n\t\t\t\t\timageBox.find('img').css({\r\n\t\t\t\t\t\tmarginTop: imageBox[0].style.marginTop,\r\n\t\t\t\t\t\tmarginBottom: imageBox[0].style.marginBottom,\r\n\t\t\t\t\t\tmarginLeft: imageBox[0].style.marginLeft,\r\n\t\t\t\t\t\tmarginRight: imageBox[0].style.marginRight\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\timageBox.css('margin', '');\r\n\t\t\t\t\timageBox.find('img').css('opacity', '');\r\n\t\t\t\t\timageBox.replaceWith(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn $(this).contents();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(document).off('mousedown.redactor-image-resize-hide.' + this.uuid);\r\n\r\n\r\n\t\t\t\t\tif (typeof this.image.resizeHandle !== 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.image.resizeHandle.el.attr('rel', this.image.resizeHandle.el.attr('style'));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t},\r\n\t\t\t\tloadResizableControls: function($image, imageBox)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.imageResizable && !this.utils.isMobile())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar imageResizer = $('<span id=\"redactor-image-resizer\" data-redactor=\"verified\"></span>');\r\n\r\n\t\t\t\t\t\tif (!this.utils.isDesktop())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\timageResizer.css({ width: '15px', height: '15px' });\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\timageResizer.attr('contenteditable', false);\r\n\t\t\t\t\t\timageBox.append(imageResizer);\r\n\t\t\t\t\t\timageBox.append($image);\r\n\r\n\t\t\t\t\t\treturn imageResizer;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\timageBox.append($image);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tloadEditableControls: function($image)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar imageBox = $('<span id=\"redactor-image-box\" data-redactor=\"verified\">');\r\n\t\t\t\t\timageBox.css('float', $image.css('float')).attr('contenteditable', false);\r\n\r\n\t\t\t\t\tif ($image[0].style.margin != 'auto')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\timageBox.css({\r\n\t\t\t\t\t\t\tmarginTop: $image[0].style.marginTop,\r\n\t\t\t\t\t\t\tmarginBottom: $image[0].style.marginBottom,\r\n\t\t\t\t\t\t\tmarginLeft: $image[0].style.marginLeft,\r\n\t\t\t\t\t\t\tmarginRight: $image[0].style.marginRight\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$image.css('margin', '');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\timageBox.css({ 'display': 'block', 'margin': 'auto' });\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$image.css('opacity', '.5').after(imageBox);\r\n\r\n\r\n\t\t\t\t\tif (this.opts.imageEditable)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// editter\r\n\t\t\t\t\t\tthis.image.editter = $('<span id=\"redactor-image-editter\" data-redactor=\"verified\">' + this.lang.get('edit') + '</span>');\r\n\t\t\t\t\t\tthis.image.editter.attr('contenteditable', false);\r\n\t\t\t\t\t\tthis.image.editter.on('click', $.proxy(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.image.showEdit($image);\r\n\t\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t\timageBox.append(this.image.editter);\r\n\r\n\t\t\t\t\t\t// position correction\r\n\t\t\t\t\t\tvar editerWidth = this.image.editter.innerWidth();\r\n\t\t\t\t\t\tthis.image.editter.css('margin-left', '-' + editerWidth/2 + 'px');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this.image.loadResizableControls($image, imageBox);\r\n\r\n\t\t\t\t},\r\n\t\t\t\tremove: function(image)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $image = $(image);\r\n\t\t\t\t\tvar $link = $image.closest('a', this.$editor[0]);\r\n\t\t\t\t\tvar $figure = $image.closest('figure', this.$editor[0]);\r\n\t\t\t\t\tvar $parent = $image.parent();\r\n\t\t\t\t\tif ($('#redactor-image-box').length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$parent = $('#redactor-image-box').parent();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar $next;\r\n\t\t\t\t\tif ($figure.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$next = $figure.next();\r\n\t\t\t\t\t\t$figure.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if ($link.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$parent = $link.parent();\r\n\t\t\t\t\t\t$link.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$image.remove();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('#redactor-image-box').remove();\r\n\r\n\t\t\t\t\tif ($figure.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.caret.setStart($next);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.caret.setStart($parent);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// delete callback\r\n\t\t\t\t\tthis.core.setCallback('imageDelete', $image[0].src, $image);\r\n\r\n\t\t\t\t\tthis.modal.close();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tinsert: function(json, direct, e)\r\n\t\t\t\t{\r\n\t\t\t\t\t// error callback\r\n\t\t\t\t\tif (typeof json.error != 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.close();\r\n\t\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\t\tthis.core.setCallback('imageUploadError', json);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar $img;\r\n\t\t\t\t\tif (typeof json == 'string')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$img = $(json).attr('data-redactor-inserted-image', 'true');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$img = $('<img>');\r\n\t\t\t\t\t\t$img.attr('src', json.filelink).attr('data-redactor-inserted-image', 'true');\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tvar node = $img;\r\n\t\t\t\t\tvar isP = this.utils.isCurrentOrParent('P');\r\n\t\t\t\t\tif (isP)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// will replace\r\n\t\t\t\t\t\tnode = $('<blockquote />').append($img);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (direct)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.selection.removeMarkers();\r\n\t\t\t\t\t\tvar marker = this.selection.getMarker();\r\n\t\t\t\t\t\tthis.insert.nodeToCaretPositionFromPoint(e, marker);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.close();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tthis.insert.html(this.utils.getOuterHtml(node), false);\r\n\r\n\t\t\t\t\tvar $image = this.$editor.find('img[data-redactor-inserted-image=true]').removeAttr('data-redactor-inserted-image');\r\n\r\n\t\t\t\t\tif (isP)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$image.parent().contents().unwrap().wrap('<p />');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (!this.utils.isEmpty(this.code.get()))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$image.before('<br>');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$image.after('<br>');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typeof json == 'string') return;\r\n\r\n\t\t\t\t\tthis.core.setCallback('imageUpload', $image, json);\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tindent: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tincrease: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t// focus\r\n\t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\r\n\r\n\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tvar block = this.selection.getBlock();\r\n\r\n\t\t\t\t\tif (block && block.tagName == 'LI')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.indent.increaseLists();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (block === false && this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.indent.increaseText();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.indent.increaseBlocks();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tincreaseLists: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tdocument.execCommand('indent');\r\n\r\n\t\t\t\t\tthis.indent.fixEmptyIndent();\r\n\t\t\t\t\tthis.clean.normalizeLists();\r\n\t\t\t\t\tthis.clean.clearUnverified();\r\n\t\t\t\t},\r\n\t\t\t\tincreaseBlocks: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$.each(this.selection.getBlocks(), $.proxy(function(i, elem)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (elem.tagName === 'TD' || elem.tagName === 'TH') return;\r\n\r\n\t\t\t\t\t\tvar $el = this.utils.getAlignmentElement(elem);\r\n\r\n\t\t\t\t\t\tvar left = this.utils.normalize($el.css('margin-left')) + this.opts.indentValue;\r\n\t\t\t\t\t\t$el.css('margin-left', left + 'px');\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tincreaseText: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar wrapper = this.selection.wrap('div');\r\n\t\t\t\t\t$(wrapper).attr('data-tagblock', 'redactor');\r\n\t\t\t\t\t$(wrapper).css('margin-left', this.opts.indentValue + 'px');\r\n\t\t\t\t},\r\n\t\t\t\tdecrease: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tvar block = this.selection.getBlock();\r\n\t\t\t\t\tif (block && block.tagName == 'LI')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.indent.decreaseLists();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.indent.decreaseBlocks();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tdecreaseLists: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tdocument.execCommand('outdent');\r\n\r\n\t\t\t\t\tvar current = this.selection.getCurrent();\r\n\t\t\t\t\tvar $item = $(current).closest('li', this.$editor[0]);\r\n\r\n\t\t\t\t\tthis.indent.fixEmptyIndent();\r\n\r\n\t\t\t\t\tif (!this.opts.linebreaks && $item.length === 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdocument.execCommand('formatblock', false, 'p');\r\n\t\t\t\t\t\tthis.$editor.find('ul, ol, blockquote, p').each($.proxy(this.utils.removeEmpty, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.clean.clearUnverified();\r\n\t\t\t\t},\r\n\t\t\t\tdecreaseBlocks: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$.each(this.selection.getBlocks(), $.proxy(function(i, elem)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $el = this.utils.getAlignmentElement(elem);\r\n\t\t\t\t\t\tvar left = this.utils.normalize($el.css('margin-left')) - this.opts.indentValue;\r\n\r\n\t\t\t\t\t\tif (left <= 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (this.opts.linebreaks && typeof($el.data('tagblock')) !== 'undefined')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$el.replaceWith($el.html() + '<br />');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$el.css('margin-left', '');\r\n\t\t\t\t\t\t\t\tthis.utils.removeEmptyAttr($el, 'style');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$el.css('margin-left', left + 'px');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tfixEmptyIndent: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar block = this.selection.getBlock();\r\n\r\n\t\t\t\t\tif (this.range.collapsed && block && block.tagName == 'LI' && this.utils.isEmpty($(block).text()))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $block = $(block);\r\n\t\t\t\t\t\t$block.find('span').not('.redactor-selection-marker').contents().unwrap();\r\n\t\t\t\t\t\t$block.append('<br>');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tinline: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tformatting: function(name)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar type, value;\r\n\r\n\t\t\t\t\tif (typeof this.formatting[name].style != 'undefined') type = 'style';\r\n\t\t\t\t\telse if (typeof this.formatting[name]['class'] != 'undefined') type = 'class';\r\n\r\n\t\t\t\t\tif (type) value = this.formatting[name][type];\r\n\r\n\t\t\t\t\tthis.inline.format(this.formatting[name].tag, type, value);\r\n\r\n\t\t\t\t},\r\n\t\t\t\tformat: function(tag, type, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar current = this.selection.getCurrent();\r\n\t\t\t\t\tif (current && current.tagName === 'TR') return;\r\n\r\n\t\t\t\t\t// Stop formatting pre and headers\r\n\t\t\t\t\tif (this.utils.isCurrentOrParent('PRE') || this.utils.isCurrentOrParentHeader()) return;\r\n\r\n\t\t\t\t\tvar tags = ['b', 'bold', 'i', 'italic', 'underline', 'strikethrough', 'deleted', 'superscript', 'subscript'];\r\n\t\t\t\t\tvar replaced = ['strong', 'strong', 'em', 'em', 'u', 'del', 'del', 'sup', 'sub'];\r\n\r\n\t\t\t\t\tfor (var i = 0; i < tags.length; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (tag == tags[i]) tag = replaced[i];\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif (this.opts.allowedTags)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($.inArray(tag, this.opts.allowedTags) == -1) return;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($.inArray(tag, this.opts.deniedTags) !== -1) return;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.inline.type = type || false;\r\n\t\t\t\t\tthis.inline.value = value || false;\r\n\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tif (!this.utils.browser('msie') && !this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.focus();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tif (this.range.collapsed)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.inline.formatCollapsed(tag);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.inline.formatMultiple(tag);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tformatCollapsed: function(tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar current = this.selection.getCurrent();\r\n\t\t\t\t\tvar $parent = $(current).closest(tag + '[data-redactor-tag=' + tag + ']', this.$editor[0]);\r\n\r\n\t\t\t\t\t// inline there is\r\n\t\t\t\t\tif ($parent.length !== 0 && (this.inline.type != 'style' && $parent[0].tagName != 'SPAN'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// remove empty\r\n\t\t\t\t\t\tif (this.utils.isEmpty($parent.text()))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.caret.setAfter($parent[0]);\r\n\r\n\t\t\t\t\t\t\t$parent.remove();\r\n\t\t\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (this.utils.isEndOfElement($parent))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.caret.setAfter($parent[0]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// create empty inline\r\n\t\t\t\t\tvar node = $('<' + tag + '>').attr('data-verified', 'redactor').attr('data-redactor-tag', tag);\r\n\t\t\t\t\tnode.html(this.opts.invisibleSpace);\r\n\r\n\t\t\t\t\tnode = this.inline.setFormat(node);\r\n\r\n\t\t\t\t\tvar node = this.insert.node(node);\r\n\t\t\t\t\tthis.caret.setEnd(node);\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tformatMultiple: function(tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.inline.formatConvert(tag);\r\n\r\n\t\t\t\t\tthis.selection.save();\r\n\t\t\t\t\tdocument.execCommand('strikethrough');\r\n\r\n\t\t\t\t\tthis.$editor.find('strike').each($.proxy(function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $el = $(s);\r\n\r\n\t\t\t\t\t\tthis.inline.formatRemoveSameChildren($el, tag);\r\n\r\n\t\t\t\t\t\tvar $span;\r\n\t\t\t\t\t\tif (this.inline.type)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$span = $('<span>').attr('data-redactor-tag', tag).attr('data-verified', 'redactor');\r\n\t\t\t\t\t\t\t$span = this.inline.setFormat($span);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$span = $('<' + tag + '>').attr('data-redactor-tag', tag).attr('data-verified', 'redactor');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$el.replaceWith($span.html($el.contents()));\r\n\t\t\t\t\t\tvar $parent = $span.parent();\r\n\r\n\t\t\t\t\t\t// remove U tag if selected link + node\r\n\t\t\t\t\t\tif ($span[0].tagName === 'A' && $parent && $parent[0].tagName === 'U')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$span.parent().replaceWith($span);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (tag == 'span')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif ($parent && $parent[0].tagName === 'SPAN' && this.inline.type === 'style')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar arr = this.inline.value.split(';');\r\n\r\n\t\t\t\t\t\t\t\tfor (var z = 0; z < arr.length; z++)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif (arr[z] === '') return;\r\n\t\t\t\t\t\t\t\t\tvar style = arr[z].split(':');\r\n\t\t\t\t\t\t\t\t\t$parent.css(style[0], '');\r\n\r\n\t\t\t\t\t\t\t\t\tif (this.utils.removeEmptyAttr($parent, 'style'))\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t$parent.replaceWith($parent.contents());\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t// clear text decoration\r\n\t\t\t\t\tif (tag != 'span')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.find(this.opts.inlineTags.join(', ')).each($.proxy(function(i,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $el = $(s);\r\n\r\n\r\n\t\t\t\t\t\t\tif (s.tagName === 'U' && s.attributes.length === 0)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$el.replaceWith($el.contents());\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar property = $el.css('text-decoration');\r\n\t\t\t\t\t\t\tif (property === 'line-through')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$el.css('text-decoration', '');\r\n\t\t\t\t\t\t\t\tthis.utils.removeEmptyAttr($el, 'style');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (tag != 'del')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar _this = this;\r\n\t\t\t\t\t\tthis.$editor.find('inline').each(function(i,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_this.utils.replaceToTag(s, 'del');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (tag != 'u')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar _this = this;\r\n\t\t\t\t\t\tthis.$editor.find('unline').each(function(i,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t_this.utils.replaceToTag(s, 'u');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t},\r\n\t\t\t\tformatRemoveSameChildren: function($el, tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar self = this;\r\n\t\t\t\t\t$el.children(tag).each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $child = $(this);\r\n\r\n\t\t\t\t\t\tif (!$child.hasClass('redactor-selection-marker'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (self.inline.type == 'style')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar arr = self.inline.value.split(';');\r\n\r\n\t\t\t\t\t\t\t\tfor (var z = 0; z < arr.length; z++)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif (arr[z] === '') return;\r\n\r\n\t\t\t\t\t\t\t\t\tvar style = arr[z].split(':');\r\n\t\t\t\t\t\t\t\t\t$child.css(style[0], '');\r\n\r\n\t\t\t\t\t\t\t\t\tif (self.utils.removeEmptyAttr($child , 'style'))\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t$child.replaceWith($child.contents());\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$child.contents().unwrap();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tformatConvert: function(tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tvar find = '';\r\n\t\t\t\t\tif (this.inline.type == 'class') find = '[data-redactor-class=' + this.inline.value + ']';\r\n\t\t\t\t\telse if (this.inline.type == 'style')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfind = '[data-redactor-style=\"' + this.inline.value + '\"]';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar self = this;\r\n\t\t\t\t\tif (tag != 'del')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.find('del').each(function(i,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tself.utils.replaceToTag(s, 'inline');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (tag != 'u')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.find('u').each(function(i,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tself.utils.replaceToTag(s, 'unline');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (tag != 'span')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.find(tag).each(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $el = $(this);\r\n\t\t\t\t\t\t\t$el.replaceWith($('<strike />').html($el.contents()));\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$editor.find('[data-redactor-tag=\"' + tag + '\"]' + find).each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (find === '' && tag == 'span' && this.tagName.toLowerCase() == tag) return;\r\n\r\n\t\t\t\t\t\tvar $el = $(this);\r\n\t\t\t\t\t\t$el.replaceWith($('<strike />').html($el.contents()));\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t},\r\n\t\t\t\tsetFormat: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\tswitch (this.inline.type)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase 'class':\r\n\r\n\t\t\t\t\t\t\tif (node.hasClass(this.inline.value))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnode.removeClass(this.inline.value);\r\n\t\t\t\t\t\t\t\tnode.removeAttr('data-redactor-class');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnode.addClass(this.inline.value);\r\n\t\t\t\t\t\t\t\tnode.attr('data-redactor-class', this.inline.value);\r\n\t\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'style':\r\n\r\n\t\t\t\t\t\t\tnode[0].style.cssText = this.inline.value;\r\n\t\t\t\t\t\t\tnode.attr('data-redactor-style', this.inline.value);\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn node;\r\n\t\t\t\t},\r\n\t\t\t\tremoveStyle: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\tvar current = this.selection.getCurrent();\r\n\t\t\t\t\tvar nodes = this.selection.getInlines();\r\n\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tif (current && current.tagName === 'SPAN')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $s = $(current);\r\n\r\n\t\t\t\t\t\t$s.removeAttr('style');\r\n\t\t\t\t\t\tif ($s[0].attributes.length === 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$s.replaceWith($s.contents());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $s = $(s);\r\n\t\t\t\t\t\tif ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$s.removeAttr('style');\r\n\t\t\t\t\t\t\tif ($s[0].attributes.length === 0)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$s.replaceWith($s.contents());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t},\r\n\t\t\t\tremoveStyleRule: function(name)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\tvar parent = this.selection.getParent();\r\n\t\t\t\t\tvar nodes = this.selection.getInlines();\r\n\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tif (parent && parent.tagName === 'SPAN')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $s = $(parent);\r\n\r\n\t\t\t\t\t\t$s.css(name, '');\r\n\t\t\t\t\t\tthis.utils.removeEmptyAttr($s, 'style');\r\n\t\t\t\t\t\tif ($s[0].attributes.length === 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$s.replaceWith($s.contents());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $s = $(s);\r\n\t\t\t\t\t\tif ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$s.css(name, '');\r\n\t\t\t\t\t\t\tthis.utils.removeEmptyAttr($s, 'style');\r\n\t\t\t\t\t\t\tif ($s[0].attributes.length === 0)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$s.replaceWith($s.contents());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tremoveFormat: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\tvar current = this.selection.getCurrent();\r\n\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tdocument.execCommand('removeFormat');\r\n\r\n\t\t\t\t\tif (current && current.tagName === 'SPAN')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(current).replaceWith($(current).contents());\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t$.each(this.selection.getNodes(), $.proxy(function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $s = $(s);\r\n\t\t\t\t\t\tif ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$s.replaceWith($s.contents());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t},\r\n\t\t\t\ttoggleClass: function(className)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.inline.format('span', 'class', className);\r\n\t\t\t\t},\r\n\t\t\t\ttoggleStyle: function(value)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.inline.format('span', 'style', value);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tinsert: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tset: function(html, clean)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.placeholder.remove();\r\n\r\n\t\t\t\t\thtml = this.clean.setVerified(html);\r\n\r\n\t\t\t\t\tif (typeof clean == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = this.clean.onPaste(html, false);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$editor.html(html);\r\n\t\t\t\t\tthis.selection.remove();\r\n\t\t\t\t\tthis.focus.setEnd();\r\n\t\t\t\t\tthis.clean.normalizeLists();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\tthis.observe.load();\r\n\r\n\t\t\t\t\tif (typeof clean == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsetTimeout($.proxy(this.clean.clearUnverified, this), 10);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttext: function(text)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.placeholder.remove();\r\n\r\n\t\t\t\t\ttext = text.toString();\r\n\t\t\t\t\ttext = $.trim(text);\r\n\t\t\t\t\ttext = this.clean.getPlainText(text, false);\r\n\r\n\t\t\t\t\tthis.$editor.focus();\r\n\r\n\t\t\t\t\tif (this.utils.browser('msie'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.insert.htmlIe(text);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\t\tthis.range.deleteContents();\r\n\t\t\t\t\t\tvar el = document.createElement(\"div\");\r\n\t\t\t\t\t\tel.innerHTML = text;\r\n\t\t\t\t\t\tvar frag = document.createDocumentFragment(), node, lastNode;\r\n\t\t\t\t\t\twhile ((node = el.firstChild))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlastNode = frag.appendChild(node);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.range.insertNode(frag);\r\n\r\n\t\t\t\t\t\tif (lastNode)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar range = this.range.cloneRange();\r\n\t\t\t\t\t\t\trange.setStartAfter(lastNode);\r\n\t\t\t\t\t\t\trange.collapse(true);\r\n\t\t\t\t\t\t\tthis.sel.removeAllRanges();\r\n\t\t\t\t\t\t\tthis.sel.addRange(range);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\tthis.clean.clearUnverified();\r\n\t\t\t\t},\r\n\t\t\t\thtmlWithoutClean: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.insert.html(html, false);\r\n\t\t\t\t},\r\n\t\t\t\thtml: function(html, clean)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.placeholder.remove();\r\n\r\n\t\t\t\t\tif (typeof clean == 'undefined') clean = true;\r\n\r\n\t\t\t\t\tif (!this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.focus();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thtml = this.clean.setVerified(html);\r\n\r\n\t\t\t\t\tif (clean)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = this.clean.onPaste(html);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.utils.browser('msie'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.insert.htmlIe(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.clean.singleLine) this.insert.execHtml(html);\r\n\t\t\t\t\t\telse document.execCommand('insertHTML', false, html);\r\n\r\n\t\t\t\t\t\tthis.insert.htmlFixMozilla();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.clean.normalizeLists();\r\n\r\n\t\t\t\t\t// remove empty paragraphs finaly\r\n\t\t\t\t\tif (!this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.find('p').each($.proxy(this.utils.removeEmpty, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\tthis.observe.load();\r\n\r\n\t\t\t\t\tif (clean)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.clean.clearUnverified();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\thtmlFixMozilla: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t// FF inserts empty p when content was selected dblclick\r\n\t\t\t\t\tif (!this.utils.browser('mozilla')) return;\r\n\r\n\t\t\t\t\tvar $next = $(this.selection.getBlock()).next();\r\n\t\t\t\t\tif ($next.length > 0 && $next[0].tagName == 'P' && $next.html() === '')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$next.remove();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\thtmlIe: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.utils.isIe11())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar parent = this.utils.isCurrentOrParent('P');\r\n\t\t\t\t\t\tvar $html = $('<div>').append(html);\r\n\t\t\t\t\t\tvar blocksMatch = $html.contents().is('p, :header, dl, ul, ol, div, table, td, blockquote, pre, address, section, header, footer, aside, article');\r\n\r\n\t\t\t\t\t\tif (parent && blocksMatch) this.insert.ie11FixInserting(parent, html);\r\n\t\t\t\t\t\telse this.insert.ie11PasteFrag(html);\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdocument.selection.createRange().pasteHTML(html);\r\n\r\n\t\t\t\t},\r\n\t\t\t\texecHtml: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = this.clean.setVerified(html);\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tthis.range.deleteContents();\r\n\r\n\t\t\t\t\tvar el = document.createElement('div');\r\n\t\t\t\t\tel.innerHTML = html;\r\n\r\n\t\t\t\t\tvar frag = document.createDocumentFragment(), node, lastNode;\r\n\t\t\t\t\twhile ((node = el.firstChild))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlastNode = frag.appendChild(node);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.range.insertNode(frag);\r\n\r\n\t\t\t\t\tthis.range.collapse(true);\r\n\t\t\t\t\tthis.caret.setAfter(lastNode);\r\n\r\n\t\t\t\t},\r\n\t\t\t\tnode: function(node, deleteContents)\r\n\t\t\t\t{\r\n\t\t\t\t\tnode = node[0] || node;\r\n\r\n\t\t\t\t\tvar offset = this.caret.getOffset();\r\n\t\t\t\t\tvar html = this.utils.getOuterHtml(node);\r\n\t\t\t\t\thtml = this.clean.setVerified(html);\r\n\r\n\t\t\t\t\tif (html.match(/</g) !== null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnode = $(html)[0];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tif (deleteContents !== false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.range.deleteContents();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.range.insertNode(node);\r\n\t\t\t\t\tthis.range.collapse(false);\r\n\t\t\t\t\tthis.selection.addRange();\r\n\r\n\t\t\t\t\tthis.caret.setOffset(offset);\r\n\r\n\t\t\t\t\treturn node;\r\n\t\t\t\t},\r\n\t\t\t\tnodeToPoint: function(node, x, y)\r\n\t\t\t\t{\r\n\t\t\t\t\tnode = node[0] || node;\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tvar range;\r\n\t\t\t\t\tif (document.caretPositionFromPoint)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t    var pos = document.caretPositionFromPoint(x, y);\r\n\r\n\t\t\t\t\t    this.range.setStart(pos.offsetNode, pos.offset);\r\n\t\t\t\t\t    this.range.collapse(true);\r\n\t\t\t\t\t    this.range.insertNode(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (document.caretRangeFromPoint)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t    range = document.caretRangeFromPoint(x, y);\r\n\t\t\t\t\t    range.insertNode(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (typeof document.body.createTextRange != \"undefined\")\r\n\t\t\t\t\t{\r\n\t\t\t\t        range = document.body.createTextRange();\r\n\t\t\t\t        range.moveToPoint(x, y);\r\n\t\t\t\t        var endRange = range.duplicate();\r\n\t\t\t\t        endRange.moveToPoint(x, y);\r\n\t\t\t\t        range.setEndPoint(\"EndToEnd\", endRange);\r\n\t\t\t\t        range.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tnodeToCaretPositionFromPoint: function(e, node)\r\n\t\t\t\t{\r\n\t\t\t\t\tnode = node[0] || node;\r\n\r\n\t\t\t\t\tvar range;\r\n\t\t\t\t\tvar x = e.clientX, y = e.clientY;\r\n\t\t\t\t\tif (document.caretPositionFromPoint)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t    var pos = document.caretPositionFromPoint(x, y);\r\n\t\t\t\t\t    var sel = document.getSelection();\r\n\t\t\t\t\t    range = sel.getRangeAt(0);\r\n\t\t\t\t\t    range.setStart(pos.offsetNode, pos.offset);\r\n\t\t\t\t\t    range.collapse(true);\r\n\t\t\t\t\t    range.insertNode(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (document.caretRangeFromPoint)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t    range = document.caretRangeFromPoint(x, y);\r\n\t\t\t\t\t    range.insertNode(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (typeof document.body.createTextRange != \"undefined\")\r\n\t\t\t\t\t{\r\n\t\t\t\t        range = document.body.createTextRange();\r\n\t\t\t\t        range.moveToPoint(x, y);\r\n\t\t\t\t        var endRange = range.duplicate();\r\n\t\t\t\t        endRange.moveToPoint(x, y);\r\n\t\t\t\t        range.setEndPoint(\"EndToEnd\", endRange);\r\n\t\t\t\t        range.select();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tie11FixInserting: function(parent, html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar node = document.createElement('span');\r\n\t\t\t\t\tnode.className = 'redactor-ie-paste';\r\n\t\t\t\t\tthis.insert.node(node);\r\n\r\n\t\t\t\t\tvar parHtml = $(parent).html();\r\n\r\n\t\t\t\t\tparHtml = '<p>' + parHtml.replace(/<span class=\"redactor-ie-paste\"><\\/span>/gi, '</p>' + html + '<p>') + '</p>';\r\n\t\t\t\t\tparHtml = parHtml.replace(/<p><\\/p>/gi, '');\r\n\t\t\t\t\t$(parent).replaceWith(parHtml);\r\n\t\t\t\t},\r\n\t\t\t\tie11PasteFrag: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\tthis.range.deleteContents();\r\n\r\n\t\t\t\t\tvar el = document.createElement(\"div\");\r\n\t\t\t\t\tel.innerHTML = html;\r\n\r\n\t\t\t\t\tvar frag = document.createDocumentFragment(), node, lastNode;\r\n\t\t\t\t\twhile ((node = el.firstChild))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlastNode = frag.appendChild(node);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.range.insertNode(frag);\r\n\t\t\t\t\tthis.range.collapse(false);\r\n\t\t\t\t\tthis.selection.addRange();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tkeydown: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tinit: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.rtePaste) return;\r\n\r\n\t\t\t\t\tvar key = e.which;\r\n\t\t\t\t\tvar arrow = (key >= 37 && key <= 40);\r\n\r\n\t\t\t\t\tthis.keydown.ctrl = e.ctrlKey || e.metaKey;\r\n\t\t\t\t\tthis.keydown.current = this.selection.getCurrent();\r\n\t\t\t\t\tthis.keydown.parent = this.selection.getParent();\r\n\t\t\t\t\tthis.keydown.block = this.selection.getBlock();\r\n\r\n\t\t\t        // detect tags\r\n\t\t\t\t\tthis.keydown.pre = this.utils.isTag(this.keydown.current, 'pre');\r\n\t\t\t\t\tthis.keydown.blockquote = this.utils.isTag(this.keydown.current, 'blockquote');\r\n\t\t\t\t\tthis.keydown.figcaption = this.utils.isTag(this.keydown.current, 'figcaption');\r\n\r\n\t\t\t\t\t// shortcuts setup\r\n\t\t\t\t\tthis.shortcuts.init(e, key);\r\n\r\n\t\t\t\t\tif (this.utils.isDesktop())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.keydown.checkEvents(arrow, key);\r\n\t\t\t\t\t\tthis.keydown.setupBuffer(e, key);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.keydown.addArrowsEvent(arrow);\r\n\t\t\t\t\tthis.keydown.setupSelectAll(e, key);\r\n\r\n\t\t\t\t\t// callback\r\n\t\t\t\t\tvar keydownStop = this.core.setCallback('keydown', e);\r\n\t\t\t\t\tif (keydownStop === false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// ie and ff exit from table\r\n\t\t\t\t\tif (this.opts.enterKey && (this.utils.browser('msie') || this.utils.browser('mozilla')) && (key === this.keyCode.DOWN || key === this.keyCode.RIGHT))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar isEndOfTable = false;\r\n\t\t\t\t\t\tvar $table = false;\r\n\t\t\t\t\t\tif (this.keydown.block && this.keydown.block.tagName === 'TD')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$table = $(this.keydown.block).closest('table', this.$editor[0]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ($table && $table.find('td').last()[0] === this.keydown.block)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tisEndOfTable = true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this.utils.isEndOfElement() && isEndOfTable)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar node = $(this.opts.emptyHtml);\r\n\t\t\t\t\t\t\t$table.after(node);\r\n\t\t\t\t\t\t\tthis.caret.setStart(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// down\r\n\t\t\t\t\tif (this.opts.enterKey && key === this.keyCode.DOWN)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.keydown.onArrowDown();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// turn off enter key\r\n\t\t\t\t\tif (!this.opts.enterKey && key === this.keyCode.ENTER)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t// remove selected\r\n\t\t\t\t\t\tif (!this.range.collapsed) this.range.deleteContents();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// on enter\r\n\t\t\t\t\tif (key == this.keyCode.ENTER && !e.shiftKey && !e.ctrlKey && !e.metaKey)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar stop = this.core.setCallback('enter', e);\r\n\t\t\t\t\t\tif (stop === false)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this.keydown.blockquote && this.keydown.exitFromBlockquote(e) === true)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar current, $next;\r\n\t\t\t\t\t\tif (this.keydown.pre)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn this.keydown.insertNewLine(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (this.keydown.blockquote || this.keydown.figcaption)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcurrent = this.selection.getCurrent();\r\n\t\t\t\t\t\t\t$next = $(current).next();\r\n\r\n\t\t\t\t\t\t\tif ($next.length !== 0 && $next[0].tagName == 'BR')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (this.utils.isEndOfElement() && (current && current != 'SPAN'))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn this.keydown.insertDblBreakLine(e);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (this.opts.linebreaks && !this.keydown.block)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcurrent = this.selection.getCurrent();\r\n\t\t\t\t\t\t\t$next = $(this.keydown.current).next();\r\n\r\n\t\t\t\t\t\t\tif ($next.length !== 0 && $next[0].tagName == 'BR')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (current !== false && $(current).hasClass('redactor-invisible-space'))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthis.caret.setAfter(current);\r\n\t\t\t\t\t\t\t\t$(current).contents().unwrap();\r\n\r\n\t\t\t\t\t\t\t\treturn this.keydown.insertDblBreakLine(e);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif (this.utils.isEndOfEditor())\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\treturn this.keydown.insertDblBreakLine(e);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if ($next.length === 0 && current === false && typeof $next.context != 'undefined')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (this.opts.linebreaks && this.keydown.block)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tsetTimeout($.proxy(this.keydown.replaceDivToBreakLine, this), 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// paragraphs\r\n\t\t\t\t\t\telse if (!this.opts.linebreaks && this.keydown.block)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tsetTimeout($.proxy(this.keydown.replaceDivToParagraph, this), 1);\r\n\r\n\t\t\t\t\t\t\tif (this.keydown.block.tagName === 'LI')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcurrent = this.selection.getCurrent();\r\n\t\t\t\t\t\t\t\tvar $parent = $(current).closest('li', this.$editor[0]);\r\n\t\t\t\t\t\t\t\tvar $list = $parent.closest('ul,ol', this.$editor[0]);\r\n\r\n\t\t\t\t\t\t\t\tif ($parent.length !== 0 && this.utils.isEmpty($parent.html()) && $list.next().length === 0 && this.utils.isEmpty($list.find(\"li\").last().html()))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$list.find(\"li\").last().remove();\r\n\r\n\t\t\t\t\t\t\t\t\tvar node = $(this.opts.emptyHtml);\r\n\t\t\t\t\t\t\t\t\t$list.after(node);\r\n\t\t\t\t\t\t\t\t\tthis.caret.setStart(node);\r\n\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (!this.opts.linebreaks && !this.keydown.block)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn this.keydown.insertParagraph(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Shift+Enter or Ctrl+Enter\r\n\t\t\t\t\tif (key === this.keyCode.ENTER && (e.ctrlKey || e.shiftKey))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn this.keydown.onShiftEnter(e);\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t// tab or cmd + [\r\n\t\t\t\t\tif (key === this.keyCode.TAB || e.metaKey && key === 221 || e.metaKey && key === 219)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn this.keydown.onTab(e, key);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// image delete and backspace\r\n\t\t\t\t\tif (key === this.keyCode.BACKSPACE || key === this.keyCode.DELETE)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar nodes = this.selection.getNodes();\r\n\r\n\t\t\t\t\t\tif (nodes)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar len = nodes.length;\r\n\t\t\t\t\t\t\tvar last;\r\n\t\t\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar children = $(nodes[i]).children('img');\r\n\t\t\t\t\t\t\t\tif (children.length !== 0)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar self = this;\r\n\t\t\t\t\t\t\t\t\t$.each(children, function(z,s)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tvar $s = $(s);\r\n\t\t\t\t\t\t\t\t\t\tif ($s.css('float') != 'none') return;\r\n\r\n\t\t\t\t\t\t\t\t\t\t// image delete callback\r\n\t\t\t\t\t\t\t\t\t\tself.core.setCallback('imageDelete', s.src, $s);\r\n\t\t\t\t\t\t\t\t\t\tlast = s;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (nodes[i].tagName == 'IMG')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif (last != nodes[i])\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t// image delete callback\r\n\t\t\t\t\t\t\t\t\t\tthis.core.setCallback('imageDelete', nodes[i].src, $(nodes[i]));\r\n\t\t\t\t\t\t\t\t\t\tlast = nodes[i];\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// backspace\r\n\t\t\t\t\tif (key === this.keyCode.BACKSPACE)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// backspace as outdent\r\n\t\t\t\t\t\tvar block = this.selection.getBlock();\r\n\t\t\t\t\t\tvar indented = ($(block).css('margin-left') !== '0px');\r\n\t\t\t\t\t\tif (block && indented && this.range.collapsed && this.utils.isStartOfElement())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.indent.decrease();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// remove hr in FF\r\n\t\t\t\t\t\tif (this.utils.browser('mozilla'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar prev = this.selection.getPrev();\r\n\t\t\t\t\t\t\tvar prev2 = $(prev).prev()[0];\r\n\t\t\t\t\t\t\tif (prev && prev.tagName === 'HR') $(prev).remove();\r\n\t\t\t\t\t\t\tif (prev2 && prev2.tagName === 'HR') $(prev2).remove();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.keydown.removeInvisibleSpace();\r\n\t\t\t\t\t\tthis.keydown.removeEmptyListInTable(e);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tcheckEvents: function(arrow, key)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!arrow && (this.core.getEvent() == 'click' || this.core.getEvent() == 'arrow'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.core.addEvent(false);\r\n\r\n\t\t\t\t\t\tif (this.keydown.checkKeyEvents(key))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcheckKeyEvents: function(key)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar k = this.keyCode;\r\n\t\t\t\t\tvar keys = [k.BACKSPACE, k.DELETE, k.ENTER, k.ESC, k.TAB, k.CTRL, k.META, k.ALT, k.SHIFT];\r\n\r\n\t\t\t\t\treturn ($.inArray(key, keys) == -1) ? true : false;\r\n\r\n\t\t\t\t},\r\n\t\t\t\taddArrowsEvent: function(arrow)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!arrow) return;\r\n\r\n\t\t\t\t\tif ((this.core.getEvent() == 'click' || this.core.getEvent() == 'arrow'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.core.addEvent(false);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t    this.core.addEvent('arrow');\r\n\t\t\t\t},\r\n\t\t\t\tsetupBuffer: function(e, key)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.keydown.ctrl && key === 90 && !e.shiftKey && !e.altKey && this.opts.buffer.length) // z key\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tthis.buffer.undo();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// undo\r\n\t\t\t\t\telse if (this.keydown.ctrl && key === 90 && e.shiftKey && !e.altKey && this.opts.rebuffer.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tthis.buffer.redo();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (!this.keydown.ctrl)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (key == this.keyCode.BACKSPACE || key == this.keyCode.DELETE || (key == this.keyCode.ENTER && !e.ctrlKey && !e.shiftKey))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetupSelectAll: function(e, key)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.keydown.ctrl && key === 65)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.utils.enableSelectAll();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (key != this.keyCode.LEFT_WIN && !this.keydown.ctrl)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.utils.disableSelectAll();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonArrowDown: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar tags = [this.keydown.blockquote, this.keydown.pre, this.keydown.figcaption];\r\n\r\n\t\t\t\t\tfor (var i = 0; i < tags.length; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (tags[i])\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.keydown.insertAfterLastElement(tags[i]);\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonShiftEnter: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tif (this.utils.isEndOfElement())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn this.keydown.insertDblBreakLine(e);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this.keydown.insertBreakLine(e);\r\n\t\t\t\t},\r\n\t\t\t\tonTab: function(e, key)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.tabKey) return true;\r\n\t\t\t\t\tif (this.utils.isEmpty(this.code.get()) && this.opts.tabAsSpaces === false) return true;\r\n\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\tvar node;\r\n\t\t\t\t\tif (this.keydown.pre && !e.shiftKey)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnode = (this.opts.preSpaces) ? document.createTextNode(Array(this.opts.preSpaces + 1).join('\\u00a0')) : document.createTextNode('\\t');\r\n\t\t\t\t\t\tthis.insert.node(node);\r\n\t\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this.opts.tabAsSpaces !== false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnode = document.createTextNode(Array(this.opts.tabAsSpaces + 1).join('\\u00a0'));\r\n\t\t\t\t\t\tthis.insert.node(node);\r\n\t\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (e.metaKey && key === 219) this.indent.decrease();\r\n\t\t\t\t\t\telse if (e.metaKey && key === 221) this.indent.increase();\r\n\t\t\t\t\t\telse if (!e.shiftKey) this.indent.increase();\r\n\t\t\t\t\t\telse this.indent.decrease();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\treplaceDivToBreakLine: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blockElem = this.selection.getBlock();\r\n\t\t\t\t\tvar blockHtml = blockElem.innerHTML.replace(/<br\\s?\\/?>/gi, '');\r\n\t\t\t\t\tif ((blockElem.tagName === 'DIV' || blockElem.tagName === 'P') && blockHtml === '' && !$(blockElem).hasClass('redactor-editor'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar br = document.createElement('br');\r\n\r\n\t\t\t\t\t\t$(blockElem).replaceWith(br);\r\n\t\t\t\t\t\tthis.caret.setBefore(br);\r\n\r\n\t\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\treplaceDivToParagraph: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar blockElem = this.selection.getBlock();\r\n\t\t\t\t\tvar blockHtml = blockElem.innerHTML.replace(/<br\\s?\\/?>/gi, '');\r\n\t\t\t\t\tif (blockElem.tagName === 'DIV' && this.utils.isEmpty(blockHtml) && !$(blockElem).hasClass('redactor-editor'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar p = document.createElement('p');\r\n\t\t\t\t\t\tp.innerHTML = this.opts.invisibleSpace;\r\n\r\n\t\t\t\t\t\t$(blockElem).replaceWith(p);\r\n\t\t\t\t\t\tthis.caret.setStart(p);\r\n\r\n\t\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this.opts.cleanStyleOnEnter && blockElem.tagName == 'P')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(blockElem).removeAttr('class').removeAttr('style');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinsertParagraph: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tvar p = document.createElement('p');\r\n\t\t\t\t\tp.innerHTML = this.opts.invisibleSpace;\r\n\r\n\t\t\t\t\tthis.range.deleteContents();\r\n\t\t\t\t\tthis.range.insertNode(p);\r\n\r\n\t\t\t\t\tthis.caret.setStart(p);\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\texitFromBlockquote: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.utils.isEndOfElement()) return;\r\n\r\n\t\t\t\t\tvar tmp = $.trim($(this.keydown.block).html());\r\n\t\t\t\t\tif (tmp.search(/(<br\\s?\\/?>){2}$/i) != -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar br = document.createElement('br');\r\n\t\t\t\t\t\t\t$(this.keydown.blockquote).after(br);\r\n\r\n\t\t\t\t\t\t\tthis.caret.setBefore(br);\r\n\t\t\t\t\t\t\t$(this.keydown.block).html(tmp.replace(/<br\\s?\\/?>$/i, ''));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar node = $(this.opts.emptyHtml);\r\n\t\t\t\t\t\t\t$(this.keydown.blockquote).after(node);\r\n\t\t\t\t\t\t\tthis.caret.setStart(node);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tinsertAfterLastElement: function(element)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.utils.isEndOfElement()) return;\r\n\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar contents = $('<div>').append($.trim(this.$editor.html())).contents();\r\n\t\t\t\t\t\tvar last = contents.last()[0];\r\n\t\t\t\t\t\tif (last.tagName == 'SPAN' && last.innerHTML === '')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlast = contents.prev()[0];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this.utils.getOuterHtml(last) != this.utils.getOuterHtml(element)) return;\r\n\r\n\t\t\t\t\t\tvar br = document.createElement('br');\r\n\t\t\t\t\t\t$(element).after(br);\r\n\t\t\t\t\t\tthis.caret.setAfter(br);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.$editor.contents().last()[0] !== element) return;\r\n\r\n\t\t\t\t\t\tvar node = $(this.opts.emptyHtml);\r\n\t\t\t\t\t\t$(element).after(node);\r\n\t\t\t\t\t\tthis.caret.setStart(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinsertNewLine: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\tvar node = document.createTextNode('\\n');\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tthis.range.deleteContents();\r\n\t\t\t\t\tthis.range.insertNode(node);\r\n\r\n\t\t\t\t\tthis.caret.setAfter(node);\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tinsertBreakLine: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.keydown.insertBreakLineProcessing(e);\r\n\t\t\t\t},\r\n\t\t\t\tinsertDblBreakLine: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.keydown.insertBreakLineProcessing(e, true);\r\n\t\t\t\t},\r\n\t\t\t\tinsertBreakLineProcessing: function(e, dbl)\r\n\t\t\t\t{\r\n\t\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tvar br1 = document.createElement('br');\r\n\r\n\t\t\t\t\tif (this.utils.browser('msie'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.range.collapse(false);\r\n\t\t\t\t\t\tthis.range.setEnd(this.range.endContainer, this.range.endOffset);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.range.deleteContents();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.range.insertNode(br1);\r\n\r\n\t\t\t\t\t// move br outside A tag\r\n\t\t\t\t\tvar $parentA = $(br1).parent(\"a\");\r\n\r\n\t\t\t\t\tif ($parentA.length > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$parentA.find(br1).remove();\r\n\t\t\t\t\t\t$parentA.after(br1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (dbl === true)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $next = $(br1).next();\r\n\t\t\t\t\t\tif ($next.length !== 0 && $next[0].tagName === 'BR' && this.utils.isEndOfEditor())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.caret.setAfter(br1);\r\n\t\t\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar br2 = document.createElement('br');\r\n\r\n\t\t\t\t\t\tthis.range.insertNode(br2);\r\n\t\t\t\t\t\tthis.caret.setAfter(br2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// caret does not move after the br visual\r\n\t\t\t\t\t\tif (this.utils.browser('msie'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar space = document.createElement('span');\r\n\t\t\t\t\t\t\tspace.innerHTML = '&#x200b;';\r\n\r\n\t\t\t\t\t\t\t$(br1).after(space);\r\n\r\n\t\t\t\t\t\t\tthis.range.setStartAfter(space);\r\n\t\t\t\t\t\t\tthis.range.setEndAfter(space);\r\n\t\t\t\t\t\t\t$(space).remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar range = document.createRange();\r\n\t\t\t\t\t\t\trange.setStartAfter(br1);\r\n\t\t\t\t\t\t\trange.collapse(true);\r\n\t\t\t\t\t\t\tvar selection = window.getSelection();\r\n\t\t\t\t\t\t\tselection.removeAllRanges();\r\n\t\t\t\t\t\t\tselection.addRange(range);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tremoveInvisibleSpace: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $current = $(this.keydown.current);\r\n\t\t\t\t\tif ($current.text().search(/^\\u200B$/g) === 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$current.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremoveEmptyListInTable: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $current = $(this.keydown.current);\r\n\t\t\t\t\tvar $parent = $(this.keydown.parent);\r\n\t\t\t\t\tvar td = $current.closest('td', this.$editor[0]);\r\n\r\n\t\t\t\t\tif (td.length !== 0 && $current.closest('li', this.$editor[0]) && $parent.children('li').length === 1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (!this.utils.isEmpty($current.text())) return;\r\n\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$current.remove();\r\n\t\t\t\t\t\t$parent.remove();\r\n\r\n\t\t\t\t\t\tthis.caret.setStart(td);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tkeyup: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tinit: function(e)\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tif (this.rtePaste) return;\r\n\r\n\t\t\t\t\tvar key = e.which;\r\n\r\n\t\t\t\t\tthis.keyup.current = this.selection.getCurrent();\r\n\t\t\t\t\tthis.keyup.parent = this.selection.getParent();\r\n\t\t\t\t\tvar $parent = this.utils.isRedactorParent($(this.keyup.parent).parent());\r\n\r\n\t\t\t\t\t// callback\r\n\t\t\t\t\tvar keyupStop = this.core.setCallback('keyup', e);\r\n\t\t\t\t\tif (keyupStop === false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// replace to p before / after the table or body\r\n\t\t\t\t\tif (!this.opts.linebreaks && this.keyup.current.nodeType === 3 && this.keyup.current.length <= 1 && (this.keyup.parent === false || this.keyup.parent.tagName == 'BODY'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.keyup.replaceToParagraph();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// replace div after lists\r\n\t\t\t\t\tif (!this.opts.linebreaks && this.utils.isRedactorParent(this.keyup.current) && this.keyup.current.tagName === 'DIV')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.keyup.replaceToParagraph(false);\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif (!this.opts.linebreaks && $(this.keyup.parent).hasClass('redactor-invisible-space') && ($parent === false || $parent[0].tagName == 'BODY'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this.keyup.parent).contents().unwrap();\r\n\t\t\t\t\t\tthis.keyup.replaceToParagraph();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// linkify\r\n\t\t\t\t\tif (this.linkify.isEnabled() && this.linkify.isKey(key)) this.linkify.format();\r\n\r\n\t\t\t\t\tif (key === this.keyCode.DELETE || key === this.keyCode.BACKSPACE)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.utils.browser('mozilla'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar td = $(this.keydown.current).closest('td', this.$editor[0]);\r\n\t\t\t\t\t\t\tif (td.size() !== 0 && td.text() !== '')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// clear unverified\r\n\t\t\t\t\t\tthis.clean.clearUnverified();\r\n\r\n\t\t\t\t\t\tif (this.observe.image)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t\tthis.image.hideResize();\r\n\r\n\t\t\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\t\t\tthis.image.remove(this.observe.image);\r\n\t\t\t\t\t\t\tthis.observe.image = false;\r\n\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// remove empty paragraphs\r\n\t\t\t\t\t\tthis.$editor.find('p').each($.proxy(function(i, s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.utils.removeEmpty(i, $(s).html());\r\n\t\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t\t// remove invisible space\r\n\t\t\t\t\t\tif (this.opts.linebreaks && this.keyup.current && this.keyup.current.tagName == 'DIV' && this.utils.isEmpty(this.keyup.current.innerHTML))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this.keyup.current).after(this.selection.getMarkerAsHtml());\r\n\t\t\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\t\t\t$(this.keyup.current).remove();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.keyup.removeEmptyLists();\r\n\r\n\t\t\t\t\t\t// if empty\r\n\t\t\t\t\t\treturn this.keyup.formatEmpty(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\treplaceToParagraph: function(clone)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $current = $(this.keyup.current);\r\n\r\n\t\t\t\t\tvar node;\r\n\t\t\t\t\tif (clone === false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnode = $('<p>').append($current.html());\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnode = $('<p>').append($current.clone());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$current.replaceWith(node);\r\n\t\t\t\t\tvar next = $(node).next();\r\n\t\t\t\t\tif (typeof(next[0]) !== 'undefined' && next[0].tagName == 'BR')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnext.remove();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.caret.setEnd(node);\r\n\t\t\t\t},\r\n\t\t\t\tremoveEmptyLists: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar removeIt = function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar html = $.trim(this.innerHTML).replace(/\\/t\\/n/g, '');\r\n\t\t\t\t\t\tif (html === '')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tthis.$editor.find('li').each(removeIt);\r\n\t\t\t\t\tthis.$editor.find('ul, ol').each(removeIt);\r\n\t\t\t\t},\r\n\t\t\t\tformatEmpty: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar html = $.trim(this.$editor.html());\r\n\r\n\t\t\t\t\tif (!this.utils.isEmpty(html)) return;\r\n\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.html(this.selection.getMarkerAsHtml());\r\n\t\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.html(this.opts.emptyHtml);\r\n\t\t\t\t\t\tthis.focus.setStart();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tlang: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tload: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.opts.curLang = this.opts.langs[this.opts.lang];\r\n\t\t\t\t},\r\n\t\t\t\tget: function(name)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn (typeof this.opts.curLang[name] != 'undefined') ? this.opts.curLang[name] : '';\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tline: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tinsert: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n \t\t\t\t\tif (blocks[0] !== false && this.line.isExceptLastOrFirst(blocks))\r\n\t \t\t\t\t{\r\n\t \t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\r\n\t \t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.utils.browser('msie'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.line.insertInIe();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.line.insertInOthersBrowsers();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tisExceptLastOrFirst: function(blocks)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar exceptTags = ['li', 'td', 'th', 'blockquote', 'figcaption', 'pre', 'dl', 'dt', 'dd'];\r\n\r\n\t\t\t\t\tvar first = blocks[0].tagName.toLowerCase();\r\n\t\t\t\t\tvar last = this.selection.getLastBlock();\r\n\r\n\t\t\t\t\tlast = (typeof last == 'undefined') ? first : last.tagName.toLowerCase();\r\n\r\n\t\t\t\t\tvar firstFound = $.inArray(first, exceptTags) != -1;\r\n\t\t\t\t\tvar lastFound = $.inArray(last, exceptTags) != -1;\r\n\r\n\t\t\t\t\tif ((firstFound && lastFound) || firstFound)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinsertInIe: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.utils.saveScroll();\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tthis.insert.node(document.createElement('hr'));\r\n\r\n\t\t\t\t\tthis.utils.restoreScroll();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tinsertInOthersBrowsers: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tvar extra = '<p id=\"redactor-insert-line\"><br /></p>';\r\n\t\t\t\t\tif (this.opts.linebreaks) extra = '<br id=\"redactor-insert-line\">';\r\n\r\n\t\t\t\t\tdocument.execCommand('insertHtml', false, '<hr>' + extra);\r\n\r\n\t\t\t\t\tthis.line.setFocus();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tsetFocus: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar node = this.$editor.find('#redactor-insert-line');\r\n\t\t\t\t\tvar next = $(node).next()[0];\r\n\t\t\t\t\tvar target = next;\r\n\t\t\t\t\tif (this.utils.browser('mozilla') && next && next.innerHTML === '')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttarget = $(next).next()[0];\r\n\t\t\t\t\t\t$(next).remove();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (target)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnode.remove();\r\n\r\n\t\t\t\t\t\tif (!this.opts.linebreaks)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.$editor.focus();\r\n\t\t\t\t\t\t\tthis.line.setStart(target);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\tnode.removeAttr('id');\r\n\t\t\t\t\t\tthis.line.setStart(node[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetStart: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof node === 'undefined') return;\r\n\r\n\t\t\t\t\tvar textNode = document.createTextNode('\\u200B');\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\tthis.range.setStart(node, 0);\r\n\t\t\t\t\tthis.range.insertNode(textNode);\r\n\t\t\t\t\tthis.range.collapse(true);\r\n\t\t\t\t\tthis.selection.addRange();\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tlink: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tshow: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof e != 'undefined' && e.preventDefault) e.preventDefault();\r\n\r\n\t\t\t\t\tif (!this.observe.isCurrent('a'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.load('link', this.lang.get('link_insert'), 600);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.load('link', this.lang.get('link_edit'), 600);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.modal.createCancelButton();\r\n\r\n\t\t\t\t\tvar buttonText = !this.observe.isCurrent('a') ? this.lang.get('insert') : this.lang.get('edit');\r\n\r\n\t\t\t\t\tthis.link.buttonInsert = this.modal.createActionButton(buttonText);\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tthis.link.getData();\r\n\t\t\t\t\tthis.link.cleanUrl();\r\n\r\n\t\t\t\t\tif (this.link.target == '_blank') $('#redactor-link-blank').prop('checked', true);\r\n\r\n\t\t\t\t\tthis.link.$inputUrl = $('#redactor-link-url');\r\n\t\t\t\t\tthis.link.$inputText = $('#redactor-link-url-text');\r\n\r\n\t\t\t\t\tthis.link.$inputText.val(this.link.text);\r\n\t\t\t\t\tthis.link.$inputUrl.val(this.link.url);\r\n\r\n\t\t\t\t\tthis.link.buttonInsert.on('click', $.proxy(this.link.insert, this));\r\n\r\n\t\t\t\t\t// hide link's tooltip\r\n\t\t\t\t\t$('.redactor-link-tooltip').remove();\r\n\r\n\t\t\t\t\t// show modal\r\n\t\t\t\t\tthis.selection.save();\r\n\t\t\t\t\tthis.modal.show();\r\n\t\t\t\t\tthis.link.$inputUrl.focus();\r\n\t\t\t\t},\r\n\t\t\t\tcleanUrl: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar thref = self.location.href.replace(/\\/$/i, '');\r\n\r\n\t\t\t\t\tif (typeof this.link.url !== \"undefined\")\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.link.url = this.link.url.replace(thref, '');\r\n\t\t\t\t\t\tthis.link.url = this.link.url.replace(/^\\/#/, '#');\r\n\t\t\t\t\t\tthis.link.url = this.link.url.replace('mailto:', '');\r\n\r\n\t\t\t\t\t\t// remove host from href\r\n\t\t\t\t\t\tif (!this.opts.linkProtocol)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar re = new RegExp('^(http|ftp|https)://' + self.location.host, 'i');\r\n\t\t\t\t\t\t\tthis.link.url = this.link.url.replace(re, '');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgetData: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.link.$node = false;\r\n\r\n\t\t\t\t\tvar $el = $(this.selection.getCurrent()).closest('a', this.$editor[0]);\r\n\t\t\t\t\tif ($el.length !== 0 && $el[0].tagName === 'A')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.link.$node = $el;\r\n\r\n\t\t\t\t\t\tthis.link.url = $el.attr('href');\r\n\t\t\t\t\t\tthis.link.text = $el.text();\r\n\t\t\t\t\t\tthis.link.target = $el.attr('target');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.link.text = this.sel.toString();\r\n\t\t\t\t\t\tthis.link.url = '';\r\n\t\t\t\t\t\tthis.link.target = '';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tinsert: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.placeholder.remove();\r\n\r\n\t\t\t\t\tvar target = '';\r\n\t\t\t\t\tvar link = this.link.$inputUrl.val();\r\n\t\t\t\t\tvar text = this.link.$inputText.val().replace(/(<([^>]+)>)/ig,\"\");\r\n\r\n\t\t\t\t\tif ($.trim(link) === '')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.link.$inputUrl.addClass('redactor-input-error').on('keyup', function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).removeClass('redactor-input-error');\r\n\t\t\t\t\t\t\t$(this).off('keyup');\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// mailto\r\n\t\t\t\t\tif (link.search('@') != -1 && /(http|ftp|https):\\/\\//i.test(link) === false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlink = link.replace('mailto:', '');\r\n\t\t\t\t\t\tlink = 'mailto:' + link;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// url, not anchor\r\n\t\t\t\t\telse if (link.search('#') !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($('#redactor-link-blank').prop('checked'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttarget = '_blank';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// test url (add protocol)\r\n\t\t\t\t\t\tvar pattern = '((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\\\.)+[a-z]{2,}';\r\n\t\t\t\t\t\tvar re = new RegExp('^(http|ftp|https)://' + pattern, 'i');\r\n\t\t\t\t\t\tvar re2 = new RegExp('^' + pattern, 'i');\r\n\t\t\t\t\t\tvar re3 = new RegExp('\\.(html|php)$', 'i');\r\n\t\t\t\t\t\tif (link.search(re) == -1 && link.search(re3) == -1 && link.search(re2) === 0 && this.opts.linkProtocol)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlink = this.opts.linkProtocol + '://' + link;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.link.set(text, link, target);\r\n\t\t\t\t\tthis.modal.close();\r\n\t\t\t\t},\r\n\t\t\t\tset: function(text, link, target)\r\n\t\t\t\t{\r\n\t\t\t\t\ttext = $.trim(text.replace(/<|>/g, ''));\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\r\n\r\n\t\t\t\t\tif (text === '' && link === '') return;\r\n\t\t\t\t\tif (text === '' && link !== '') text = link;\r\n\r\n\t\t\t\t\tif (this.link.$node)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\t\tvar $link = this.link.$node,\r\n\t\t\t\t\t\t\t$el   = $link.children();\r\n\r\n\t\t\t\t\t\tif ($el.length > 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\twhile ($el.length)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$el = $el.children();\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$el = $el.end();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$el = $link;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$link.attr('href', link);\r\n\t\t\t\t\t\t$el.text(text);\r\n\r\n\t\t\t\t\t\tif (target !== '')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$link.attr('target', target);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$link.removeAttr('target');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.selection.selectElement($link);\r\n\r\n\t\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.utils.browser('mozilla') && this.link.text === '')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $a = $('<a />').attr('href', link).text(text);\r\n\t\t\t\t\t\t\tif (target !== '') $a.attr('target', target);\r\n\r\n\t\t\t\t\t\t\t$a = $(this.insert.node($a));\r\n\r\n\t\t\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$a.after('&nbsp;');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis.selection.selectElement($a);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $a;\r\n\t\t\t\t\t\t\tif (this.utils.browser('msie'))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$a = $('<a href=\"' + link + '\">').text(text);\r\n\t\t\t\t\t\t\t\tif (target !== '') $a.attr('target', target);\r\n\r\n\t\t\t\t\t\t\t\t$a = $(this.insert.node($a));\r\n\r\n\t\t\t\t\t\t\t\tif (this.selection.getText().match(/\\s$/))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$a.after(\" \");\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tthis.selection.selectElement($a);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tdocument.execCommand('createLink', false, link);\r\n\r\n\t\t\t\t\t\t\t\t$a = $(this.selection.getCurrent()).closest('a', this.$editor[0]);\r\n\t\t\t\t\t\t\t\tif (this.utils.browser('mozilla'))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$a = $('a[_moz_dirty=\"\"]');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (target !== '') $a.attr('target', target);\r\n\t\t\t\t\t\t\t\t$a.removeAttr('style').removeAttr('_moz_dirty');\r\n\r\n\t\t\t\t\t\t\t\tif (this.selection.getText().match(/\\s$/))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$a.after(\" \");\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (this.link.text !== '' || this.link.text != text)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif (!this.opts.linebreaks && blocks && blocks.length <= 1)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t$a.text(text);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse if (this.opts.linebreaks)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t$a.text(text);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tthis.selection.selectElement($a);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t\t\tthis.core.setCallback('insertedLink', $a);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// link tooltip\r\n\t\t\t\t\tsetTimeout($.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.observe.links();\r\n\r\n\t\t\t\t\t}, this), 5);\r\n\t\t\t\t},\r\n\t\t\t\tunlink: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof e != 'undefined' && e.preventDefault)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar nodes = this.selection.getNodes();\r\n\t\t\t\t\tif (!nodes) return;\r\n\r\n\t\t\t\t\tthis.buffer.set();\r\n\r\n\t\t\t\t\tvar len = nodes.length;\r\n\t\t\t\t\tvar links = [];\r\n\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (nodes[i].tagName === 'A')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlinks.push(nodes[i]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar $node = $(nodes[i]).closest('a', this.$editor[0]);\r\n\t\t\t\t\t\t$node.replaceWith($node.contents());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.core.setCallback('deletedLink', links);\r\n\r\n\t\t\t\t\t// hide link's tooltip\r\n\t\t\t\t\t$('.redactor-link-tooltip').remove();\r\n\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t},\r\n\t\t\t\ttoggleClass: function(className)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.link.setClass(className, 'toggleClass');\r\n\t\t\t\t},\r\n\t\t\t\taddClass: function(className)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.link.setClass(className, 'addClass');\r\n\t\t\t\t},\r\n\t\t\t\tremoveClass: function(className)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.link.setClass(className, 'removeClass');\r\n\t\t\t\t},\r\n\t\t\t\tsetClass: function(className, func)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar links = this.selection.getInlinesTags(['a']);\r\n\t\t\t\t\tif (links === false) return;\r\n\r\n\t\t\t\t\t$.each(links, function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this)[func](className);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tlinkify: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tisKey: function(key)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn key == this.keyCode.ENTER || key == this.keyCode.SPACE;\r\n\t\t\t\t},\r\n\t\t\t\tisEnabled: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.opts.convertLinks && (this.opts.convertUrlLinks || this.opts.convertImageLinks || this.opts.convertVideoLinks) && !this.utils.isCurrentOrParent('PRE');\r\n\t\t\t\t},\r\n\t\t\t\tformat: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar linkify = this.linkify,\r\n\t\t\t\t\t\topts    = this.opts;\r\n\r\n\t\t\t\t\tthis.$editor\r\n\t\t\t\t\t\t.find(\":not(iframe,img,a,pre)\")\r\n\t\t\t\t\t\t.addBack()\r\n\t\t\t\t\t\t.contents()\r\n\t\t\t\t\t\t.filter(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn this.nodeType === 3 && $.trim(this.nodeValue) != \"\" && !$(this).parent().is(\"pre\") && (this.nodeValue.match(opts.linkify.regexps.youtube) || this.nodeValue.match(opts.linkify.regexps.vimeo) || this.nodeValue.match(opts.linkify.regexps.image) || this.nodeValue.match(opts.linkify.regexps.url));\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.each(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar text = $(this).text(),\r\n\t\t\t\t\t\t\t\thtml = text;\r\n\r\n\t\t\t\t\t\t\tif (opts.convertVideoLinks && (html.match(opts.linkify.regexps.youtube) || html.match(opts.linkify.regexps.vimeo)) )\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\thtml = linkify.convertVideoLinks(html);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (opts.convertImageLinks && html.match(opts.linkify.regexps.image))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\thtml = linkify.convertImages(html);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (opts.convertUrlLinks)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\thtml = linkify.convertLinks(html);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$(this).before(text.replace(text, html))\r\n\t\t\t\t\t\t\t\t   .remove();\r\n\t\t\t\t\t\t});\r\n\r\n\r\n\t\t\t\t\tvar objects = this.$editor.find('.redactor-linkify-object').each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $el = $(this);\r\n\t\t\t\t\t\t$el.removeClass('redactor-linkify-object');\r\n\t\t\t\t\t\tif ($el.attr('class') === '') $el.removeAttr('class');\r\n\r\n\t\t\t\t\t\treturn $el[0];\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// callback\r\n\t\t\t\t\tsetTimeout($.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.observe.load();\r\n\t\t\t\t\t\tthis.core.setCallback('linkify', objects);\r\n\t\t\t\t\t}, this), 100);\r\n\r\n\t\t\t\t\t// sync\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t},\r\n\t\t\t\tconvertVideoLinks: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar iframeStart = '<iframe class=\"redactor-linkify-object\" width=\"500\" height=\"281\" src=\"',\r\n\t\t\t\t\t\tiframeEnd = '\" frameborder=\"0\" allowfullscreen></iframe>';\r\n\r\n\t\t\t\t\tif (html.match(this.opts.linkify.regexps.youtube))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(this.opts.linkify.regexps.youtube, iframeStart + '//www.youtube.com/embed/$1' + iframeEnd);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (html.match(this.opts.linkify.regexps.vimeo))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(this.opts.linkify.regexps.vimeo, iframeStart + '//player.vimeo.com/video/$2' + iframeEnd);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tconvertImages: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar matches = html.match(this.opts.linkify.regexps.image);\r\n\r\n\t\t\t\t\tif (matches)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(html, '<img src=\"' + matches + '\" class=\"redactor-linkify-object\" />');\r\n\r\n\t\t\t\t\t\tif (this.opts.linebreaks)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (!this.utils.isEmpty(this.code.get()))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\thtml = '<br>' + html;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\thtml += '<br>';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tconvertLinks: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar matches = html.match(this.opts.linkify.regexps.url);\r\n\r\n\t\t\t\t\tif (matches)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmatches = $.grep(matches, function(v, k) { return $.inArray(v, matches) === k; });\r\n\r\n\t\t\t\t\t\tvar length = matches.length;\r\n\r\n\t\t\t\t\t\tfor (var i = 0; i < length; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar href = matches[i],\r\n\t\t\t\t\t\t\t\ttext = href,\r\n\t\t\t\t\t\t\t\tlinkProtocol = this.opts.linkProtocol + '://';\r\n\r\n\t\t\t\t\t\t\tif (href.match(/(https?|ftp):\\/\\//i) !== null)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlinkProtocol = \"\";\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (text.length > this.opts.linkSize)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttext = text.substring(0, this.opts.linkSize) + '...';\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (text.search('%') === -1)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttext = decodeURIComponent(text);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar regexB = \"\\\\b\";\r\n\r\n\t\t\t\t\t\t\tif ($.inArray(href.slice(-1), [\"/\", \"&\", \"=\"]) != -1)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tregexB = \"\";\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// escaping url\r\n\t\t\t\t\t\t\tvar regexp = new RegExp('(' + href.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\") + regexB + ')', 'g');\r\n\r\n\t\t\t\t\t\t\thtml = html.replace(regexp, '<a href=\"' + linkProtocol + $.trim(href) + '\" class=\"redactor-linkify-object\">' + $.trim(text) + '</a>');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tlist: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\ttoggle: function(cmd)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.placeholder.remove();\r\n\r\n\t\t\t\t\tif (!this.utils.browser('msie') && !this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.focus();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\tthis.selection.save();\r\n\r\n\t\t\t\t\tvar parent = this.selection.getParent();\r\n\t\t\t\t\tvar $list = $(parent).closest('ol, ul', this.$editor[0]);\r\n\r\n\t\t\t\t\tif (!this.utils.isRedactorParent($list) && $list.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$list = false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar isUnorderedCmdOrdered, isOrderedCmdUnordered;\r\n\t\t\t\t\tvar remove = false;\r\n\t\t\t\t\tif ($list && $list.length)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tremove = true;\r\n\t\t\t\t\t\tvar listTag = $list[0].tagName;\r\n\r\n\t\t\t\t\t\tisUnorderedCmdOrdered = (cmd === 'orderedlist' && listTag === 'UL');\r\n\t\t\t\t\t\tisOrderedCmdUnordered = (cmd === 'unorderedlist' && listTag === 'OL');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (isUnorderedCmdOrdered)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.utils.replaceToTag($list, 'ol');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (isOrderedCmdUnordered)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.utils.replaceToTag($list, 'ul');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (remove)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.list.remove(cmd, $list);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.list.insert(cmd);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\r\n\t\t\t\t},\r\n\t\t\t\tinsert: function(cmd)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar current = this.selection.getCurrent();\r\n\t\t\t\t\tvar $td = $(current).closest('td, th', this.$editor[0]);\r\n\r\n\t\t\t\t\tif (this.utils.browser('msie') && this.opts.linebreaks)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.list.insertInIe(cmd);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdocument.execCommand('insert' + cmd);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar parent = this.selection.getParent();\r\n\t\t\t\t\tvar $list = $(parent).closest('ol, ul', this.$editor[0]);\r\n\t\t\t\t\tif ($td.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar newTd = $td.clone();\r\n\t\t\t\t\t\t$td.after(newTd).remove('');\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif (this.utils.isEmpty($list.find('li').text()))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $children = $list.children('li');\r\n\t\t\t\t\t\t$children.find('br').remove();\r\n\t\t\t\t\t\t$children.append(this.selection.getMarkerAsHtml());\r\n\r\n\t\t\t\t\t\tif (this.opts.linebreaks && this.utils.browser('mozilla') && $children.size() == 2 && this.utils.isEmpty($children.eq(1).text()))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$children.eq(1).remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ($list.length)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// remove block-element list wrapper\r\n\t\t\t\t\t\tvar $listParent = $list.parent();\r\n\t\t\t\t\t\tif (this.utils.isRedactorParent($listParent) && $listParent[0].tagName != 'LI' && this.utils.isBlock($listParent[0]))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$listParent.replaceWith($listParent.contents());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!this.utils.browser('msie'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.focus();\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tthis.clean.clearUnverified();\r\n\t\t\t\t},\r\n\t\t\t\tinsertInIe: function(cmd)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar wrapper = this.selection.wrap('div');\r\n\t\t\t\t\tvar wrapperHtml = $(wrapper).html();\r\n\r\n\t\t\t\t\tvar tmpList = (cmd == 'orderedlist') ? $('<ol>') : $('<ul>');\r\n\t\t\t\t\tvar tmpLi = $('<li>');\r\n\r\n\t\t\t\t\tif ($.trim(wrapperHtml) === '')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttmpLi.append(this.selection.getMarkerAsHtml());\r\n\t\t\t\t\t\ttmpList.append(tmpLi);\r\n\t\t\t\t\t\tthis.$editor.find('#selection-marker-1').replaceWith(tmpList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar items = wrapperHtml.split(/<br\\s?\\/?>/gi);\r\n\t\t\t\t\t\tif (items)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tfor (var i = 0; i < items.length; i++)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif ($.trim(items[i]) !== '')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttmpList.append($('<li>').html(items[i]));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttmpLi.append(wrapperHtml);\r\n\t\t\t\t\t\t\ttmpList.append(tmpLi);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(wrapper).replaceWith(tmpList);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremove: function(cmd, $list)\r\n\t\t\t\t{\r\n\t\t\t\t\tif ($.inArray('ul', this.selection.getBlocks())) cmd = 'unorderedlist';\r\n\r\n\t\t\t\t\tdocument.execCommand('insert' + cmd);\r\n\r\n\t\t\t\t\tvar $current = $(this.selection.getCurrent());\r\n\t\t\t\t\tthis.indent.fixEmptyIndent();\r\n\r\n\t\t\t\t\tif (!this.opts.linebreaks && $current.closest('li, th, td', this.$editor[0]).length === 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdocument.execCommand('formatblock', false, 'p');\r\n\t\t\t\t\t\tthis.$editor.find('ul, ol, blockquote').each($.proxy(this.utils.removeEmpty, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar $table = $(this.selection.getCurrent()).closest('table', this.$editor[0]);\r\n\t\t\t\t\tvar $prev = $table.prev();\r\n\t\t\t\t\tif (!this.opts.linebreaks && $table.length !== 0 && $prev.length !== 0 && $prev[0].tagName == 'BR')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$prev.remove();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.clean.clearUnverified();\r\n\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tmodal: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tcallbacks: {},\r\n\t\t\t\tloadTemplates: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.opts.modal = {\r\n\t\t\t\t\t\timageEdit: String()\r\n\t\t\t\t\t\t+ '<section id=\"redactor-modal-image-edit\">'\r\n\t\t\t\t\t\t\t+ '<label>' + this.lang.get('title') + '</label>'\r\n\t\t\t\t\t\t\t+ '<input type=\"text\" id=\"redactor-image-title\" />'\r\n\t\t\t\t\t\t\t+ '<label class=\"redactor-image-link-option\">' + this.lang.get('link') + '</label>'\r\n\t\t\t\t\t\t\t+ '<input type=\"text\" id=\"redactor-image-link\" class=\"redactor-image-link-option\" aria-label=\"' + this.lang.get('link') + '\" />'\r\n\t\t\t\t\t\t\t+ '<label class=\"redactor-image-link-option\"><input type=\"checkbox\" id=\"redactor-image-link-blank\" aria-label=\"' + this.lang.get('link_new_tab') + '\"> ' + this.lang.get('link_new_tab') + '</label>'\r\n\t\t\t\t\t\t\t+ '<label class=\"redactor-image-position-option\">' + this.lang.get('image_position') + '</label>'\r\n\t\t\t\t\t\t\t+ '<select class=\"redactor-image-position-option\" id=\"redactor-image-align\" aria-label=\"' + this.lang.get('image_position') + '\">'\r\n\t\t\t\t\t\t\t\t+ '<option value=\"none\">' + this.lang.get('none') + '</option>'\r\n\t\t\t\t\t\t\t\t+ '<option value=\"left\">' + this.lang.get('left') + '</option>'\r\n\t\t\t\t\t\t\t\t+ '<option value=\"center\">' + this.lang.get('center') + '</option>'\r\n\t\t\t\t\t\t\t\t+ '<option value=\"right\">' + this.lang.get('right') + '</option>'\r\n\t\t\t\t\t\t\t+ '</select>'\r\n\t\t\t\t\t\t+ '</section>',\r\n\r\n\t\t\t\t\t\timage: String()\r\n\t\t\t\t\t\t+ '<section id=\"redactor-modal-image-insert\">'\r\n\t\t\t\t\t\t\t+ '<div id=\"redactor-modal-image-droparea\"></div>'\r\n \t\t\t\t\t\t+ '</section>',\r\n\r\n\t\t\t\t\t\tfile: String()\r\n\t\t\t\t\t\t+ '<section id=\"redactor-modal-file-insert\">'\r\n\t\t\t\t\t\t\t+ '<div id=\"redactor-modal-file-upload-box\">'\r\n\t\t\t\t\t\t\t\t+ '<label>' + this.lang.get('filename') + '</label>'\r\n\t\t\t\t\t\t\t\t+ '<input type=\"text\" id=\"redactor-filename\" aria-label=\"' + this.lang.get('filename') + '\" /><br><br>'\r\n\t\t\t\t\t\t\t\t+ '<div id=\"redactor-modal-file-upload\"></div>'\r\n\t\t\t\t\t\t\t+ '</div>'\r\n\t\t\t\t\t\t+ '</section>',\r\n\r\n\t\t\t\t\t\tlink: String()\r\n\t\t\t\t\t\t+ '<section id=\"redactor-modal-link-insert\">'\r\n\t\t\t\t\t\t\t+ '<label>URL</label>'\r\n\t\t\t\t\t\t\t+ '<input type=\"url\" id=\"redactor-link-url\" aria-label=\"URL\" />'\r\n\t\t\t\t\t\t\t+ '<label>' + this.lang.get('text') + '</label>'\r\n\t\t\t\t\t\t\t+ '<input type=\"text\" id=\"redactor-link-url-text\" aria-label=\"' + this.lang.get('text') + '\" />'\r\n\t\t\t\t\t\t\t+ '<label><input type=\"checkbox\" id=\"redactor-link-blank\"> ' + this.lang.get('link_new_tab') + '</label>'\r\n\t\t\t\t\t\t+ '</section>'\r\n\t\t\t\t\t};\r\n\r\n\r\n\t\t\t\t\t$.extend(this.opts, this.opts.modal);\r\n\r\n\t\t\t\t},\r\n\t\t\t\taddCallback: function(name, callback)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.modal.callbacks[name] = callback;\r\n\t\t\t\t},\r\n\t\t\t\tcreateTabber: function($modal)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.modal.$tabber = $('<div>').attr('id', 'redactor-modal-tabber');\r\n\r\n\t\t\t\t\t$modal.prepend(this.modal.$tabber);\r\n\t\t\t\t},\r\n\t\t\t\taddTab: function(id, name, active)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $tab = $('<a href=\"#\" rel=\"tab' + id + '\">').text(name);\r\n\t\t\t\t\tif (active)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$tab.addClass('active');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar self = this;\r\n\t\t\t\t\t$tab.on('click', function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t$('.redactor-tab').hide();\r\n\t\t\t\t\t\t$('.redactor-' + $(this).attr('rel')).show();\r\n\r\n\t\t\t\t\t\tself.modal.$tabber.find('a').removeClass('active');\r\n\t\t\t\t\t\t$(this).addClass('active');\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis.modal.$tabber.append($tab);\r\n\t\t\t\t},\r\n\t\t\t\taddTemplate: function(name, template)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.opts.modal[name] = template;\r\n\t\t\t\t},\r\n\t\t\t\tgetTemplate: function(name)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.opts.modal[name];\r\n\t\t\t\t},\r\n\t\t\t\tgetModal: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.$modalBody.find('section');\r\n\t\t\t\t},\r\n\t\t\t\tload: function(templateName, title, width)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.modal.templateName = templateName;\r\n\t\t\t\t\tthis.modal.width = width;\r\n\r\n\t\t\t\t\tthis.modal.build();\r\n\t\t\t\t\tthis.modal.enableEvents();\r\n\t\t\t\t\tthis.modal.setTitle(title);\r\n\t\t\t\t\tthis.modal.setDraggable();\r\n\t\t\t\t\tthis.modal.setContent();\r\n\r\n\t\t\t\t\t// callbacks\r\n\t\t\t\t\tif (typeof this.modal.callbacks[templateName] != 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.callbacks[templateName].call(this);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tshow: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.utils.disableBodyScroll();\r\n\r\n\t\t\t\t\tif (this.utils.isMobile())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.showOnMobile();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.showOnDesktop();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.opts.highContrast)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$modalBox.addClass(\"redactor-modal-contrast\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$modalOverlay.show();\r\n\t\t\t\t\tthis.$modalBox.show();\r\n\r\n\t\t\t\t\tthis.$modal.attr('tabindex', '-1');\r\n\t\t\t\t\tthis.$modal.focus();\r\n\r\n\t\t\t\t\tthis.modal.setButtonsWidth();\r\n\r\n\t\t\t\t\tthis.utils.saveScroll();\r\n\r\n\t\t\t\t\t// resize\r\n\t\t\t\t\tif (!this.utils.isMobile())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsetTimeout($.proxy(this.modal.showOnDesktop, this), 0);\r\n\t\t\t\t\t\t$(window).on('resize.redactor-modal', $.proxy(this.modal.resize, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// modal shown callback\r\n\t\t\t\t\tthis.core.setCallback('modalOpened', this.modal.templateName, this.$modal);\r\n\r\n\t\t\t\t\t// fix bootstrap modal focus\r\n\t\t\t\t\t$(document).off('focusin.modal');\r\n\r\n\t\t\t\t\t// enter\r\n\t\t\t\t\tthis.$modal.find('input[type=text],input[type=url],input[type=email]').on('keydown.redactor-modal', $.proxy(this.modal.setEnter, this));\r\n\t\t\t\t},\r\n\t\t\t\tshowOnDesktop: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar height = this.$modal.outerHeight();\r\n\t\t\t\t\tvar windowHeight = $(window).height();\r\n\t\t\t\t\tvar windowWidth = $(window).width();\r\n\r\n\t\t\t\t\tif (this.modal.width > windowWidth)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$modal.css({\r\n\t\t\t\t\t\t\twidth: '96%',\r\n\t\t\t\t\t\t\tmarginTop: (windowHeight/2 - height/2) + 'px'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (height > windowHeight)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$modal.css({\r\n\t\t\t\t\t\t\twidth: this.modal.width + 'px',\r\n\t\t\t\t\t\t\tmarginTop: '20px'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$modal.css({\r\n\t\t\t\t\t\t\twidth: this.modal.width + 'px',\r\n\t\t\t\t\t\t\tmarginTop: (windowHeight/2 - height/2) + 'px'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tshowOnMobile: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$modal.css({\r\n\t\t\t\t\t\twidth: '96%',\r\n\t\t\t\t\t\tmarginTop: '2%'\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t},\r\n\t\t\t\tresize: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.utils.isMobile())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.showOnMobile();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.modal.showOnDesktop();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetTitle: function(title)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$modalHeader.html(title);\r\n\t\t\t\t},\r\n\t\t\t\tsetContent: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$modalBody.html(this.modal.getTemplate(this.modal.templateName));\r\n\t\t\t\t},\r\n\t\t\t\tsetDraggable: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof $.fn.draggable === 'undefined') return;\r\n\r\n\t\t\t\t\tthis.$modal.draggable({ handle: this.$modalHeader });\r\n\t\t\t\t\tthis.$modalHeader.css('cursor', 'move');\r\n\t\t\t\t},\r\n\t\t\t\tsetEnter: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (e.which != 13) return;\r\n\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tthis.$modal.find('button.redactor-modal-action-btn').click();\r\n\t\t\t\t},\r\n\t\t\t\tcreateCancelButton: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar button = $('<button>').addClass('redactor-modal-btn redactor-modal-close-btn').html(this.lang.get('cancel'));\r\n\t\t\t\t\tbutton.on('click', $.proxy(this.modal.close, this));\r\n\r\n\t\t\t\t\tthis.$modalFooter.append(button);\r\n\t\t\t\t},\r\n\t\t\t\tcreateDeleteButton: function(label)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.modal.createButton(label, 'delete');\r\n\t\t\t\t},\r\n\t\t\t\tcreateActionButton: function(label)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.modal.createButton(label, 'action');\r\n\t\t\t\t},\r\n\t\t\t\tcreateButton: function(label, className)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar button = $('<button>').addClass('redactor-modal-btn').addClass('redactor-modal-' + className + '-btn').html(label);\r\n\t\t\t\t\tthis.$modalFooter.append(button);\r\n\r\n\t\t\t\t\treturn button;\r\n\t\t\t\t},\r\n\t\t\t\tsetButtonsWidth: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar buttons = this.$modalFooter.find('button');\r\n\t\t\t\t\tvar buttonsSize = buttons.length;\r\n\t\t\t\t\tif (buttonsSize === 0) return;\r\n\r\n\t\t\t\t\tbuttons.css('width', (100/buttonsSize) + '%');\r\n\t\t\t\t},\r\n\t\t\t\tbuild: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.modal.buildOverlay();\r\n\r\n\t\t\t\t\tthis.$modalBox = $('<div id=\"redactor-modal-box\"/>').hide();\r\n\t\t\t\t\tthis.$modal = $('<div id=\"redactor-modal\" role=\"dialog\" aria-labelledby=\"redactor-modal-header\" />');\r\n\t\t\t\t\tthis.$modalHeader = $('<header id=\"redactor-modal-header\"/>');\r\n\t\t\t\t\tthis.$modalClose = $('<button type=\"button\" id=\"redactor-modal-close\" tabindex=\"1\" aria-label=\"Close\" />').html('&times;');\r\n\t\t\t\t\tthis.$modalBody = $('<div id=\"redactor-modal-body\" />');\r\n\t\t\t\t\tthis.$modalFooter = $('<footer />');\r\n\r\n\t\t\t\t\tthis.$modal.append(this.$modalHeader);\r\n\t\t\t\t\tthis.$modal.append(this.$modalClose);\r\n\t\t\t\t\tthis.$modal.append(this.$modalBody);\r\n\t\t\t\t\tthis.$modal.append(this.$modalFooter);\r\n\t\t\t\t\tthis.$modalBox.append(this.$modal);\r\n\t\t\t\t\tthis.$modalBox.appendTo(document.body);\r\n\t\t\t\t},\r\n\t\t\t\tbuildOverlay: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$modalOverlay = $('<div id=\"redactor-modal-overlay\">').hide();\r\n\t\t\t\t\t$('body').prepend(this.$modalOverlay);\r\n\t\t\t\t},\r\n\t\t\t\tenableEvents: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$modalClose.on('click.redactor-modal', $.proxy(this.modal.close, this));\r\n\t\t\t\t\t$(document).on('keyup.redactor-modal', $.proxy(this.modal.closeHandler, this));\r\n\t\t\t\t\tthis.$editor.on('keyup.redactor-modal', $.proxy(this.modal.closeHandler, this));\r\n\t\t\t\t\tthis.$modalBox.on('click.redactor-modal', $.proxy(this.modal.close, this));\r\n\t\t\t\t},\r\n\t\t\t\tdisableEvents: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$modalClose.off('click.redactor-modal');\r\n\t\t\t\t\t$(document).off('keyup.redactor-modal');\r\n\t\t\t\t\tthis.$editor.off('keyup.redactor-modal');\r\n\t\t\t\t\tthis.$modalBox.off('click.redactor-modal');\r\n\t\t\t\t\t$(window).off('resize.redactor-modal');\r\n\t\t\t\t},\r\n\t\t\t\tcloseHandler: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (e.which != this.keyCode.ESC) return;\r\n\r\n\t\t\t\t\tthis.modal.close(false);\r\n\t\t\t\t},\r\n\t\t\t\tclose: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (!$(e.target).hasClass('redactor-modal-close-btn') && e.target != this.$modalClose[0] && e.target != this.$modalBox[0])\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!this.$modalBox) return;\r\n\r\n\t\t\t\t\tthis.modal.disableEvents();\r\n\t\t\t\t\tthis.utils.enableBodyScroll();\r\n\r\n\t\t\t\t\tthis.$modalOverlay.remove();\r\n\r\n\t\t\t\t\tthis.$modalBox.fadeOut('fast', $.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$modalBox.remove();\r\n\r\n\t\t\t\t\t\tsetTimeout($.proxy(this.utils.restoreScroll, this), 0);\r\n\r\n\t\t\t\t\t\tif (e !== undefined) this.selection.restore();\r\n\r\n\t\t\t\t\t\t$(document.body).css('overflow', this.modal.bodyOveflow);\r\n\t\t\t\t\t\tthis.core.setCallback('modalClosed', this.modal.templateName);\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tobserve: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tload: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof this.opts.destroyed != \"undefined\") return;\r\n\r\n\t\t\t\t\tif (this.utils.browser('msie'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar self = this;\r\n\t\t\t\t\t\tthis.$editor.find('pre, code').on('mouseover',function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tself.$editor.attr('contenteditable', false);\r\n\t\t\t\t\t\t\t$(this).attr('contenteditable', true);\r\n\r\n\t\t\t\t\t\t}).on('mouseout',function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tself.$editor.attr('contenteditable', true);\r\n\t\t\t\t\t\t\t$(this).removeAttr('contenteditable');\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.observe.images();\r\n\t\t\t\t\tthis.observe.links();\r\n\t\t\t\t},\r\n\t\t\t\ttoolbar: function(e, btnName)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.observe.buttons(e, btnName);\r\n\t\t\t\t\tthis.observe.dropdowns();\r\n\t\t\t\t},\r\n\t\t\t\tisCurrent: function($el, $current)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof $current == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $current = $(this.selection.getCurrent());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn $current.is($el) || $current.parents($el).length > 0;\r\n\t\t\t\t},\r\n\t\t\t\tdropdowns: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $current = $(this.selection.getCurrent());\r\n\r\n\t\t\t\t\t$.each(this.opts.observe.dropdowns, $.proxy(function(key, value)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar observe = value.observe,\r\n\t\t\t\t\t\t\telement = observe.element,\r\n\t\t\t\t\t\t\t$item   = value.item,\r\n\t\t\t\t\t\t\tinValues = typeof observe['in'] != 'undefined' ? observe['in'] : false,\r\n\t\t\t\t\t\t\toutValues = typeof observe['out'] != 'undefined' ? observe['out'] : false;\r\n\r\n\t\t\t\t\t\tif ($current.closest(element).size() > 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.observe.setDropdownProperties($item, inValues, outValues);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.observe.setDropdownProperties($item, outValues, inValues);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tsetDropdownProperties: function($item, addProperties, deleteProperties)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (deleteProperties && typeof deleteProperties['attr'] != 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.observe.setDropdownAttr($item, deleteProperties.attr, true);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typeof addProperties['attr'] != 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.observe.setDropdownAttr($item, addProperties.attr);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typeof addProperties['title'] != 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$item.text(addProperties['title']);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetDropdownAttr: function($item, properties, isDelete)\r\n\t\t\t\t{\r\n\t\t\t\t\t$.each(properties, function(key, value)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (key == 'class')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (!isDelete)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$item.addClass(value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$item.removeClass(value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (!isDelete)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$item.attr(key, value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$item.removeAttr(key);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\taddDropdown: function($item, btnName, btnObject)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof btnObject.observe == \"undefined\") return;\r\n\r\n\t\t\t\t\tbtnObject.item = $item;\r\n\r\n\t\t\t\t\tthis.opts.observe.dropdowns.push(btnObject);\r\n\t\t\t\t},\r\n\t\t\t\tbuttons: function(e, btnName)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar current = this.selection.getCurrent();\r\n\t\t\t\t\tvar parent = this.selection.getParent();\r\n\r\n\t\t\t\t\tif (e !== false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.button.setInactiveAll();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.button.setInactiveAll(btnName);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (e === false && btnName !== 'html')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($.inArray(btnName, this.opts.activeButtons) != -1) this.button.toggleActive(btnName);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//var linkButtonName = (this.utils.isCurrentOrParent('A')) ? this.lang.get('link_edit') : this.lang.get('link_insert');\r\n\t\t\t\t\t//$('body').find('a.redactor-dropdown-link').text(linkButtonName);\r\n\r\n\t\t\t\t\t$.each(this.opts.activeButtonsStates, $.proxy(function(key, value)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar parentEl = $(parent).closest(key, this.$editor[0]);\r\n\t\t\t\t\t\tvar currentEl = $(current).closest(key, this.$editor[0]);\r\n\r\n\t\t\t\t\t\tif (parentEl.length !== 0 && !this.utils.isRedactorParent(parentEl)) return;\r\n\t\t\t\t\t\tif (!this.utils.isRedactorParent(currentEl)) return;\r\n\t\t\t\t\t\tif (parentEl.length !== 0 || currentEl.closest(key, this.$editor[0]).length !== 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.button.setActive(value);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\tvar $parent = $(parent).closest(this.opts.alignmentTags.toString().toLowerCase(), this.$editor[0]);\r\n\t\t\t\t\tif (this.utils.isRedactorParent(parent) && $parent.length)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar align = ($parent.css('text-align') === '') ? 'left' : $parent.css('text-align');\r\n\t\t\t\t\t\tthis.button.setActive('align' + align);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\taddButton: function(tag, btnName)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.opts.activeButtons.push(btnName);\r\n\t\t\t\t\tthis.opts.activeButtonsStates[tag] = btnName;\r\n\t\t\t\t},\r\n\t\t\t\timages: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor.find('img').each($.proxy(function(i, img)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $img = $(img);\r\n\r\n\t\t\t\t\t\t// IE fix (when we clicked on an image and then press backspace IE does goes to image's url)\r\n\t\t\t\t\t\t$img.closest('a', this.$editor[0]).on('click', function(e) { e.preventDefault(); });\r\n\r\n\t\t\t\t\t\tif (this.utils.browser('msie')) $img.attr('unselectable', 'on');\r\n\r\n\t\t\t\t\t\tthis.image.setEditable($img);\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t$(document).on('click.redactor-image-delete.' + this.uuid, $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.observe.image = false;\r\n\t\t\t\t\t\tif (e.target.tagName == 'IMG' && this.utils.isRedactorParent(e.target))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.observe.image = (this.observe.image && this.observe.image == e.target) ? false : e.target;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t},\r\n\t\t\t\tlinks: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.linkTooltip) return;\r\n\r\n\t\t\t\t\tthis.$editor.find('a').on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.showTooltip, this));\r\n\t\t\t\t\tthis.$editor.on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));\r\n\t\t\t\t\t$(document).on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));\r\n\t\t\t\t},\r\n\t\t\t\tgetTooltipPosition: function($link)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn $link.offset();\r\n\t\t\t\t},\r\n\t\t\t\tshowTooltip: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $el = $(e.target);\r\n\r\n\t\t\t\t\tif ($el[0].tagName == 'IMG')\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tif ($el[0].tagName !== 'A')\r\n\t\t\t\t\t\t$el = $el.closest('a', this.$editor[0]);\r\n\r\n\t\t\t\t\tif ($el[0].tagName !== 'A')\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tvar $link = $el;\r\n\r\n\t\t\t\t\tvar pos = this.observe.getTooltipPosition($link);\r\n\t\t\t\t\tvar tooltip = $('<span class=\"redactor-link-tooltip\"></span>');\r\n\r\n\t\t\t\t\tvar href = $link.attr('href');\r\n\t\t\t\t\tif (href === undefined)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thref = '';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (href.length > 24) href = href.substring(0, 24) + '...';\r\n\r\n\t\t\t\t\tvar aLink = $('<a href=\"' + $link.attr('href') + '\" target=\"_blank\" />').html(href).addClass('redactor-link-tooltip-action');\r\n\t\t\t\t\tvar aEdit = $('<a href=\"#\" />').html(this.lang.get('edit')).on('click', $.proxy(this.link.show, this)).addClass('redactor-link-tooltip-action');\r\n\t\t\t\t\tvar aUnlink = $('<a href=\"#\" />').html(this.lang.get('unlink')).on('click', $.proxy(this.link.unlink, this)).addClass('redactor-link-tooltip-action');\r\n\r\n\t\t\t\t\ttooltip.append(aLink).append(' | ').append(aEdit).append(' | ').append(aUnlink);\r\n\t\t\t\t\ttooltip.css({\r\n\t\t\t\t\t\ttop: (pos.top + parseInt($link.css('line-height'), 10)) + 'px',\r\n\t\t\t\t\t\tleft: pos.left + 'px'\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$('.redactor-link-tooltip').remove();\r\n\t\t\t\t\t$('body').append(tooltip);\r\n\t\t\t\t},\r\n\t\t\t\tcloseTooltip: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\te = e.originalEvent || e;\r\n\r\n\t\t\t\t\tvar target = e.target;\r\n\t\t\t\t\tvar $parent = $(target).closest('a', this.$editor[0]);\r\n\t\t\t\t\tif ($parent.length !== 0 && $parent[0].tagName === 'A' && target.tagName !== 'A')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if ((target.tagName === 'A' && this.utils.isRedactorParent(target)) || $(target).hasClass('redactor-link-tooltip-action'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('.redactor-link-tooltip').remove();\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\t\t},\r\n\t\tparagraphize: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tload: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.linebreaks) return html;\r\n\t\t\t\t\tif (html === '' || html === '<p></p>') return this.opts.emptyHtml;\r\n\r\n\t\t\t\t\thtml = html + \"\\n\";\r\n\r\n\t\t\t\t\tthis.paragraphize.safes = [];\r\n\t\t\t\t\tthis.paragraphize.z = 0;\r\n\r\n\t\t\t\t\thtml = html.replace(/(<br\\s?\\/?>){1,}\\n?<\\/blockquote>/gi, '</blockquote>');\r\n\r\n\t\t\t\t\thtml = this.paragraphize.getSafes(html);\r\n\t\t\t\t\thtml = this.paragraphize.getSafesComments(html);\r\n\t\t\t\t\thtml = this.paragraphize.replaceBreaksToNewLines(html);\r\n\t\t\t\t\thtml = this.paragraphize.replaceBreaksToParagraphs(html);\r\n\t\t\t\t\thtml = this.paragraphize.clear(html);\r\n\t\t\t\t\thtml = this.paragraphize.restoreSafes(html);\r\n\r\n\t\t\t\t\thtml = html.replace(new RegExp('<br\\\\s?/?>\\n?<(' + this.opts.paragraphizeBlocks.join('|') + ')(.*?[^>])>', 'gi'), '<p><br /></p>\\n<$1$2>');\r\n\r\n\t\t\t\t\treturn $.trim(html);\r\n\t\t\t\t},\r\n\t\t\t\tgetSafes: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $div = $('<div />').append(html);\r\n\r\n\t\t\t\t\t// remove paragraphs in blockquotes\r\n\t\t\t\t\t$div.find('blockquote p').replaceWith(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn $(this).append('<br />').contents();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\thtml = $div.html();\r\n\r\n\t\t\t\t\t$div.find(this.opts.paragraphizeBlocks.join(', ')).each($.proxy(function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.paragraphize.z++;\r\n\t\t\t\t\t\tthis.paragraphize.safes[this.paragraphize.z] = s.outerHTML;\r\n\t\t\t\t\t\thtml = html.replace(s.outerHTML, '\\n{replace' + this.paragraphize.z + '}');\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tgetSafesComments: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar commentsMatches = html.match(/<!--([\\w\\W]*?)-->/gi);\r\n\r\n\t\t\t\t\tif (!commentsMatches) return html;\r\n\r\n\t\t\t\t\t$.each(commentsMatches, $.proxy(function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.paragraphize.z++;\r\n\t\t\t\t\t\tthis.paragraphize.safes[this.paragraphize.z] = s;\r\n\t\t\t\t\t\thtml = html.replace(s, '\\n{replace' + this.paragraphize.z + '}');\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\trestoreSafes: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\t$.each(this.paragraphize.safes, function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ts = (typeof s !== 'undefined') ? s.replace(/\\$/g, '&#36;') : s;\r\n\t\t\t\t\t\thtml = html.replace('{replace' + i + '}', s);\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\treplaceBreaksToParagraphs: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar htmls = html.split(new RegExp('\\n', 'g'), -1);\r\n\r\n\t\t\t\t\thtml = '';\r\n\t\t\t\t\tif (htmls)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar len = htmls.length;\r\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (!htmls.hasOwnProperty(i)) return;\r\n\r\n\t\t\t\t\t\t\tif (htmls[i].search('{replace') == -1)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\thtmls[i] = htmls[i].replace(/<p>\\n\\t?<\\/p>/gi, '');\r\n\t\t\t\t\t\t\t\thtmls[i] = htmls[i].replace(/<p><\\/p>/gi, '');\r\n\r\n\t\t\t\t\t\t\t\tif (htmls[i] !== '')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\thtml += '<p>' +  htmls[i].replace(/^\\n+|\\n+$/g, \"\") + \"</p>\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse html += htmls[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\treplaceBreaksToNewLines: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/<br \\/>\\s*<br \\/>/gi, \"\\n\\n\");\r\n\t\t\t\t\thtml = html.replace(/<br\\s?\\/?>\\n?<br\\s?\\/?>/gi, \"\\n<br /><br />\");\r\n\r\n\t\t\t\t\thtml = html.replace(new RegExp(\"\\r\\n\", 'g'), \"\\n\");\r\n\t\t\t\t\thtml = html.replace(new RegExp(\"\\r\", 'g'), \"\\n\");\r\n\t\t\t\t\thtml = html.replace(new RegExp(\"/\\n\\n+/\"), 'g', \"\\n\\n\");\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tclear: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(new RegExp('</blockquote></p>', 'gi'), '</blockquote>');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<p></blockquote>', 'gi'), '</blockquote>');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<p><blockquote>', 'gi'), '<blockquote>');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<blockquote></p>', 'gi'), '<blockquote>');\r\n\r\n\t\t\t\t\thtml = html.replace(new RegExp('<p><p ', 'gi'), '<p ');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<p><p>', 'gi'), '<p>');\r\n\t\t\t\t\thtml = html.replace(new RegExp('</p></p>', 'gi'), '</p>');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<p>\\\\s?</p>', 'gi'), '');\r\n\t\t\t\t\thtml = html.replace(new RegExp(\"\\n</p>\", 'gi'), '</p>');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<p>\\t?\\t?\\n?<p>', 'gi'), '<p>');\r\n\t\t\t\t\thtml = html.replace(new RegExp('<p>\\t*</p>', 'gi'), '');\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tpaste: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tinit: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.cleanOnPaste)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsetTimeout($.proxy(this.code.sync, this), 1);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.rtePaste = true;\r\n\r\n\t\t\t\t\tthis.buffer.set();\r\n\t\t\t\t\tthis.selection.save();\r\n\t\t\t\t\tthis.utils.saveScroll();\r\n\r\n\t\t\t\t\tthis.paste.createPasteBox();\r\n\r\n\t\t\t\t\t$(window).on('scroll.redactor-freeze', $.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(window).scrollTop(this.saveBodyScroll);\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\tsetTimeout($.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar html = this.$pasteBox.html();\r\n\r\n\t\t\t\t\t\tthis.$pasteBox.remove();\r\n\r\n\t\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\t\tthis.utils.restoreScroll();\r\n\r\n\t\t\t\t\t\tthis.paste.insert(html);\r\n\r\n\t\t\t\t\t\t$(window).off('scroll.redactor-freeze');\r\n\r\n\t\t\t\t\t\tif (this.linkify.isEnabled())\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.linkify.format();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this), 1);\r\n\t\t\t\t},\r\n\t\t\t\tcreatePasteBox: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$pasteBox = $('<div>').html('').attr('contenteditable', 'true').css({ position: 'fixed', width: 0, top: 0, left: '-9999px' });\r\n\r\n\t\t\t\t\tif (this.utils.browser('msie'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$box.append(this.$pasteBox);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// bootstrap modal\r\n\t\t\t\t\t\tvar $visibleModals = $('.modal-body:visible');\r\n\t\t\t\t\t\tif ($visibleModals.length > 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$visibleModals.append(this.$pasteBox);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$('body').append(this.$pasteBox);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$pasteBox.get(0).focus();\r\n\t\t\t\t},\r\n\t\t\t\tinsert: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = this.core.setCallback('pasteBefore', html);\r\n\r\n\t\t\t\t\t// clean\r\n\t\t\t\t\thtml = (this.utils.isSelectAll()) ? this.clean.onPaste(html, false) : this.clean.onPaste(html);\r\n\r\n\t\t\t\t\thtml = this.core.setCallback('paste', html);\r\n\r\n\t\t\t\t\tif (this.utils.isSelectAll())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.insert.set(html, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.insert.html(html, false);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.utils.disableSelectAll();\r\n\t\t\t\t\tthis.rtePaste = false;\r\n\r\n\t\t\t\t\tsetTimeout($.proxy(this.clean.clearUnverified, this), 10);\r\n\r\n\t\t\t\t\t// clean empty spans\r\n\t\t\t\t\tsetTimeout($.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar spans = this.$editor.find('span');\r\n\t\t\t\t\t\t$.each(spans, function(i,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar html = s.innerHTML.replace(/\\u200B/, '');\r\n\t\t\t\t\t\t\tif (html === '' && s.attributes.length === 0) $(s).remove();\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}, this), 10);\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tplaceholder: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tenable: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.placeholder.is()) return;\r\n\r\n\t\t\t\t\tthis.$editor.attr('placeholder', this.$element.attr('placeholder'));\r\n\r\n\t\t\t\t\tthis.placeholder.toggle();\r\n\t\t\t\t\tthis.$editor.on('keydown.redactor-placeholder', $.proxy(this.placeholder.toggle, this));\r\n\t\t\t\t},\r\n\t\t\t\ttoggle: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tsetTimeout($.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar func = this.utils.isEmpty(this.$editor.html(), false) ? 'addClass' : 'removeClass';\r\n\t\t\t\t\t\tthis.$editor[func]('redactor-placeholder');\r\n\r\n\t\t\t\t\t}, this), 5);\r\n\t\t\t\t},\r\n\t\t\t\tremove: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor.removeClass('redactor-placeholder');\r\n\t\t\t\t},\r\n\t\t\t\tis: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.placeholder)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn this.$element.attr('placeholder', this.opts.placeholder);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn !(typeof this.$element.attr('placeholder') == 'undefined' || this.$element.attr('placeholder') === '');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tprogress: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tshow: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$(document.body).append($('<div id=\"redactor-progress\"><span></span></div>'));\r\n\t\t\t\t\t$('#redactor-progress').fadeIn();\r\n\t\t\t\t},\r\n\t\t\t\thide: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#redactor-progress').fadeOut(1500, function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\t\t},\r\n\t\tselection: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tget: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.sel = document.getSelection();\r\n\r\n\t\t\t\t\tif (document.getSelection && this.sel.getRangeAt && this.sel.rangeCount)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.range = this.sel.getRangeAt(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.range = document.createRange();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\taddRange: function()\r\n\t\t\t\t{\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tthis.sel.removeAllRanges();\r\n\t\t\t\t\t} catch (e) {}\r\n\r\n\t\t\t\t\tthis.sel.addRange(this.range);\r\n\t\t\t\t},\r\n\t\t\t\tgetCurrent: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar el = false;\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tif (this.sel && this.sel.rangeCount > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tel = this.sel.getRangeAt(0).startContainer;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this.utils.isRedactorParent(el);\r\n\t\t\t\t},\r\n\t\t\t\tgetParent: function(elem)\r\n\t\t\t\t{\r\n\t\t\t\t\telem = elem || this.selection.getCurrent();\r\n\t\t\t\t\tif (elem)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn this.utils.isRedactorParent($(elem).parent()[0]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tgetPrev: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn  window.getSelection().anchorNode.previousSibling;\r\n\t\t\t\t},\r\n\t\t\t\tgetNext: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn window.getSelection().anchorNode.nextSibling;\r\n\t\t\t\t},\r\n\t\t\t\tgetBlock: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\tnode = node || this.selection.getCurrent();\r\n\r\n\t\t\t\t\twhile (node)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.utils.isBlockTag(node.tagName))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn ($(node).hasClass('redactor-editor')) ? false : node;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tnode = node.parentNode;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tgetInlines: function(nodes, tags)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tif (this.range && this.range.collapsed)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar inlines = [];\r\n\t\t\t\t\tnodes = (typeof nodes == 'undefined' || nodes === false) ? this.selection.getNodes() : nodes;\r\n\t\t\t\t\tvar inlineTags = this.opts.inlineTags;\r\n\t\t\t\t\tinlineTags.push('span');\r\n\r\n\t\t\t\t\tif (typeof tags !== 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfor (var i = 0; i < tags.length; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tinlineTags.push(tags[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,node)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($.inArray(node.tagName.toLowerCase(), inlineTags) != -1)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tinlines.push(node);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\treturn (inlines.length === 0) ? false : inlines;\r\n\t\t\t\t},\r\n\t\t\t\tgetInlinesTags: function(tags)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tif (this.range && this.range.collapsed)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar inlines = [];\r\n\t\t\t\t\tvar nodes =  this.selection.getNodes();\r\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,node)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($.inArray(node.tagName.toLowerCase(), tags) != -1)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tinlines.push(node);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\treturn (inlines.length === 0) ? false : inlines;\r\n\t\t\t\t},\r\n\t\t\t\tgetBlocks: function(nodes)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tif (this.range && this.range.collapsed)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn [this.selection.getBlock()];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar blocks = [];\r\n\t\t\t\t\tnodes = (typeof nodes == 'undefined') ? this.selection.getNodes() : nodes;\r\n\r\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,node)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.utils.isBlock(node))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tblocks.push(node);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\treturn (blocks.length === 0) ? [this.selection.getBlock()] : blocks;\r\n\t\t\t\t},\r\n\t\t\t\tgetLastBlock: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.selection.lastBlock;\r\n\t\t\t\t},\r\n\t\t\t\tgetNodes: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tvar startNode = this.selection.getNodesMarker(1);\r\n\t\t\t\t\tvar endNode = this.selection.getNodesMarker(2);\r\n\r\n\t\t\t\t\tif (this.range.collapsed === false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t   if (window.getSelection) {\r\n\t\t\t\t\t        var sel = window.getSelection();\r\n\t\t\t\t\t        if (sel.rangeCount > 0) {\r\n\r\n\t\t\t\t\t            var range = sel.getRangeAt(0);\r\n\t\t\t\t\t            var startPointNode = range.startContainer, startOffset = range.startOffset;\r\n\r\n\t\t\t\t\t            var boundaryRange = range.cloneRange();\r\n\t\t\t\t\t            boundaryRange.collapse(false);\r\n\t\t\t\t\t            boundaryRange.insertNode(endNode);\r\n\t\t\t\t\t            boundaryRange.setStart(startPointNode, startOffset);\r\n\t\t\t\t\t            boundaryRange.collapse(true);\r\n\t\t\t\t\t            boundaryRange.insertNode(startNode);\r\n\r\n\t\t\t\t\t            // Reselect the original text\r\n\t\t\t\t\t            range.setStartAfter(startNode);\r\n\t\t\t\t\t            range.setEndBefore(endNode);\r\n\t\t\t\t\t            sel.removeAllRanges();\r\n\t\t\t\t\t            sel.addRange(range);\r\n\t\t\t\t\t        }\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.selection.setNodesMarker(this.range, startNode, true);\r\n\t\t\t\t\t\tendNode = startNode;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar nodes = [];\r\n\t\t\t\t\tvar counter = 0;\r\n\r\n\t\t\t\t\tvar self = this;\r\n\t\t\t\t\tthis.$editor.find('*').each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this == startNode)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar parent = $(this).parent();\r\n\t\t\t\t\t\t\tif (parent.length !== 0 && parent[0].tagName != 'BODY' && self.utils.isRedactorParent(parent[0]))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnodes.push(parent[0]);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tnodes.push(this);\r\n\t\t\t\t\t\t\tcounter = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (counter > 0)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnodes.push(this);\r\n\t\t\t\t\t\t\t\tcounter = counter + 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this == endNode)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar finalNodes = [];\r\n\t\t\t\t\tvar len = nodes.length;\r\n\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (nodes[i].id != 'nodes-marker-1' && nodes[i].id != 'nodes-marker-2')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tfinalNodes.push(nodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.removeNodesMarkers();\r\n\r\n\t\t\t\t\treturn finalNodes;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tgetNodesMarker: function(num)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn $('<span id=\"nodes-marker-' + num + '\" class=\"redactor-nodes-marker\" data-verified=\"redactor\">' + this.opts.invisibleSpace + '</span>')[0];\r\n\t\t\t\t},\r\n\t\t\t\tsetNodesMarker: function(range, node, type)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar range = range.cloneRange();\r\n\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\trange.collapse(type);\r\n\t\t\t\t\t\trange.insertNode(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (e) {}\r\n\t\t\t\t},\r\n\t\t\t\tremoveNodesMarkers: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$(document).find('span.redactor-nodes-marker').remove();\r\n\t\t\t\t\tthis.$editor.find('span.redactor-nodes-marker').remove();\r\n\t\t\t\t},\r\n\t\t\t\tfromPoint: function(start, end)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.caret.setOffset(start, end);\r\n\t\t\t\t},\r\n\t\t\t\twrap: function(tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tif (this.range.collapsed) return false;\r\n\r\n\t\t\t\t\tvar wrapper = document.createElement(tag);\r\n\t\t\t\t\twrapper.appendChild(this.range.extractContents());\r\n\t\t\t\t\tthis.range.insertNode(wrapper);\r\n\r\n\t\t\t\t\treturn wrapper;\r\n\t\t\t\t},\r\n\t\t\t\tselectElement: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.utils.browser('mozilla'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnode = node[0] || node;\r\n\r\n\t\t\t\t\t\tvar range = document.createRange();\r\n\t\t\t\t\t\trange.selectNodeContents(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.caret.set(node, 0, node, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tselectAll: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\tthis.range.selectNodeContents(this.$editor[0]);\r\n\t\t\t\t\tthis.selection.addRange();\r\n\t\t\t\t},\r\n\t\t\t\tremove: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\tthis.sel.removeAllRanges();\r\n\t\t\t\t},\r\n\t\t\t\tsave: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.createMarkers();\r\n\t\t\t\t},\r\n\t\t\t\tcreateMarkers: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tvar node1 = this.selection.getMarker(1);\r\n\r\n\t\t\t\t\tthis.selection.setMarker(this.range, node1, true);\r\n\t\t\t\t\tif (this.range.collapsed === false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar node2 = this.selection.getMarker(2);\r\n\t\t\t\t\t\tthis.selection.setMarker(this.range, node2, false);\r\n\r\n\t\t\t\t\t\t// concrete5 start - https://github.com/concrete5/concrete5/issues/5406\r\n\t\t\t\t\t\tif (this.utils.browser('webkit')) this.caret.set(node1, 0, node2, 0);\r\n\t\t\t\t\t\t// concrete5 end\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.savedSel = this.$editor.html();\r\n\t\t\t\t},\r\n\t\t\t\tgetMarker: function(num)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof num == 'undefined') num = 1;\r\n\r\n\t\t\t\t\treturn $('<span id=\"selection-marker-' + num + '\" class=\"redactor-selection-marker\"  data-verified=\"redactor\">' + this.opts.invisibleSpace + '</span>')[0];\r\n\t\t\t\t},\r\n\t\t\t\tgetMarkerAsHtml: function(num)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.utils.getOuterHtml(this.selection.getMarker(num));\r\n\t\t\t\t},\r\n\t\t\t\tsetMarker: function(range, node, type)\r\n\t\t\t\t{\r\n\t\t\t\t\trange = range.cloneRange();\r\n\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\trange.collapse(type);\r\n\t\t\t\t\t\trange.insertNode(node);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.focus.setStart();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\trestore: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar node1 = this.$editor.find('span#selection-marker-1');\r\n\t\t\t\t\tvar node2 = this.$editor.find('span#selection-marker-2');\r\n\r\n\t\t\t\t\tif (this.utils.browser('mozilla'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.focus();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (node1.length !== 0 && node2.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.caret.set(node1, 0, node2, 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (node1.length !== 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.caret.set(node1, 0, node1, 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.focus();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.removeMarkers();\r\n\t\t\t\t\tthis.savedSel = false;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tremoveMarkers: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$editor.find('span.redactor-selection-marker').each(function(i,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar text = $(s).text().replace(/\\u200B/g, '');\r\n\t\t\t\t\t\tif (text === '') $(s).remove();\r\n\t\t\t\t\t\telse $(s).replaceWith(function() { return $(this).contents(); });\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tgetText: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\treturn this.sel.toString();\r\n\t\t\t\t},\r\n\t\t\t\tgetHtml: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar html = '';\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\tif (this.sel.rangeCount)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar container = document.createElement('div');\r\n\t\t\t\t\t\tvar len = this.sel.rangeCount;\r\n\t\t\t\t\t\tfor (var i = 0; i < len; ++i)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcontainer.appendChild(this.sel.getRangeAt(i).cloneContents());\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\thtml = container.innerHTML;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this.clean.onSync(html);\r\n\t\t\t\t},\r\n\t\t\t\treplaceSelection: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selection.get();\r\n\t\t\t\t\tthis.range.deleteContents();\r\n\t\t\t\t\tvar div = document.createElement(\"div\");\r\n\t\t\t\t\tdiv.innerHTML = html;\r\n\t\t\t\t\tvar frag = document.createDocumentFragment(), child;\r\n\t\t\t\t\twhile ((child = div.firstChild)) {\r\n\t\t\t\t\t\tfrag.appendChild(child);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.range.insertNode(frag);\r\n\t\t\t\t},\r\n\t\t\t\treplaceWithHtml: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = this.selection.getMarkerAsHtml(1) + html + this.selection.getMarkerAsHtml(2);\r\n\r\n\t\t\t\t\tthis.selection.get();\r\n\r\n\t\t\t\t\tif (window.getSelection && window.getSelection().getRangeAt)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.selection.replaceSelection(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (document.selection && document.selection.createRange)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.range.pasteHTML(html);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.selection.restore();\r\n\t\t\t\t\tthis.code.sync();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tshortcuts: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tinit: function(e, key)\r\n\t\t\t\t{\r\n\t\t\t\t\t// disable browser's hot keys for bold and italic\r\n\t\t\t\t\tif (!this.opts.shortcuts)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ((e.ctrlKey || e.metaKey) && (key === 66 || key === 73)) e.preventDefault();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$.each(this.opts.shortcuts, $.proxy(function(str, command)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar keys = str.split(',');\r\n\t\t\t\t\t\tvar len = keys.length;\r\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (typeof keys[i] === 'string')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthis.shortcuts.handler(e, $.trim(keys[i]), $.proxy(function()\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar func;\r\n\t\t\t\t\t\t\t\t\tif (command.func.search(/\\./) != '-1')\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tfunc = command.func.split('.');\r\n\t\t\t\t\t\t\t\t\t\tif (typeof this[func[0]] != 'undefined')\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tthis[func[0]][func[1]].apply(this, command.params);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tthis[command.func].apply(this, command.params);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\thandler: function(e, keys, origHandler)\r\n\t\t\t\t{\r\n\t\t\t\t\t// based on https://github.com/jeresig/jquery.hotkeys\r\n\t\t\t\t\tvar hotkeysSpecialKeys =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t8: \"backspace\", 9: \"tab\", 10: \"return\", 13: \"return\", 16: \"shift\", 17: \"ctrl\", 18: \"alt\", 19: \"pause\",\r\n\t\t\t\t\t\t20: \"capslock\", 27: \"esc\", 32: \"space\", 33: \"pageup\", 34: \"pagedown\", 35: \"end\", 36: \"home\",\r\n\t\t\t\t\t\t37: \"left\", 38: \"up\", 39: \"right\", 40: \"down\", 45: \"insert\", 46: \"del\", 59: \";\", 61: \"=\",\r\n\t\t\t\t\t\t96: \"0\", 97: \"1\", 98: \"2\", 99: \"3\", 100: \"4\", 101: \"5\", 102: \"6\", 103: \"7\",\r\n\t\t\t\t\t\t104: \"8\", 105: \"9\", 106: \"*\", 107: \"+\", 109: \"-\", 110: \".\", 111 : \"/\",\r\n\t\t\t\t\t\t112: \"f1\", 113: \"f2\", 114: \"f3\", 115: \"f4\", 116: \"f5\", 117: \"f6\", 118: \"f7\", 119: \"f8\",\r\n\t\t\t\t\t\t120: \"f9\", 121: \"f10\", 122: \"f11\", 123: \"f12\", 144: \"numlock\", 145: \"scroll\", 173: \"-\", 186: \";\", 187: \"=\",\r\n\t\t\t\t\t\t188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\", 221: \"]\", 222: \"'\"\r\n\t\t\t\t\t};\r\n\r\n\r\n\t\t\t\t\tvar hotkeysShiftNums =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\"`\": \"~\", \"1\": \"!\", \"2\": \"@\", \"3\": \"#\", \"4\": \"$\", \"5\": \"%\", \"6\": \"^\", \"7\": \"&\",\r\n\t\t\t\t\t\t\"8\": \"*\", \"9\": \"(\", \"0\": \")\", \"-\": \"_\", \"=\": \"+\", \";\": \": \", \"'\": \"\\\"\", \",\": \"<\",\r\n\t\t\t\t\t\t\".\": \">\",  \"/\": \"?\",  \"\\\\\": \"|\"\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tkeys = keys.toLowerCase().split(\" \");\r\n\t\t\t\t\tvar special = hotkeysSpecialKeys[e.keyCode],\r\n\t\t\t\t\t\tcharacter = String.fromCharCode( e.which ).toLowerCase(),\r\n\t\t\t\t\t\tmodif = \"\", possible = {};\r\n\r\n\t\t\t\t\t$.each([ \"alt\", \"ctrl\", \"meta\", \"shift\"], function(index, specialKey)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (e[specialKey + 'Key'] && special !== specialKey)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tmodif += specialKey + '+';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\r\n\t\t\t\t\tif (special) possible[modif + special] = true;\r\n\t\t\t\t\tif (character)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpossible[modif + character] = true;\r\n\t\t\t\t\t\tpossible[modif + hotkeysShiftNums[character]] = true;\r\n\r\n\t\t\t\t\t\t// \"$\" can be triggered as \"Shift+4\" or \"Shift+$\" or just \"$\"\r\n\t\t\t\t\t\tif (modif === \"shift+\")\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tpossible[hotkeysShiftNums[character]] = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (var i = 0, len = keys.length; i < len; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (possible[keys[i]])\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\treturn origHandler.apply(this, arguments);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\ttabifier: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tget: function(code)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.opts.tabifier) return code;\r\n\r\n\t\t\t\t\t// clean setup\r\n\t\t\t\t\tvar ownLine = ['area', 'body', 'head', 'hr', 'i?frame', 'link', 'meta', 'noscript', 'style', 'script', 'table', 'tbody', 'thead', 'tfoot'];\r\n\t\t\t\t\tvar contOwnLine = ['li', 'dt', 'dt', 'h[1-6]', 'option', 'script'];\r\n\t\t\t\t\tvar newLevel = ['p', 'blockquote', 'div', 'dl', 'fieldset', 'form', 'frameset', 'map', 'ol', 'pre', 'select', 'td', 'th', 'tr', 'ul'];\r\n\r\n\t\t\t\t\tthis.tabifier.lineBefore = new RegExp('^<(/?' + ownLine.join('|/?' ) + '|' + contOwnLine.join('|') + ')[ >]');\r\n\t\t\t\t\tthis.tabifier.lineAfter = new RegExp('^<(br|/?' + ownLine.join('|/?' ) + '|/' + contOwnLine.join('|/') + ')[ >]');\r\n\t\t\t\t\tthis.tabifier.newLevel = new RegExp('^</?(' + newLevel.join('|' ) + ')[ >]');\r\n\r\n\t\t\t\t\tvar i = 0,\r\n\t\t\t\t\tcodeLength = code.length,\r\n\t\t\t\t\tpoint = 0,\r\n\t\t\t\t\tstart = null,\r\n\t\t\t\t\tend = null,\r\n\t\t\t\t\ttag = '',\r\n\t\t\t\t\tout = '',\r\n\t\t\t\t\tcont = '';\r\n\r\n\t\t\t\t\tthis.tabifier.cleanlevel = 0;\r\n\r\n\t\t\t\t\tfor (; i < codeLength; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpoint = i;\r\n\r\n\t\t\t\t\t\t// if no more tags, copy and exit\r\n\t\t\t\t\t\tif (-1 == code.substr(i).indexOf( '<' ))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tout += code.substr(i);\r\n\r\n\t\t\t\t\t\t\treturn this.tabifier.finish(out);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// copy verbatim until a tag\r\n\t\t\t\t\t\twhile (point < codeLength && code.charAt(point) != '<')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tpoint++;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (i != point)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcont = code.substr(i, point - i);\r\n\t\t\t\t\t\t\tif (!cont.match(/^\\s{2,}$/g))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif ('\\n' == out.charAt(out.length - 1)) out += this.tabifier.getTabs();\r\n\t\t\t\t\t\t\t\telse if ('\\n' == cont.charAt(0))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tout += '\\n' + this.tabifier.getTabs();\r\n\t\t\t\t\t\t\t\t\tcont = cont.replace(/^\\s+/, '');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tout += cont;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (cont.match(/\\n/)) out += '\\n' + this.tabifier.getTabs();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tstart = point;\r\n\r\n\t\t\t\t\t\t// find the end of the tag\r\n\t\t\t\t\t\twhile (point < codeLength && '>' != code.charAt(point))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tpoint++;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttag = code.substr(start, point - start);\r\n\t\t\t\t\t\ti = point;\r\n\r\n\t\t\t\t\t\tvar t;\r\n\r\n\t\t\t\t\t\tif ('!--' == tag.substr(1, 3))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (!tag.match(/--$/))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\twhile ('-->' != code.substr(point, 3))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tpoint++;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tpoint += 2;\r\n\t\t\t\t\t\t\t\ttag = code.substr(start, point - start);\r\n\t\t\t\t\t\t\t\ti = point;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ('\\n' != out.charAt(out.length - 1)) out += '\\n';\r\n\r\n\t\t\t\t\t\t\tout += this.tabifier.getTabs();\r\n\t\t\t\t\t\t\tout += tag + '>\\n';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if ('!' == tag[1])\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tout = this.tabifier.placeTag(tag + '>', out);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if ('?' == tag[1])\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tout += tag + '>\\n';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (t = tag.match(/^<(script|style|pre)/i))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tt[1] = t[1].toLowerCase();\r\n\t\t\t\t\t\t\ttag = this.tabifier.cleanTag(tag);\r\n\t\t\t\t\t\t\tout = this.tabifier.placeTag(tag, out);\r\n\t\t\t\t\t\t\tend = String(code.substr(i + 1)).toLowerCase().indexOf('</' + t[1]);\r\n\r\n\t\t\t\t\t\t\tif (end)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcont = code.substr(i + 1, end);\r\n\t\t\t\t\t\t\t\ti += end;\r\n\t\t\t\t\t\t\t\tout += cont;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttag = this.tabifier.cleanTag(tag);\r\n\t\t\t\t\t\t\tout = this.tabifier.placeTag(tag, out);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this.tabifier.finish(out);\r\n\t\t\t\t},\r\n\t\t\t\tgetTabs: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar s = '';\r\n\t\t\t\t\tfor ( var j = 0; j < this.tabifier.cleanlevel; j++ )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ts += '\\t';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn s;\r\n\t\t\t\t},\r\n\t\t\t\tfinish: function(code)\r\n\t\t\t\t{\r\n\t\t\t\t\tcode = code.replace(/\\n\\s*\\n/g, '\\n');\r\n\t\t\t\t\tcode = code.replace(/^[\\s\\n]*/, '');\r\n\t\t\t\t\tcode = code.replace(/[\\s\\n]*$/, '');\r\n\t\t\t\t\tcode = code.replace(/<script(.*?)>\\n<\\/script>/gi, '<script$1></script>');\r\n\r\n\t\t\t\t\tthis.tabifier.cleanlevel = 0;\r\n\r\n\t\t\t\t\treturn code;\r\n\t\t\t\t},\r\n\t\t\t\tcleanTag: function (tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar tagout = '';\r\n\t\t\t\t\ttag = tag.replace(/\\n/g, ' ');\r\n\t\t\t\t\ttag = tag.replace(/\\s{2,}/g, ' ');\r\n\t\t\t\t\ttag = tag.replace(/^\\s+|\\s+$/g, ' ');\r\n\r\n\t\t\t\t\tvar suffix = '';\r\n\t\t\t\t\tif (tag.match(/\\/$/))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsuffix = '/';\r\n\t\t\t\t\t\ttag = tag.replace(/\\/+$/, '');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar m;\r\n\t\t\t\t\twhile (m = /\\s*([^= ]+)(?:=((['\"']).*?\\3|[^ ]+))?/.exec(tag))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (m[2]) tagout += m[1].toLowerCase() + '=' + m[2];\r\n\t\t\t\t\t\telse if (m[1]) tagout += m[1].toLowerCase();\r\n\r\n\t\t\t\t\t\ttagout += ' ';\r\n\t\t\t\t\t\ttag = tag.substr(m[0].length);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn tagout.replace(/\\s*$/, '') + suffix + '>';\r\n\t\t\t\t},\r\n\t\t\t\tplaceTag: function (tag, out)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar nl = tag.match(this.tabifier.newLevel);\r\n\r\n\t\t\t\t\tif (tag.match(this.tabifier.lineBefore) || nl)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tout = out.replace(/\\s*$/, '');\r\n\t\t\t\t\t\tout += '\\n';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (nl && '/' == tag.charAt(1)) this.tabifier.cleanlevel--;\r\n\t\t\t\t\tif ('\\n' == out.charAt(out.length - 1)) out += this.tabifier.getTabs();\r\n\t\t\t\t\tif (nl && '/' != tag.charAt(1)) this.tabifier.cleanlevel++;\r\n\r\n\t\t\t\t\tout += tag;\r\n\r\n\t\t\t\t\tif (tag.match(this.tabifier.lineAfter) || tag.match(this.tabifier.newLevel))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tout = out.replace(/ *$/, '');\r\n\t\t\t\t\t\t//out += '\\n';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn out;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\ttidy: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tsetupAllowed: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar index = $.inArray('span', this.opts.removeEmpty);\r\n\t\t\t\t\tif (index !== -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.opts.removeEmpty.splice(index, 1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.opts.allowedTags) this.opts.deniedTags = false;\r\n\t\t\t\t\tif (this.opts.allowedAttr) this.opts.removeAttr = false;\r\n\r\n\t\t\t\t\tif (this.opts.linebreaks) return;\r\n\r\n\t\t\t\t\tvar tags = ['p', 'section'];\r\n\t\t\t\t\tif (this.opts.allowedTags) this.tidy.addToAllowed(tags);\r\n\t\t\t\t\tif (this.opts.deniedTags) this.tidy.removeFromDenied(tags);\r\n\r\n\t\t\t\t},\r\n\t\t\t\taddToAllowed: function(tags)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar len = tags.length;\r\n\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($.inArray(tags[i], this.opts.allowedTags) == -1)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.opts.allowedTags.push(tags[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremoveFromDenied: function(tags)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar len = tags.length;\r\n\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar pos = $.inArray(tags[i], this.opts.deniedTags);\r\n\t\t\t\t\t\tif (pos != -1)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.opts.deniedTags.splice(pos, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tload: function(html, options)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.tidy.settings = {\r\n\t\t\t\t\t\tdeniedTags: this.opts.deniedTags,\r\n\t\t\t\t\t\tallowedTags: this.opts.allowedTags,\r\n\t\t\t\t\t\tremoveComments: this.opts.removeComments,\r\n\t\t\t\t\t\treplaceTags: this.opts.replaceTags,\r\n\t\t\t\t\t\treplaceStyles: this.opts.replaceStyles,\r\n\t\t\t\t\t\tremoveDataAttr: this.opts.removeDataAttr,\r\n\t\t\t\t\t\tremoveAttr: this.opts.removeAttr,\r\n\t\t\t\t\t\tallowedAttr: this.opts.allowedAttr,\r\n\t\t\t\t\t\tremoveWithoutAttr: this.opts.removeWithoutAttr,\r\n\t\t\t\t\t\tremoveEmpty: this.opts.removeEmpty\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t$.extend(this.tidy.settings, options);\r\n\r\n\t\t\t\t\thtml = this.tidy.removeComments(html);\r\n\r\n\t\t\t\t\t// create container\r\n\t\t\t\t\tthis.tidy.$div = $('<div />').append(html);\r\n\r\n\t\t\t\t\t// clean\r\n\t\t\t\t\tthis.tidy.replaceTags();\r\n\t\t\t\t\tthis.tidy.replaceStyles();\r\n\t\t\t\t\tthis.tidy.removeTags();\r\n\r\n\t\t\t\t\tthis.tidy.removeAttr();\r\n\t\t\t\t\tthis.tidy.removeEmpty();\r\n\t\t\t\t\tthis.tidy.removeParagraphsInLists();\r\n\t\t\t\t\tthis.tidy.removeDataAttr();\r\n\t\t\t\t\tthis.tidy.removeWithoutAttr();\r\n\r\n\t\t\t\t\thtml = this.tidy.$div.html();\r\n\t\t\t\t\tthis.tidy.$div.remove();\r\n\r\n\t\t\t\t\treturn html;\r\n\t\t\t\t},\r\n\t\t\t\tremoveComments: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.tidy.settings.removeComments) return html;\r\n\r\n\t\t\t\t\treturn html.replace(/<!--[\\s\\S]*?-->/gi, '');\r\n\t\t\t\t},\r\n\t\t\t\treplaceTags: function(html)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.tidy.settings.replaceTags) return html;\r\n\r\n\t\t\t\t\tvar len = this.tidy.settings.replaceTags.length;\r\n\t\t\t\t\tvar replacement = [], rTags = [];\r\n\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trTags.push(this.tidy.settings.replaceTags[i][1]);\r\n\t\t\t\t\t\treplacement.push(this.tidy.settings.replaceTags[i][0]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$.each(replacement, $.proxy(function(key, value)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.tidy.$div.find(value).replaceWith(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn $(\"<\" + rTags[key] + \" />\", {html: $(this).html()});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\treplaceStyles: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.tidy.settings.replaceStyles) return;\r\n\r\n\t\t\t\t\tvar len = this.tidy.settings.replaceStyles.length;\r\n\t\t\t\t\tthis.tidy.$div.find('span').each($.proxy(function(n,s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $el = $(s);\r\n\t\t\t\t\t\tvar style = $el.attr('style');\r\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (style && style.match(new RegExp('^' + this.tidy.settings.replaceStyles[i][0], 'i')))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar tagName = this.tidy.settings.replaceStyles[i][1];\r\n\t\t\t\t\t\t\t\t$el.replaceWith(function()\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar tag = document.createElement(tagName);\r\n\t\t\t\t\t\t\t\t\treturn $(tag).append($(this).contents());\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t},\r\n\t\t\t\tremoveTags: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.tidy.settings.deniedTags && this.tidy.settings.allowedTags)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.tidy.$div.find('*').not(this.tidy.settings.allowedTags.join(',')).each(function(i, s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (s.innerHTML === '') $(s).remove();\r\n\t\t\t\t\t\t\telse $(s).contents().unwrap();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.tidy.settings.deniedTags)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.tidy.$div.find(this.tidy.settings.deniedTags.join(',')).each(function(i, s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif ($(s).hasClass('redactor-script-tag') || $(s).hasClass('redactor-selection-marker')) return;\r\n\r\n\t\t\t\t\t\t\tif (s.innerHTML === '') $(s).remove();\r\n\t\t\t\t\t\t\telse $(s).contents().unwrap();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremoveAttr: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar len;\r\n\t\t\t\t\tif (!this.tidy.settings.removeAttr && this.tidy.settings.allowedAttr)\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\tvar allowedAttrTags = [], allowedAttrData = [];\r\n\t\t\t\t\t\tlen = this.tidy.settings.allowedAttr.length;\r\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tallowedAttrTags.push(this.tidy.settings.allowedAttr[i][0]);\r\n\t\t\t\t\t\t\tallowedAttrData.push(this.tidy.settings.allowedAttr[i][1]);\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\tthis.tidy.$div.find('*').each($.proxy(function(n,s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $el = $(s);\r\n\t\t\t\t\t\t\tvar pos = $.inArray($el[0].tagName.toLowerCase(), allowedAttrTags);\r\n\t\t\t\t\t\t\tvar attributesRemove = this.tidy.removeAttrGetRemoves(pos, allowedAttrData, $el);\r\n\r\n\t\t\t\t\t\t\tif (attributesRemove)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$.each(attributesRemove, function(z,f) {\r\n\t\t\t\t\t\t\t\t\t$el.removeAttr(f);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.tidy.settings.removeAttr)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlen = this.tidy.settings.removeAttr.length;\r\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar attrs = this.tidy.settings.removeAttr[i][1];\r\n\t\t\t\t\t\t\tif ($.isArray(attrs)) attrs = attrs.join(' ');\r\n\r\n\t\t\t\t\t\t\tthis.tidy.$div.find(this.tidy.settings.removeAttr[i][0]).removeAttr(attrs);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tremoveAttrGetRemoves: function(pos, allowed, $el)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar attributesRemove = [];\r\n\r\n\t\t\t\t\t// remove all attrs\r\n\t\t\t\t\tif (pos == -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$.each($el[0].attributes, function(i, item)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tattributesRemove.push(item.name);\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// allow all attrs\r\n\t\t\t\t\telse if (allowed[pos] == '*')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tattributesRemove = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// allow specific attrs\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$.each($el[0].attributes, function(i, item)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif ($.isArray(allowed[pos]))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif ($.inArray(item.name, allowed[pos]) == -1)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tattributesRemove.push(item.name);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (allowed[pos] != item.name)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tattributesRemove.push(item.name);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn attributesRemove;\r\n\t\t\t\t},\r\n\t\t\t\tremoveAttrs: function (el, regex)\r\n\t\t\t\t{\r\n\t\t\t\t\tregex = new RegExp(regex, \"g\");\r\n\t\t\t\t\treturn el.each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar self = $(this);\r\n\t\t\t\t\t\tvar len = this.attributes.length - 1;\r\n\t\t\t\t\t\tfor (var i = len; i >= 0; i--)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar item = this.attributes[i];\r\n\t\t\t\t\t\t\tif (item && item.specified && item.name.search(regex)>=0)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tself.removeAttr(item.name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tremoveEmpty: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.tidy.settings.removeEmpty) return;\r\n\r\n\t\t\t\t\tthis.tidy.$div.find(this.tidy.settings.removeEmpty.join(',')).each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $el = $(this);\r\n\t\t\t\t\t\tvar text = $el.text();\r\n\t\t\t\t\t\ttext = text.replace(/\\u200B/g, '');\r\n\t\t\t\t\t\ttext = text.replace(/&nbsp;/gi, '');\r\n\t\t\t\t\t\ttext = text.replace(/\\s/g, '');\r\n\r\n\t\t    \t    \tif (text === '' && $el.children().length === 0)\r\n\t\t    \t    \t{\r\n\t\t\t    \t    \t$el.remove();\r\n\t\t    \t    \t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tremoveParagraphsInLists: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.tidy.$div.find('li p').contents().unwrap();\r\n\t\t\t\t},\r\n\t\t\t\tremoveDataAttr: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.tidy.settings.removeDataAttr) return;\r\n\r\n\t\t\t\t\tvar tags = this.tidy.settings.removeDataAttr;\r\n\t\t\t\t\tif ($.isArray(this.tidy.settings.removeDataAttr)) tags = this.tidy.settings.removeDataAttr.join(',');\r\n\r\n\t\t\t\t\tthis.tidy.removeAttrs(this.tidy.$div.find(tags), '^(data-)');\r\n\r\n\t\t\t\t},\r\n\t\t\t\tremoveWithoutAttr: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.tidy.settings.removeWithoutAttr) return;\r\n\r\n\t\t\t\t\tthis.tidy.$div.find(this.tidy.settings.removeWithoutAttr.join(',')).each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.attributes.length === 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).contents().unwrap();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\ttoolbar: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tinit: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\thtml:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('html'),\r\n\t\t\t\t\t\t\tfunc: 'code.toggle'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tformatting:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('formatting'),\r\n\t\t\t\t\t\t\tdropdown:\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tp:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('paragraph'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tblockquote:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('quote'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tpre:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('code'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\th1:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header1'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\th2:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header2'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\th3:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header3'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\th4:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header4'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\th5:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header5'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tbold:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('bold'),\r\n\t\t\t\t\t\t\tfunc: 'inline.format'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\titalic:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('italic'),\r\n\t\t\t\t\t\t\tfunc: 'inline.format'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdeleted:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('deleted'),\r\n\t\t\t\t\t\t\tfunc: 'inline.format'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tunderline:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('underline'),\r\n\t\t\t\t\t\t\tfunc: 'inline.format'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tunorderedlist:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: '&bull; ' + this.lang.get('unorderedlist'),\r\n\t\t\t\t\t\t\tfunc: 'list.toggle'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\torderedlist:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: '1. ' + this.lang.get('orderedlist'),\r\n\t\t\t\t\t\t\tfunc: 'list.toggle'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\toutdent:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: '< ' + this.lang.get('outdent'),\r\n\t\t\t\t\t\t\tfunc: 'indent.decrease'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tindent:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: '> ' + this.lang.get('indent'),\r\n\t\t\t\t\t\t\tfunc: 'indent.increase'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\timage:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('image'),\r\n\t\t\t\t\t\t\tfunc: 'image.show'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfile:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('file'),\r\n\t\t\t\t\t\t\tfunc: 'file.show'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tlink:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('link'),\r\n\t\t\t\t\t\t\tdropdown:\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlink:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('link_insert'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'link.show',\r\n\t\t\t\t\t\t\t\t\tobserve: {\r\n\t\t\t\t\t\t\t\t\t\telement: 'a',\r\n\t\t\t\t\t\t\t\t\t\tin: {\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: this.lang.get('link_edit'),\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tout: {\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: this.lang.get('link_insert')\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tunlink:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('unlink'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'link.unlink',\r\n\t\t\t\t\t\t\t\t\tobserve: {\r\n\t\t\t\t\t\t\t\t\t\telement: 'a',\r\n\t\t\t\t\t\t\t\t\t\tout: {\r\n\t\t\t\t\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t'class': 'redactor-dropdown-link-inactive',\r\n\t\t\t\t\t\t\t\t\t\t\t\t'aria-disabled': true\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\talignment:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('alignment'),\r\n\t\t\t\t\t\t\tdropdown:\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tleft:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('align_left'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'alignment.left'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcenter:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('align_center'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'alignment.center'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tright:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('align_right'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'alignment.right'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tjustify:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('align_justify'),\r\n\t\t\t\t\t\t\t\t\tfunc: 'alignment.justify'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\thorizontalrule:\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: this.lang.get('horizontalrule'),\r\n\t\t\t\t\t\t\tfunc: 'line.insert'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\t\t\t\tbuild: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.toolbar.hideButtons();\r\n\t\t\t\t\tthis.toolbar.hideButtonsOnMobile();\r\n\t\t\t\t\tthis.toolbar.isButtonSourceNeeded();\r\n\r\n\t\t\t\t\tif (this.opts.buttons.length === 0) return;\r\n\r\n\t\t\t\t\tthis.$toolbar = this.toolbar.createContainer();\r\n\r\n\t\t\t\t\tthis.toolbar.setOverflow();\r\n\t\t\t\t\tthis.toolbar.append();\r\n\t\t\t\t\tthis.toolbar.setFormattingTags();\r\n\t\t\t\t\tthis.toolbar.loadButtons();\r\n\t\t\t\t\tthis.toolbar.setFixed();\r\n\r\n\t\t\t\t\t// buttons response\r\n\t\t\t\t\tif (this.opts.activeButtons)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$editor.on('mouseup.redactor keyup.redactor focus.redactor', $.proxy(this.observe.toolbar, this));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tcreateContainer: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn $('<ul>').addClass('redactor-toolbar').attr({'id': 'redactor-toolbar-' + this.uuid, 'role': 'toolbar'});\r\n\t\t\t\t},\r\n\t\t\t\tsetFormattingTags: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$.each(this.opts.toolbar.formatting.dropdown, $.proxy(function (i, s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif ($.inArray(i, this.opts.formatting) == -1) delete this.opts.toolbar.formatting.dropdown[i];\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t},\r\n\t\t\t\tloadButtons: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$.each(this.opts.buttons, $.proxy(function(i, btnName)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (!this.opts.toolbar[btnName]) return;\r\n\r\n\t\t\t\t\t\tif (btnName === 'file')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t if (this.opts.fileUpload === false) return;\r\n\t\t\t\t\t\t\t else if (!this.opts.fileUpload && this.opts.s3 === false) return;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (btnName === 'image')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t if (this.opts.imageUpload === false) return;\r\n\t\t\t\t\t\t\t else if (!this.opts.imageUpload && this.opts.s3 === false) return;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar btnObject = this.opts.toolbar[btnName];\r\n\t\t\t\t\t\tthis.$toolbar.append($('<li>').append(this.button.build(btnName, btnObject)));\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tappend: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.toolbarExternal)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$toolbar.addClass('redactor-toolbar-external');\r\n\t\t\t\t\t\t$(this.opts.toolbarExternal).html(this.$toolbar);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$box.prepend(this.$toolbar);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tsetFixed: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.utils.isDesktop()) return;\r\n\t\t\t\t\tif (this.opts.toolbarExternal) return;\r\n\t\t\t\t\tif (!this.opts.toolbarFixed) return;\r\n\r\n\t\t\t\t\tthis.toolbar.observeScroll();\r\n\t\t\t\t\t$(this.opts.toolbarFixedTarget).on('scroll.redactor.' + this.uuid, $.proxy(this.toolbar.observeScroll, this));\r\n\r\n\t\t\t\t},\r\n\t\t\t\tsetOverflow: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.utils.isMobile() && this.opts.toolbarOverflow)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.$toolbar.addClass('redactor-toolbar-overflow');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tisButtonSourceNeeded: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.source) return;\r\n\r\n\t\t\t\t\tvar index = this.opts.buttons.indexOf('html');\r\n\t\t\t\t\tif (index !== -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.opts.buttons.splice(index, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\thideButtons: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.buttonsHide.length === 0) return;\r\n\r\n\t\t\t\t\t$.each(this.opts.buttonsHide, $.proxy(function(i, s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar index = this.opts.buttons.indexOf(s);\r\n\t\t\t\t\t\tthis.opts.buttons.splice(index, 1);\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\thideButtonsOnMobile: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!this.utils.isMobile() || this.opts.buttonsHideOnMobile.length === 0) return;\r\n\r\n\t\t\t\t\t$.each(this.opts.buttonsHideOnMobile, $.proxy(function(i, s)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar index = this.opts.buttons.indexOf(s);\r\n\t\t\t\t\t\tthis.opts.buttons.splice(index, 1);\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tobserveScroll: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t/*\r\n\t\t\t\t\tvar scrollTop = $(this.opts.toolbarFixedTarget).scrollTop();\r\n\t\t\t\t\tvar boxTop = 1;\r\n\r\n\t\t\t\t\tif (this.opts.toolbarFixedTarget === document)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tboxTop = this.$box.offset().top;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ((scrollTop + this.opts.toolbarFixedTopOffset) > boxTop)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.toolbar.observeScrollEnable(scrollTop, boxTop);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.toolbar.observeScrollDisable();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t*/\r\n\t\t\t\t},\r\n\t\t\t\tobserveScrollEnable: function(scrollTop, boxTop)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar top = this.opts.toolbarFixedTopOffset + scrollTop - boxTop;\r\n\t\t\t\t\tvar left = 0;\r\n\t\t\t\t\tvar end = boxTop + this.$box.height() - 32;\r\n\t\t\t\t\tvar width = this.$box.innerWidth();\r\n\r\n\t\t\t\t\tthis.$toolbar.addClass('toolbar-fixed-box');\r\n\t\t\t\t\tthis.$toolbar.css({\r\n\t\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\t\twidth: width,\r\n\t\t\t\t\t\ttop: top + 'px',\r\n\t\t\t\t\t\tleft: left\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (scrollTop > end)\r\n\t\t\t\t\t\t$('.redactor-dropdown-' + this.uuid + ':visible').hide();\r\n\r\n\t\t\t\t\tthis.toolbar.setDropdownsFixed();\r\n\t\t\t\t\tthis.$toolbar.css('visibility', (scrollTop < end) ? 'visible' : 'hidden');\r\n\t\t\t\t},\r\n\t\t\t\tobserveScrollDisable: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.$toolbar.css({\r\n\t\t\t\t\t\tposition: 'relative',\r\n\t\t\t\t\t\twidth: 'auto',\r\n\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\tleft: 0,\r\n\t\t\t\t\t\tvisibility: 'visible'\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis.toolbar.unsetDropdownsFixed();\r\n\t\t\t\t\tthis.$toolbar.removeClass('toolbar-fixed-box');\r\n\t\t\t\t},\r\n\t\t\t\tsetDropdownsFixed: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar top = this.$toolbar.innerHeight() + this.opts.toolbarFixedTopOffset;\r\n\t\t\t\t\tvar position = 'fixed';\r\n\t\t\t\t\tif (this.opts.toolbarFixedTarget !== document)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttop = (this.$toolbar.innerHeight() + this.$toolbar.offset().top) + this.opts.toolbarFixedTopOffset;\r\n\t\t\t\t\t\tposition = 'absolute';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('.redactor-dropdown-' + this.uuid).each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).css({ position: position, top: top + 'px' });\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tunsetDropdownsFixed: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar top = (this.$toolbar.innerHeight() + this.$toolbar.offset().top);\r\n\t\t\t\t\t$('.redactor-dropdown-' + this.uuid).each(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).css({ position: 'absolute', top: top + 'px' });\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tupload: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tinit: function(id, url, callback)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.upload.direct = false;\r\n\t\t\t\t\tthis.upload.callback = callback;\r\n\t\t\t\t\tthis.upload.url = url;\r\n\t\t\t\t\tthis.upload.$el = $(id);\r\n\t\t\t\t\tthis.upload.$droparea = $('<div id=\"redactor-droparea\" />');\r\n\r\n\t\t\t\t\tthis.upload.$placeholdler = $('<div id=\"redactor-droparea-placeholder\" />').text(this.lang.get('upload_label'));\r\n\t\t\t\t\tthis.upload.$input = $('<input type=\"file\" name=\"file\" />');\r\n\r\n\t\t\t\t\tthis.upload.$placeholdler.append(this.upload.$input);\r\n\t\t\t\t\tthis.upload.$droparea.append(this.upload.$placeholdler);\r\n\t\t\t\t\tthis.upload.$el.append(this.upload.$droparea);\r\n\r\n\t\t\t\t\tthis.upload.$droparea.off('redactor.upload');\r\n\t\t\t\t\tthis.upload.$input.off('redactor.upload');\r\n\r\n\t\t\t\t\tthis.upload.$droparea.on('dragover.redactor.upload', $.proxy(this.upload.onDrag, this));\r\n\t\t\t\t\tthis.upload.$droparea.on('dragleave.redactor.upload', $.proxy(this.upload.onDragLeave, this));\r\n\r\n\t\t\t\t\t// change\r\n\t\t\t\t\tthis.upload.$input.on('change.redactor.upload', $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te = e.originalEvent || e;\r\n\t\t\t\t\t\tthis.upload.traverseFile(this.upload.$input[0].files[0], e);\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t// drop\r\n\t\t\t\t\tthis.upload.$droparea.on('drop.redactor.upload', $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\tthis.upload.$droparea.removeClass('drag-hover').addClass('drag-drop');\r\n\t\t\t\t\t\tthis.upload.onDrop(e);\r\n\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\tdirectUpload: function(file, e)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.upload.direct = true;\r\n\t\t\t\t\tthis.upload.traverseFile(file, e);\r\n\t\t\t\t},\r\n\t\t\t\tonDrop: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\te = e.originalEvent || e;\r\n\t\t\t\t\tvar files = e.dataTransfer.files;\r\n\r\n\t\t\t\t\tthis.upload.traverseFile(files[0], e);\r\n\t\t\t\t},\r\n\t\t\t\ttraverseFile: function(file, e)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (this.opts.s3)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.upload.setConfig(file);\r\n\t\t\t\t\t\tthis.upload.s3uploadFile(file);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar formData = !!window.FormData ? new FormData() : null;\r\n\t\t\t\t\tif (window.FormData)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.upload.setConfig(file);\r\n\r\n\t\t\t\t\t\tvar name = (this.upload.type == 'image') ? this.opts.imageUploadParam : this.opts.fileUploadParam;\r\n\t\t\t\t\t\tformData.append(name, file);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.progress.show();\r\n\t\t\t\t\tthis.core.setCallback('uploadStart', e, formData);\r\n\t\t\t\t\tthis.upload.sendData(formData, e);\r\n\t\t\t\t},\r\n\t\t\t\tsetConfig: function(file)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.upload.getType(file);\r\n\r\n\t\t\t\t\tif (this.upload.direct)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.upload.url = (this.upload.type == 'image') ? this.opts.imageUpload : this.opts.fileUpload;\r\n\t\t\t\t\t\tthis.upload.callback = (this.upload.type == 'image') ? this.image.insert : this.file.insert;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgetType: function(file)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.upload.type = 'image';\r\n\t\t\t\t\tif (this.opts.imageTypes.indexOf(file.type) == -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.upload.type = 'file';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.opts.imageUpload === null && this.opts.fileUpload !== null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.upload.type = 'file';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tgetHiddenFields: function(obj, fd)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (obj === false || typeof obj !== 'object') return fd;\r\n\r\n\t\t\t\t\t$.each(obj, $.proxy(function(k, v)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (v !== null && v.toString().indexOf('#') === 0) v = $(v).val();\r\n\t\t\t\t\t\tfd.append(k, v);\r\n\r\n\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\treturn fd;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tsendData: function(formData, e)\r\n\t\t\t\t{\r\n\t\t\t\t\t// append hidden fields\r\n\t\t\t\t\tif (this.upload.type == 'image')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tformData = this.upload.getHiddenFields(this.opts.uploadImageFields, formData);\r\n\t\t\t\t\t\tformData = this.upload.getHiddenFields(this.upload.imageFields, formData);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tformData = this.upload.getHiddenFields(this.opts.uploadFileFields, formData);\r\n\t\t\t\t\t\tformData = this.upload.getHiddenFields(this.upload.fileFields, formData);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar xhr = new XMLHttpRequest();\r\n\t\t\t\t\txhr.open('POST', this.upload.url);\r\n\t\t\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n\r\n\t\t\t\t\t// complete\r\n\t\t\t\t\txhr.onreadystatechange = $.proxy(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t    if (xhr.readyState == 4)\r\n\t\t\t\t\t    {\r\n\t\t\t\t\t        var data = xhr.responseText;\r\n\r\n\t\t\t\t\t\t\tdata = data.replace(/^\\[/, '');\r\n\t\t\t\t\t\t\tdata = data.replace(/\\]$/, '');\r\n\r\n\t\t\t\t\t\t\tvar json;\r\n\t\t\t\t\t\t\ttry\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tjson = (typeof data === 'string' ? $.parseJSON(data) : data);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcatch(err)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tjson = {\r\n\t\t\t\t\t\t\t\t\terror: true\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\t\tthis.progress.hide();\r\n\r\n\t\t\t\t\t\t\tif (!this.upload.direct)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthis.upload.$droparea.removeClass('drag-drop');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis.upload.callback(json, this.upload.direct, e);\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t}, this);\r\n\r\n\r\n\t\t\t\t\t/*\r\n\t\t\t\t\txhr.upload.onprogress = $.proxy(function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (e.lengthComputable)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar complete = (e.loaded / e.total * 100 | 0);\r\n\t\t\t\t\t\t\t//progress.value = progress.innerHTML = complete;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\t*/\r\n\r\n\r\n\t\t\t\t\txhr.send(formData);\r\n\t\t\t\t},\r\n\t\t\t\tonDrag: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tthis.upload.$droparea.addClass('drag-hover');\r\n\t\t\t\t},\r\n\t\t\t\tonDragLeave: function(e)\r\n\t\t\t\t{\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tthis.upload.$droparea.removeClass('drag-hover');\r\n\t\t\t\t},\r\n\t\t\t\tclearImageFields: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.upload.imageFields = {};\r\n\t\t\t\t},\r\n\t\t\t\taddImageFields: function(name, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.upload.imageFields[name] = value;\r\n\t\t\t\t},\r\n\t\t\t\tremoveImageFields: function(name)\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.upload.imageFields[name];\r\n\t\t\t\t},\r\n\t\t\t\tclearFileFields: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.upload.fileFields = {};\r\n\t\t\t\t},\r\n\t\t\t\taddFileFields: function(name, value)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.upload.fileFields[name] = value;\r\n\t\t\t\t},\r\n\t\t\t\tremoveFileFields: function(name)\r\n\t\t\t\t{\r\n\t\t\t\t\tdelete this.upload.fileFields[name];\r\n\t\t\t\t},\r\n\r\n\r\n\t\t\t\t// S3\r\n\t\t\t\ts3uploadFile: function(file)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.upload.s3executeOnSignedUrl(file, $.proxy(function(signedURL)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.upload.s3uploadToS3(file, signedURL);\r\n\t\t\t\t\t}, this));\r\n\t\t\t\t},\r\n\t\t\t\ts3executeOnSignedUrl: function(file, callback)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar xhr = new XMLHttpRequest();\r\n\t\t\t\t\tvar mark = (this.opts.s3.search(/\\?/) !== '-1') ? '?' : '&';\r\n\r\n\t\t\t\t\txhr.open('GET', this.opts.s3 + mark + 'name=' + file.name + '&type=' + file.type, true);\r\n\r\n\t\t\t\t\t// Hack to pass bytes through unprocessed.\r\n\t\t\t\t\tif (xhr.overrideMimeType) xhr.overrideMimeType('text/plain; charset=x-user-defined');\r\n\r\n\t\t\t\t\tvar that = this;\r\n\t\t\t\t\txhr.onreadystatechange = function(e)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.readyState == 4 && this.status == 200)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthat.progress.show();\r\n\t\t\t\t\t\t\tcallback(decodeURIComponent(this.responseText));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (this.readyState == 4 && this.status != 200)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t//setProgress(0, 'Could not contact signing script. Status = ' + this.status);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\txhr.send();\r\n\t\t\t\t},\r\n\t\t\t\ts3createCORSRequest: function(method, url)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar xhr = new XMLHttpRequest();\r\n\t\t\t\t\tif (\"withCredentials\" in xhr)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\txhr.open(method, url, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (typeof XDomainRequest != \"undefined\")\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\txhr = new XDomainRequest();\r\n\t\t\t\t\t\txhr.open(method, url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\txhr = null;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn xhr;\r\n\t\t\t\t},\r\n\t\t\t\ts3uploadToS3: function(file, url)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar xhr = this.upload.s3createCORSRequest('PUT', url);\r\n\t\t\t\t\tif (!xhr)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t//setProgress(0, 'CORS not supported');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\txhr.onload = $.proxy(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (xhr.status == 200)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t//setProgress(100, 'Upload completed.');\r\n\r\n\t\t\t\t\t\t\t\tthis.progress.hide();\r\n\r\n\t\t\t\t\t\t\t\tvar s3file = url.split('?');\r\n\r\n\t\t\t\t\t\t\t\tif (!s3file[0])\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t // url parsing is fail\r\n\t\t\t\t\t\t\t\t\t return false;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\t\t\tif (!this.upload.direct)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tthis.upload.$droparea.removeClass('drag-drop');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tvar json = { filelink: s3file[0] };\r\n\t\t\t\t\t\t\t\tif (this.upload.type == 'file')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar arr = s3file[0].split('/');\r\n\t\t\t\t\t\t\t\t\tjson.filename = arr[arr.length-1];\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tthis.upload.callback(json, this.upload.direct, false);\r\n\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t//setProgress(0, 'Upload error: ' + xhr.status);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this);\r\n\r\n\t\t\t\t\t\txhr.onerror = function() {};\r\n\r\n\t\t\t\t\t\txhr.upload.onprogress = function(e) {};\r\n\r\n\t\t\t\t\t\txhr.setRequestHeader('Content-Type', file.type);\r\n\t\t\t\t\t\txhr.setRequestHeader('x-amz-acl', 'public-read');\r\n\r\n\t\t\t\t\t\txhr.send(file);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tutils: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tisMobile: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn /(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent);\r\n\t\t\t\t},\r\n\t\t\t\tisDesktop: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn !/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent);\r\n\t\t\t\t},\r\n\t\t\t\tisString: function(obj)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn Object.prototype.toString.call(obj) == '[object String]';\r\n\t\t\t\t},\r\n\t\t\t\tisEmpty: function(html, removeEmptyTags)\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = html.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\r\n\t\t\t\t\thtml = html.replace(/&nbsp;/gi, '');\r\n\t\t\t\t\thtml = html.replace(/<\\/?br\\s?\\/?>/g, '');\r\n\t\t\t\t\thtml = html.replace(/\\s/g, '');\r\n\t\t\t\t\thtml = html.replace(/^<p>[^\\W\\w\\D\\d]*?<\\/p>$/i, '');\r\n\t\t\t\t\thtml = html.replace(/<iframe(.*?[^>])>$/i, 'iframe');\r\n\t\t\t\t\thtml = html.replace(/<source(.*?[^>])>$/i, 'source');\r\n\r\n\t\t\t\t\t// remove empty tags\r\n\t\t\t\t\tif (removeEmptyTags !== false)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\thtml = html.replace(/<[^\\/>][^>]*><\\/[^>]+>/gi, '');\r\n\t\t\t\t\t\thtml = html.replace(/<[^\\/>][^>]*><\\/[^>]+>/gi, '');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thtml = $.trim(html);\r\n\r\n\t\t\t\t\treturn html === '';\r\n\t\t\t\t},\r\n\t\t\t\tnormalize: function(str)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof(str) === 'undefined') return 0;\r\n\t\t\t\t\treturn parseInt(str.replace('px',''), 10);\r\n\t\t\t\t},\r\n\t\t\t\thexToRgb: function(hex)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof hex == 'undefined') return;\r\n\t\t\t\t\tif (hex.search(/^#/) == -1) return hex;\r\n\r\n\t\t\t\t\tvar shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n\t\t\t\t\thex = hex.replace(shorthandRegex, function(m, r, g, b)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn r + r + g + g + b + b;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n\t\t\t\t\treturn 'rgb(' + parseInt(result[1], 16) + ', ' + parseInt(result[2], 16) + ', ' + parseInt(result[3], 16) + ')';\r\n\t\t\t\t},\r\n\t\t\t\tgetOuterHtml: function(el)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn $('<div>').append($(el).eq(0).clone()).html();\r\n\t\t\t\t},\r\n\t\t\t\tgetAlignmentElement: function(el)\r\n\t\t\t\t{\r\n\t\t\t\t\tif ($.inArray(el.tagName, this.opts.alignmentTags) !== -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn $(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn $(el).closest(this.opts.alignmentTags.toString().toLowerCase(), this.$editor[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremoveEmptyAttr: function(el, attr)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $el = $(el);\r\n\t\t\t\t\tif (typeof $el.attr(attr) == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ($el.attr(attr) === '')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$el.removeAttr(attr);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t\tremoveEmpty: function(i, s)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $s = $($.parseHTML(s));\r\n\r\n\t\t\t\t\t$s.find('.redactor-invisible-space').removeAttr('style').removeAttr('class');\r\n\r\n\t\t\t\t\tif ($s.find('hr, br, img, iframe, source').length !== 0) return;\r\n\t\t\t\t\tvar text = $.trim($s.text());\r\n\r\n\t\t\t\t\tif (this.utils.isEmpty(text, false))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$s.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// save and restore scroll\r\n\t\t\t\tsaveScroll: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.saveEditorScroll = this.$editor.scrollTop();\r\n\t\t\t\t\tthis.saveBodyScroll = $(window).scrollTop();\r\n\r\n\t\t\t\t\tif (this.opts.scrollTarget) this.saveTargetScroll = $(this.opts.scrollTarget).scrollTop();\r\n\t\t\t\t},\r\n\t\t\t\trestoreScroll: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof this.saveScroll === 'undefined' && typeof this.saveBodyScroll === 'undefined') return;\r\n\r\n\t\t\t\t\t$(window).scrollTop(this.saveBodyScroll);\r\n\t\t\t\t\tthis.$editor.scrollTop(this.saveEditorScroll);\r\n\r\n\t\t\t\t\tif (this.opts.scrollTarget) $(this.opts.scrollTarget).scrollTop(this.saveTargetScroll);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// get invisible space element\r\n\t\t\t\tcreateSpaceElement: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar space = document.createElement('span');\r\n\t\t\t\t\tspace.className = 'redactor-invisible-space';\r\n\t\t\t\t\tspace.innerHTML = this.opts.invisibleSpace;\r\n\r\n\t\t\t\t\treturn space;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// replace\r\n\t\t\t\tremoveInlineTags: function(node)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar tags = this.opts.inlineTags;\r\n\t\t\t\t\ttags.push('span');\r\n\r\n\t\t\t\t\tif (node.tagName == 'PRE') tags.push('a');\r\n\r\n\t\t\t\t\t$(node).find(tags.join(',')).not('span.redactor-selection-marker').contents().unwrap();\r\n\t\t\t\t},\r\n\t\t\t\treplaceWithContents: function(node, removeInlineTags)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar self = this;\r\n\t\t\t\t\t$(node).replaceWith(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (removeInlineTags === true) self.utils.removeInlineTags(this);\r\n\r\n\t\t\t\t\t\treturn $(this).contents();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn $(node);\r\n\t\t\t\t},\r\n\t\t\t\treplaceToTag: function(node, tag, removeInlineTags)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar replacement;\r\n\t\t\t\t\tvar self = this;\r\n\t\t\t\t\t$(node).replaceWith(function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treplacement = $('<' + tag + ' />').append($(this).contents());\r\n\r\n\t\t\t\t\t\tfor (var i = 0; i < this.attributes.length; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treplacement.attr(this.attributes[i].name, this.attributes[i].value);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (removeInlineTags === true) self.utils.removeInlineTags(replacement);\r\n\r\n\t\t\t\t\t\treturn replacement;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn replacement;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// start and end of element\r\n\t\t\t\tisStartOfElement: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar block = this.selection.getBlock();\r\n\t\t\t\t\tif (!block) return false;\r\n\r\n\t\t\t\t\tvar offset = this.caret.getOffsetOfElement(block);\r\n\r\n\t\t\t\t\treturn (offset === 0) ? true : false;\r\n\t\t\t\t},\r\n\t\t\t\tisEndOfElement: function(element)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof element == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar element = this.selection.getBlock();\r\n\t\t\t\t\t\tif (!element) return false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar offset = this.caret.getOffsetOfElement(element);\r\n\t\t\t\t\tvar text = $.trim($(element).text()).replace(/\\n\\r\\n/g, '');\r\n\r\n\t\t\t\t\treturn (offset == text.length) ? true : false;\r\n\t\t\t\t},\r\n\t\t\t\tisStartOfEditor: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar offset = this.caret.getOffsetOfElement(this.$editor[0]);\r\n\r\n\t\t\t\t\treturn (offset === 0) ? true : false;\r\n\t\t\t\t},\r\n\t\t\t\tisEndOfEditor: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar block = this.$editor[0];\r\n\r\n\t\t\t\t\tvar offset = this.caret.getOffsetOfElement(block);\r\n\t\t\t\t\tvar text = $.trim($(block).html().replace(/(<([^>]+)>)/gi,''));\r\n\r\n\t\t\t\t\treturn (offset == text.length) ? true : false;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// test blocks\r\n\t\t\t\tisBlock: function(block)\r\n\t\t\t\t{\r\n\t\t\t\t\tblock = block[0] || block;\r\n\r\n\t\t\t\t\treturn block && this.utils.isBlockTag(block.tagName);\r\n\t\t\t\t},\r\n\t\t\t\tisBlockTag: function(tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof tag == 'undefined') return false;\r\n\r\n\t\t\t\t\treturn this.reIsBlock.test(tag);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// tag detection\r\n\t\t\t\tisTag: function(current, tag)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar element = $(current).closest(tag, this.$editor[0]);\r\n\t\t\t\t\tif (element.length == 1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn element[0];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// select all\r\n\t\t\t\tisSelectAll: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.selectAll;\r\n\t\t\t\t},\r\n\t\t\t\tenableSelectAll: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selectAll = true;\r\n\t\t\t\t},\r\n\t\t\t\tdisableSelectAll: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.selectAll = false;\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// parents detection\r\n\t\t\t\tisRedactorParent: function(el)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (!el)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ($(el).parents('.redactor-editor').length === 0 || $(el).hasClass('redactor-editor'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn el;\r\n\t\t\t\t},\r\n\t\t\t\tisCurrentOrParentHeader: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn this.utils.isCurrentOrParent(['H1', 'H2', 'H3', 'H4', 'H5', 'H6']);\r\n\t\t\t\t},\r\n\t\t\t\tisCurrentOrParent: function(tagName)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar parent = this.selection.getParent();\r\n\t\t\t\t\tvar current = this.selection.getCurrent();\r\n\r\n\t\t\t\t\tif ($.isArray(tagName))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar matched = 0;\r\n\t\t\t\t\t\t$.each(tagName, $.proxy(function(i, s)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (this.utils.isCurrentOrParentOne(current, parent, s))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tmatched++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, this));\r\n\r\n\t\t\t\t\t\treturn (matched === 0) ? false : true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn this.utils.isCurrentOrParentOne(current, parent, tagName);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tisCurrentOrParentOne: function(current, parent, tagName)\r\n\t\t\t\t{\r\n\t\t\t\t\ttagName = tagName.toUpperCase();\r\n\r\n\t\t\t\t\treturn parent && parent.tagName === tagName ? parent : current && current.tagName === tagName ? current : false;\r\n\t\t\t\t},\r\n\r\n\r\n\t\t\t\t// browsers detection\r\n\t\t\t\tisOldIe: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn (this.utils.browser('msie') && parseInt(this.utils.browser('version'), 10) < 9) ? true : false;\r\n\t\t\t\t},\r\n\t\t\t\tisLessIe10: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn (this.utils.browser('msie') && parseInt(this.utils.browser('version'), 10) < 10) ? true : false;\r\n\t\t\t\t},\r\n\t\t\t\tisIe11: function()\r\n\t\t\t\t{\r\n\t\t\t\t\treturn !!navigator.userAgent.match(/Trident\\/7\\./);\r\n\t\t\t\t},\r\n\t\t\t\tbrowser: function(browser)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar ua = navigator.userAgent.toLowerCase();\r\n\t\t\t\t\tvar match = /(opr)[\\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t            /(chrome)[ \\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t            /(webkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) ||\r\n\t\t            /(webkit)[ \\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t            /(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t            /(msie) ([\\w.]+)/.exec( ua ) ||\r\n\t\t            ua.indexOf(\"trident\") >= 0 && /(rv)(?::| )([\\w.]+)/.exec( ua ) ||\r\n\t\t            ua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec( ua ) ||\r\n\t\t            [];\r\n\r\n\t\t\t\t\tif (browser == 'safari') return (typeof match[3] != 'undefined') ? match[3] == 'safari' : false;\r\n\t\t\t\t\tif (browser == 'version') return match[2];\r\n\t\t\t\t\tif (browser == 'webkit') return (match[1] == 'chrome' || match[1] == 'opr' || match[1] == 'webkit');\r\n\t\t\t\t\tif (match[1] == 'rv') return browser == 'msie';\r\n\t\t\t\t\tif (match[1] == 'opr') return browser == 'webkit';\r\n\r\n\t\t\t\t\treturn browser == match[1];\r\n\t\t\t\t},\r\n\t\t\t\tstrpos: function(haystack, needle, offset)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar i = haystack.indexOf(needle, offset);\r\n\t\t\t\t\treturn i >= 0 ? i : false;\r\n\t\t\t\t},\r\n\t\t\t\tdisableBodyScroll: function()\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tvar $body = $('html');\r\n\t\t\t\t\tvar windowWidth = window.innerWidth;\r\n\t\t\t\t\tif (!windowWidth)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar documentElementRect = document.documentElement.getBoundingClientRect();\r\n\t\t\t\t\t\twindowWidth = documentElementRect.right - Math.abs(documentElementRect.left);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar isOverflowing = document.body.clientWidth < windowWidth;\r\n\t\t\t\t\tvar scrollbarWidth = this.utils.measureScrollbar();\r\n\r\n\t\t\t\t\t$body.css('overflow', 'hidden');\r\n\t\t\t\t\tif (isOverflowing) $body.css('padding-right', scrollbarWidth);\r\n\r\n\r\n\t\t\t\t},\r\n\t\t\t\tmeasureScrollbar: function()\r\n\t\t\t\t{\r\n\t\t\t\t\tvar $body = $('body');\r\n\t\t\t\t\tvar scrollDiv = document.createElement('div');\r\n\t\t\t\t\tscrollDiv.className = 'redactor-scrollbar-measure';\r\n\r\n\t\t\t\t\t$body.append(scrollDiv);\r\n\t\t\t\t\tvar scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n\t\t\t\t\t$body[0].removeChild(scrollDiv);\r\n\t\t\t\t\treturn scrollbarWidth;\r\n\t\t\t\t},\r\n\t\t\t\tenableBodyScroll: function()\r\n\t\t\t\t{\r\n\t\t\t\t\t$('html').css({ 'overflow': '', 'padding-right': '' });\r\n\t\t\t\t\t$('body').remove('redactor-scrollbar-measure');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n\r\n\t$(window).on('load.tools.redactor', function()\r\n\t{\r\n\t\t$('[data-tools=\"redactor\"]').redactor();\r\n\t});\r\n\r\n\t// constructor\r\n\tRedactor.prototype.init.prototype = Redactor.prototype;\r\n\r\n})(jQuery);"]}